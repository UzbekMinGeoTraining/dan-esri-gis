import{a as N}from"./chunk-VHWLEJLO.js";import"./chunk-XMXL44YY.js";import"./chunk-4HD5O3T7.js";import"./chunk-OSH5MRH4.js";import"./chunk-M5EU7OBK.js";import"./chunk-ZIKE37L7.js";import"./chunk-RMOAL4BI.js";import"./chunk-4SXNSTQ4.js";import"./chunk-A74W4U2J.js";import"./chunk-MAZHSYWX.js";import"./chunk-YVFVORWT.js";import"./chunk-DAAL3W2C.js";import"./chunk-YB6FP3Z6.js";import"./chunk-T7FSW5ND.js";import"./chunk-U3ETEC6R.js";import"./chunk-A2IYJOJO.js";import"./chunk-EFOMVUIX.js";import"./chunk-42DKYLC7.js";import"./chunk-LB3WSIYI.js";import"./chunk-B7ZDEOLU.js";import"./chunk-22JBWFHY.js";import"./chunk-6YHOGO6F.js";import"./chunk-VY6QN6EN.js";import"./chunk-VZPIZOOE.js";import"./chunk-BWCHJXL6.js";import"./chunk-R7X3CKFH.js";import"./chunk-64FW22PO.js";import"./chunk-3EB3OCOV.js";import"./chunk-7Z3Y27UA.js";import"./chunk-HFXUZM7A.js";import"./chunk-3A66AUSD.js";import"./chunk-UUKQEAQR.js";import"./chunk-6UUMJQNV.js";import"./chunk-Y63DBETK.js";import"./chunk-GNKF5TIB.js";import"./chunk-X4XHTJSF.js";import"./chunk-YIBWVOPM.js";import"./chunk-PY5WUUCV.js";import"./chunk-R3XRMWAK.js";import"./chunk-PL6CVK2A.js";import"./chunk-J2R7NR2E.js";import"./chunk-VPH54J3G.js";import"./chunk-OD6TX477.js";import"./chunk-ISUG5L3D.js";import{b as C}from"./chunk-FKKNYWR6.js";import"./chunk-YJ3RZNO6.js";import"./chunk-M4PATAW3.js";import"./chunk-BNQ5VRNF.js";import"./chunk-NOFXYDQS.js";import"./chunk-4BLMEKFL.js";import"./chunk-RPIA54UY.js";import"./chunk-WRN6YTSB.js";import"./chunk-BQ7BWYEG.js";import"./chunk-CA2IXN6Q.js";import"./chunk-AXPRNSO3.js";import"./chunk-FIUHDVVO.js";import"./chunk-3HX6VT75.js";import"./chunk-U4Y7WABQ.js";import"./chunk-WYOOSF42.js";import"./chunk-R6S6A5GA.js";import"./chunk-25T3ULWN.js";import{a as _}from"./chunk-C3YONAAM.js";import"./chunk-2GSAHDXY.js";import"./chunk-OL24FY3J.js";import"./chunk-QBRYULPI.js";import"./chunk-GPQLPPA5.js";import"./chunk-OXRGERMH.js";import"./chunk-LHH3AZP2.js";import"./chunk-HVNUIUKO.js";import"./chunk-Y5M2SONX.js";import"./chunk-Q6ZVH4MK.js";import"./chunk-OL43UY3L.js";import"./chunk-H2QMNAXT.js";import"./chunk-GKUDWGVQ.js";import"./chunk-NZ7WSL6F.js";import"./chunk-RRDM7P6F.js";import"./chunk-EYI3QUAE.js";import"./chunk-63EK7JRZ.js";import"./chunk-HVNRUZWJ.js";import{b as d}from"./chunk-ZGDQY5ZD.js";import"./chunk-QH2MD2O2.js";import"./chunk-6EZNY6L4.js";import"./chunk-3IK5VXZ3.js";import"./chunk-7XLHE26H.js";import"./chunk-MBVOWLUI.js";import"./chunk-EN6CTWVM.js";import"./chunk-IRJNWXGT.js";import"./chunk-LVPMJTA6.js";import{d as q}from"./chunk-7NYR66Q3.js";import"./chunk-WDFAQFJ4.js";import"./chunk-7LUQF6AI.js";import"./chunk-G3PA3VVF.js";import"./chunk-AO7UDTUI.js";import"./chunk-Q7O5PY54.js";import"./chunk-PFIMJ2UL.js";import"./chunk-NNETCWLJ.js";import"./chunk-EPTSNNZF.js";import"./chunk-FW33MEBA.js";import"./chunk-RM6CXOHZ.js";import"./chunk-AOA5JMXK.js";import"./chunk-TWW3KW7Z.js";import"./chunk-VDNXTMSC.js";import"./chunk-MBJHSEMD.js";import"./chunk-K72LO6P2.js";import"./chunk-NKMODNM6.js";import"./chunk-SEKMXZL5.js";import"./chunk-2R4SNL6O.js";import"./chunk-MXOOOTCV.js";import"./chunk-7D4IYTAJ.js";import"./chunk-TSNWBMBA.js";import"./chunk-GLWPOGYF.js";import"./chunk-YFBPRKIN.js";import"./chunk-P2YRCTWM.js";import"./chunk-OFZ6SV37.js";import"./chunk-LAJXTVEO.js";import"./chunk-5MNDZ6BX.js";import"./chunk-RDHMB7M5.js";import"./chunk-YSOJWUIW.js";import"./chunk-Q5WFUDPQ.js";import"./chunk-DPZGANVI.js";import"./chunk-T7BKG6V3.js";import"./chunk-R6VC74T7.js";import"./chunk-6WKJD7BM.js";import"./chunk-3CR7P5WT.js";import"./chunk-YRTBL7EE.js";import"./chunk-3FPO2LOS.js";import"./chunk-QNZSBADV.js";import"./chunk-PYQRTZNZ.js";import"./chunk-S4PLWG55.js";import"./chunk-DZAY272R.js";import"./chunk-GYH7NDHH.js";import"./chunk-S3UQHW42.js";import"./chunk-VQHENXDQ.js";import"./chunk-VWF5VUO3.js";import"./chunk-HRP5LYWJ.js";import"./chunk-BIVFGNT6.js";import"./chunk-EUZMXXZJ.js";import"./chunk-7PEPFLZH.js";import{a as w}from"./chunk-BRVOQZDM.js";import{c as F,d as I}from"./chunk-3M7VXIQH.js";import"./chunk-TBYT66N3.js";import"./chunk-5PTS4JDF.js";import"./chunk-MUI46NAG.js";import{y as b}from"./chunk-N27U3N2T.js";import{a as O}from"./chunk-4R5NBZMW.js";import{a as S}from"./chunk-NDYVXEZ5.js";import"./chunk-CMMPCPP5.js";import"./chunk-4DLSYLKE.js";import"./chunk-VPXBKZQM.js";import"./chunk-ZTKK3KB7.js";import"./chunk-GZXWFBZI.js";import"./chunk-B7IARA3F.js";import"./chunk-IZVEJCCI.js";import"./chunk-TEY6TKJV.js";import{h as v}from"./chunk-4M6XQSBA.js";import"./chunk-2JF6YUJG.js";import{Q as i}from"./chunk-GGZQ5GCM.js";import{U as c}from"./chunk-TFUPB3ZG.js";import"./chunk-ANPNMGFG.js";import{a as r}from"./chunk-BMVJCP2M.js";import{D as g,o as f}from"./chunk-GMC3I5VG.js";import"./chunk-WGF2T2BG.js";import"./chunk-YZP43POT.js";import"./chunk-VEDIBGHD.js";import{t as h}from"./chunk-3IBUFXWY.js";import{a as m}from"./chunk-BP73DJTS.js";import{a as u,b as y,g as s}from"./chunk-JEGVIFEP.js";var n=class extends w{constructor(e){super(e),this.type="csv",this.refresh=g(t=>s(this,null,function*(){yield this.load();let{extent:l,timeExtent:a}=yield this._connection.invoke("refresh",t);return l&&(this.sourceJSON.extent=l),a&&(this.sourceJSON.timeInfo.timeExtent=[a.start,a.end]),{dataChanged:!0,updates:{extent:this.sourceJSON.extent,timeInfo:this.sourceJSON.timeInfo}}}))}load(e){let t=e!=null?e.signal:null;return this.addResolvingPromise(this._startWorker(t)),Promise.resolve(this)}destroy(){this._connection?.close(),this._connection=null}openPorts(){return s(this,null,function*(){return yield this.load(),this._connection.openPorts()})}queryFeatures(l){return s(this,arguments,function*(e,t={}){yield this.load(t);let a=yield this._connection.invoke("queryFeatures",e?e.toJSON():null,t);return _.fromJSON(a)})}queryFeaturesJSON(l){return s(this,arguments,function*(e,t={}){return yield this.load(t),this._connection.invoke("queryFeatures",e?e.toJSON():null,t)})}queryFeatureCount(l){return s(this,arguments,function*(e,t={}){return yield this.load(t),this._connection.invoke("queryFeatureCount",e?e.toJSON():null,t)})}queryObjectIds(l){return s(this,arguments,function*(e,t={}){return yield this.load(t),this._connection.invoke("queryObjectIds",e?e.toJSON():null,t)})}queryExtent(l){return s(this,arguments,function*(e,t={}){yield this.load(t);let a=yield this._connection.invoke("queryExtent",e?e.toJSON():null,t);return{count:a.count,extent:b.fromJSON(a.extent)}})}querySnapping(l){return s(this,arguments,function*(e,t={}){return yield this.load(t),this._connection.invoke("querySnapping",e,t)})}_startWorker(e){return s(this,null,function*(){this._connection=yield C("CSVSourceWorker",{strategy:m("feature-layers-workers")?"dedicated":"local",signal:e,registryTarget:this});let{url:t,delimiter:l,fields:a,latitudeField:j,longitudeField:x,spatialReference:P,timeInfo:L}=this.loadOptions,p=yield this._connection.invoke("load",{url:t,customParameters:this.customParameters,parsingOptions:{delimiter:l,fields:a?.map(T=>T.toJSON()),latitudeField:j,longitudeField:x,spatialReference:P?.toJSON(),timeInfo:L?.toJSON()}},{signal:e});this.locationInfo=p.locationInfo,this.sourceJSON=p.layerDefinition,this.delimiter=p.delimiter})}};r([i()],n.prototype,"type",void 0),r([i()],n.prototype,"loadOptions",void 0),r([i()],n.prototype,"customParameters",void 0),r([i()],n.prototype,"locationInfo",void 0),r([i()],n.prototype,"sourceJSON",void 0),r([i()],n.prototype,"delimiter",void 0),n=r([c("esri.layers.graphics.sources.CSVSource")],n);function J(e,t){throw new h(t,`CSVLayer (title: ${e.title}, id: ${e.id}) cannot be saved to a portal item`)}var o=class extends N{constructor(...e){super(...e),this.geometryType="point",this.capabilities=q(!1,!1),this.delimiter=null,this.editingEnabled=!1,this.fields=null,this.latitudeField=null,this.locationType="coordinates",this.longitudeField=null,this.operationalLayerType="CSV",this.outFields=["*"],this.path=null,this.spatialReference=S.WGS84,this.source=null,this.type="csv"}normalizeCtorArgs(e,t){return typeof e=="string"?u({url:e},t):e}load(e){let t=e!=null?e.signal:null,l=this.loadFromPortal({supportedTypes:["CSV"],supportsData:!1},e).catch(f).then(()=>s(this,null,function*(){return this.initLayerProperties(yield this.createGraphicsSource(t))}));return this.addResolvingPromise(l),Promise.resolve(this)}get isTable(){return this.loaded&&this.geometryType==null}readWebMapLabelsVisible(e,t){return t.showLabels!=null?t.showLabels:!!t.layerDefinition?.drawingInfo?.labelingInfo}set url(e){if(!e)return void this._set("url",e);let t=v(e);this._set("url",t.path),t.query&&(this.customParameters=u(u({},this.customParameters),t.query))}createGraphicsSource(e){return s(this,null,function*(){let t=new n({loadOptions:{delimiter:this.delimiter,fields:this.fields,latitudeField:this.latitudeField??void 0,longitudeField:this.longitudeField??void 0,spatialReference:this.spatialReference??void 0,timeInfo:this.timeInfo??void 0,url:this.url},customParameters:this.customParameters??void 0});return this._set("source",t),yield t.load({signal:e}),this.read({locationInfo:t.locationInfo,columnDelimiter:t.delimiter},{origin:"service",url:this.parsedUrl}),t})}queryFeatures(e,t){return this.load().then(()=>this.source.queryFeatures(d.from(e)||this.createQuery())).then(l=>{if(l?.features)for(let a of l.features)a.layer=a.sourceLayer=this;return l})}queryObjectIds(e,t){return this.load().then(()=>this.source.queryObjectIds(d.from(e)||this.createQuery()))}queryFeatureCount(e,t){return this.load().then(()=>this.source.queryFeatureCount(d.from(e)||this.createQuery()))}queryExtent(e,t){return this.load().then(()=>this.source.queryExtent(d.from(e)||this.createQuery()))}read(e,t){super.read(e,t),t&&t.origin==="service"&&this.revert(["latitudeField","longitudeField"],"service")}write(e,t){return super.write(e,y(u({},t),{writeLayerSchema:!0}))}clone(){throw new h("csv-layer:clone",`CSVLayer (title: ${this.title}, id: ${this.id}) cannot be cloned`)}save(e){return s(this,null,function*(){return J(this,"csv-layer:save")})}saveAs(e,t){return s(this,null,function*(){return J(this,"csv-layer:save-as")})}hasDataChanged(){return s(this,null,function*(){try{let{dataChanged:e,updates:t}=yield this.source.refresh(this.customParameters);return t!=null&&this.read(t,{origin:"service",url:this.parsedUrl,ignoreDefaults:!0}),e}catch{}return!1})}_verifyFields(){}_verifySource(){}_hasMemorySource(){return!1}};r([i({readOnly:!0,json:{read:!1,write:!1}})],o.prototype,"capabilities",void 0),r([i({type:[","," ",";","|","	"],json:{read:{source:"columnDelimiter"},write:{target:"columnDelimiter",ignoreOrigin:!0}}})],o.prototype,"delimiter",void 0),r([i({readOnly:!0,type:Boolean,json:{origins:{"web-scene":{read:!1,write:!1}}}})],o.prototype,"editingEnabled",void 0),r([i({json:{read:{source:"layerDefinition.fields"},write:{target:"layerDefinition.fields"}}})],o.prototype,"fields",void 0),r([i({type:Boolean,readOnly:!0})],o.prototype,"isTable",null),r([O("web-map","labelsVisible",["layerDefinition.drawingInfo.labelingInfo","showLabels"])],o.prototype,"readWebMapLabelsVisible",null),r([i({type:String,json:{read:{source:"locationInfo.latitudeFieldName"},write:{target:"locationInfo.latitudeFieldName",ignoreOrigin:!0}}})],o.prototype,"latitudeField",void 0),r([i({type:["show","hide"]})],o.prototype,"listMode",void 0),r([i({type:["coordinates"],json:{read:{source:"locationInfo.locationType"},write:{target:"locationInfo.locationType",ignoreOrigin:!0,isRequired:!0}}})],o.prototype,"locationType",void 0),r([i({type:String,json:{read:{source:"locationInfo.longitudeFieldName"},write:{target:"locationInfo.longitudeFieldName",ignoreOrigin:!0}}})],o.prototype,"longitudeField",void 0),r([i({type:["CSV"]})],o.prototype,"operationalLayerType",void 0),r([i()],o.prototype,"outFields",void 0),r([i({type:String,json:{origins:{"web-scene":{read:!1,write:!1}},read:!1,write:!1}})],o.prototype,"path",void 0),r([i({json:{read:!1},cast:null,type:n,readOnly:!0})],o.prototype,"source",void 0),r([i({json:{read:!1},value:"csv",readOnly:!0})],o.prototype,"type",void 0),r([i({json:{read:F,write:{isRequired:!0,ignoreOrigin:!0,writer:I}}})],o.prototype,"url",null),o=r([c("esri.layers.CSVLayer")],o);var he=o;export{he as default};
