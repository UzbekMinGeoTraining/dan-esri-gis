import{a as V,b as D}from"./chunk-6COCDKCX.js";import"./chunk-D4SBRLEM.js";import"./chunk-46ZNFCJZ.js";import"./chunk-4FRQLB6H.js";import"./chunk-6VWB6ZLL.js";import{a as E}from"./chunk-2YEZLTQO.js";import"./chunk-TOUCHIYC.js";import{E as C,G as A}from"./chunk-AB4CTIUZ.js";import"./chunk-2HYJESCC.js";import"./chunk-VJX4SEWU.js";import"./chunk-OZ5LGYCJ.js";import{a as m,b,c as h}from"./chunk-YGTZKLHU.js";import"./chunk-F7R3VTP4.js";import"./chunk-MNU4KXU7.js";import"./chunk-AJSXTGZB.js";import{p as F}from"./chunk-3KFX3FFC.js";import"./chunk-2WNCPIJC.js";import"./chunk-7ISKCG7U.js";import"./chunk-OFGHVREP.js";import"./chunk-3HX6VT75.js";import"./chunk-25T3ULWN.js";import"./chunk-X7XJWAFC.js";import"./chunk-CYCLIMTY.js";import"./chunk-NH3JQE75.js";import"./chunk-XXOIKNT6.js";import"./chunk-DBLGLVAQ.js";import"./chunk-HVNRUZWJ.js";import"./chunk-ZGDQY5ZD.js";import"./chunk-QH2MD2O2.js";import"./chunk-6EZNY6L4.js";import"./chunk-3IK5VXZ3.js";import"./chunk-7XLHE26H.js";import"./chunk-EN6CTWVM.js";import"./chunk-LVPMJTA6.js";import"./chunk-6GGK7PRJ.js";import"./chunk-AO7UDTUI.js";import"./chunk-Q7O5PY54.js";import"./chunk-NNETCWLJ.js";import"./chunk-TWW3KW7Z.js";import"./chunk-HWN5REN7.js";import"./chunk-XTES2GPX.js";import"./chunk-2HUIJUS4.js";import{a as u,c as _,h as c}from"./chunk-MBJHSEMD.js";import"./chunk-2R4SNL6O.js";import"./chunk-TSNWBMBA.js";import"./chunk-OFZ6SV37.js";import"./chunk-5MNDZ6BX.js";import"./chunk-YSOJWUIW.js";import"./chunk-Q5WFUDPQ.js";import"./chunk-DPZGANVI.js";import"./chunk-T7BKG6V3.js";import"./chunk-R6VC74T7.js";import"./chunk-6WKJD7BM.js";import"./chunk-3CR7P5WT.js";import"./chunk-YRTBL7EE.js";import"./chunk-3FPO2LOS.js";import"./chunk-QNZSBADV.js";import"./chunk-PYQRTZNZ.js";import"./chunk-GYH7NDHH.js";import"./chunk-S3UQHW42.js";import"./chunk-VQHENXDQ.js";import"./chunk-VWF5VUO3.js";import"./chunk-HRP5LYWJ.js";import"./chunk-BIVFGNT6.js";import"./chunk-5PTS4JDF.js";import"./chunk-MUI46NAG.js";import"./chunk-N27U3N2T.js";import"./chunk-4R5NBZMW.js";import"./chunk-NDYVXEZ5.js";import"./chunk-CMMPCPP5.js";import"./chunk-4DLSYLKE.js";import"./chunk-VPXBKZQM.js";import"./chunk-ZTKK3KB7.js";import"./chunk-GZXWFBZI.js";import"./chunk-B7IARA3F.js";import"./chunk-IZVEJCCI.js";import"./chunk-TEY6TKJV.js";import"./chunk-4M6XQSBA.js";import"./chunk-2JF6YUJG.js";import{Q as r,S as w}from"./chunk-GGZQ5GCM.js";import{U as f}from"./chunk-TFUPB3ZG.js";import"./chunk-ANPNMGFG.js";import{a}from"./chunk-BMVJCP2M.js";import{l as s,s as S}from"./chunk-GMC3I5VG.js";import"./chunk-WGF2T2BG.js";import"./chunk-YZP43POT.js";import"./chunk-VEDIBGHD.js";import"./chunk-3IBUFXWY.js";import"./chunk-BP73DJTS.js";import{g as y}from"./chunk-JEGVIFEP.js";var o=class extends w{get availability(){return 1}get _snappingElevationAligner(){let{view:e}=this,{layer:t}=this.layerSource,i=e!=null&&e.type==="3d";if(!i||t.type==="subtype-group")return m();let n=(l,p)=>y(this,null,function*(){return(yield S(e.whenLayerView(t),p)).elevationAlignPointsInFeatures(l,p)});return m(i,{elevationInfo:t.elevationInfo,alignPointsInFeatures:n})}get _snappingElevationFilter(){let{view:e}=this,t=e!=null&&e.type==="3d"&&this.layerSource.layer.type!=="subtype-group";return b(t)}get _symbologySnappingFetcher(){let{view:e}=this,{layer:t}=this.layerSource;return e!=null&&e.type==="3d"&&t.type!=="subtype-group"?h(this._symbologySnappingSupported,(i,n)=>y(this,null,function*(){let l=yield e.whenLayerView(t);return s(n),l.queryForSymbologySnapping({candidates:i,spatialReference:e.spatialReference},n)})):h()}get _layerView3D(){let{view:e}=this;if(e==null||e.type==="2d")return null;let{layer:t}=this.layerSource;return e.allLayerViews.find(i=>i.layer===t)}get _symbologySnappingSupported(){return this._layerView3D!=null&&this._layerView3D.symbologySnappingSupported}initialize(){let{view:e}=this,{layer:t}=this.layerSource;e!=null&&e.type==="3d"&&t.type!=="subtype-group"&&this.addHandles([e.elevationProvider.on("elevation-change",({context:i})=>{let{elevationInfo:n}=t;F(i,n)&&this._snappingElevationAligner.notifyElevationSourceChange()}),u(()=>t.elevationInfo,()=>this._snappingElevationAligner.notifyElevationSourceChange(),c),u(()=>this._layerView3D!=null?this._layerView3D.layer?.renderer:null,()=>this._symbologySnappingFetcher.notifySymbologyChange(),c),_(()=>this._layerView3D?.layer,["edits","apply-edits","graphic-update"],()=>this._symbologySnappingFetcher.notifySymbologyChange())])}constructor(e){super(e),this.view=null,this.updating=!1,this._memoizedMakeGetGroundElevation=E(D)}refresh(){}fetchCandidates(e,t){return y(this,null,function*(){let{layer:i}=this.layerSource,n=i.source;if(!n?.querySnapping)return[];let l=A(i),p=C(e,this.view?.type??"2d",l),I=yield n.querySnapping(p,{signal:t});s(t);let d=e.coordinateHelper.spatialReference,g=yield this._snappingElevationAligner.alignCandidates(I.candidates,d,t);s(t);let v=yield this._symbologySnappingFetcher.fetch(g,t);s(t);let G=v.length===0?g:[...g,...v],k=this._snappingElevationFilter.filter(p,G),x=this._memoizedMakeGetGroundElevation(this.view,d);return k.map(z=>V(z,x))})}};a([r({constructOnly:!0})],o.prototype,"layerSource",void 0),a([r({constructOnly:!0})],o.prototype,"view",void 0),a([r()],o.prototype,"_snappingElevationAligner",null),a([r()],o.prototype,"_snappingElevationFilter",null),a([r()],o.prototype,"_symbologySnappingFetcher",null),a([r()],o.prototype,"_layerView3D",null),a([r()],o.prototype,"_symbologySnappingSupported",null),o=a([f("esri.views.interactive.snapping.featureSources.FeatureCollectionSnappingSource")],o);export{o as FeatureCollectionSnappingSource};
