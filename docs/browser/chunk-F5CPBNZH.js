var P=9999999e31,T=2e-7,y={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function m(t){return y[t]??[-34028234663852886e22,34028234663852886e22]}function S(t,e){return t==null||e==null?"s32":t<0?t>=-128&&e<128?"s8":t>=-32768&&e<32768?"s16":"s32":e<256?"u8":e<65536?"u16":"u32"}function A(t){return(t?.startsWith("s")||t?.startsWith("u"))??!1}function V(t,e,n,l){let[a,o]=m(n),s=A(n);return s&&(a-=1e-5,o+=1e-5),s?n.startsWith("u")?E(t,e,l,[a,o]):I(t,e,l,[a,o]):L(t,e,l,[a,o])}function v(t,e){for(let n=0;n<e.length;n++)e[n]&&isNaN(t[n])&&(e[n]=0,t[n]=0)}function E(t,e,n,l){let[a,o]=l;for(let s=0;s<e.length;s++)if(e[s]){let i=t[s];i<a||i>o?e[s]=0:n[s]=i+.5|0}}function I(t,e,n,l){let[a,o]=l;for(let s=0;s<e.length;s++)if(e[s]){let i=t[s];i<a||i>o?e[s]=0:n[s]=i+(i>0?.5:-.5)|0}}function L(t,e,n,l){let[a,o]=l;for(let s=0;s<e.length;s++)if(e[s]){let i=t[s];i<a||i>o?e[s]=0:n[s]=i}}function O(t,e,n){if(t.depthCount&&t.depthCount>1)return;let{pixels:l,statistics:a,pixelType:o}=t,s=l[0].length,i=t.bandMasks??[],p=t.mask??new Uint8Array(s).fill(255),x=o==="f32"||o==="f64",b=m(o),N=!1;for(let c=0;c<l.length;c++){let r=typeof e=="number"?e:e[c];if(r==null)continue;let M=a?.[c]?.minValue??b[0],k=a?.[c]?.maxValue??b[1];if(M>r+Number.EPSILON||k<r-Number.EPSILON)continue;let g=i[c]||p.slice(),h=l[c],d=n?.customFloatTolerance;if(x&&d!==0){let u=d;u||(u=Math.abs(r)>=P?T*Math.abs(r):o==="f32"?2**-23:Number.EPSILON);for(let f=0;f<h.length;f++)g[f]&&Math.abs(h[f]-r)<u&&(h[f]=0,g[f]=0,p[f]=0,N=!0)}else for(let u=0;u<h.length;u++)g[u]&&h[u]===r&&(h[u]=0,g[u]=0,p[u]=0,N=!0);i[c]=g}N&&(t.bandMasks=t.bandMasks||t.pixels.length>1?i:null,t.mask=p),N&&"updateStatistics"in t&&t.updateStatistics()}export{m as a,S as b,A as c,V as d,v as e,O as f};
