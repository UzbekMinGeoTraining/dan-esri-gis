import{a as Ce,g as z,k as ut}from"./chunk-XHUVNHST.js";import{a as U}from"./chunk-MCSHFXJF.js";import{a as Qe}from"./chunk-BEXNUKSP.js";import{a as We}from"./chunk-NPSROKUX.js";import{a as tt,b as rt}from"./chunk-A2IYJOJO.js";import{a as it,b as ot}from"./chunk-LB3WSIYI.js";import{a as Ke,b as Xe}from"./chunk-22JBWFHY.js";import{a as lt}from"./chunk-VZPIZOOE.js";import{a as et,b as pt}from"./chunk-R7X3CKFH.js";import{a as at,b as st}from"./chunk-64FW22PO.js";import{c as nt}from"./chunk-3EB3OCOV.js";import{a as dt}from"./chunk-7Z3Y27UA.js";import{b as Ye,d as ue}from"./chunk-3A66AUSD.js";import{b as $e}from"./chunk-GNKF5TIB.js";import{a as Ue,b as Be,c as ze}from"./chunk-X4XHTJSF.js";import{a as He}from"./chunk-R3XRMWAK.js";import{c as ht,d as ft,f as gt,i as Tt,m as bt,n as wt}from"./chunk-J2R7NR2E.js";import{a as Ge}from"./chunk-OD6TX477.js";import{a as Et}from"./chunk-ISUG5L3D.js";import{h as ct}from"./chunk-FIUHDVVO.js";import{a as Ze}from"./chunk-C3YONAAM.js";import{n as Je}from"./chunk-Y5M2SONX.js";import{b as B}from"./chunk-ZGDQY5ZD.js";import{e as oe}from"./chunk-LVPMJTA6.js";import{a as ce,d as Ve}from"./chunk-7NYR66Q3.js";import{m as Le}from"./chunk-PM4ZR7W6.js";import{a as Ne}from"./chunk-RI3FIROF.js";import{h as K,t as ne}from"./chunk-FW33MEBA.js";import{c as yt,d as mt}from"./chunk-7D4IYTAJ.js";import{a as _e}from"./chunk-TSNWBMBA.js";import{a as $}from"./chunk-YSOJWUIW.js";import{f as je}from"./chunk-Q5WFUDPQ.js";import{o as ie,p as Ie}from"./chunk-T7BKG6V3.js";import{l as Ee,y as Z}from"./chunk-N27U3N2T.js";import{a as we}from"./chunk-NDYVXEZ5.js";import{a as qe}from"./chunk-CMMPCPP5.js";import{C as j}from"./chunk-4DLSYLKE.js";import{b as Oe}from"./chunk-IZVEJCCI.js";import{k as Pe}from"./chunk-TEY6TKJV.js";import{Q as c,S as xe,m as ke}from"./chunk-GGZQ5GCM.js";import{U as Y,u as G}from"./chunk-TFUPB3ZG.js";import{a as d}from"./chunk-BMVJCP2M.js";import{b as k,r as re,t as q}from"./chunk-3IBUFXWY.js";import{a as J,b as ve,d as Ae,g as _}from"./chunk-JEGVIFEP.js";var v="ESRI__ID",ae="ESRI__OriginID",se="ESRI__DestID",ye="ESRI__LayoutGeometry",Me="ESRI__AggregationCount",H="LC.ESRI__IsSpatial",Ht={initializeLayersFromClientData:(e,t)=>_(void 0,null,function*(){if(t||(t=[...e.layers,...e.tables].map(n=>n.graphTypeName)),t?.length===0)return;let i=new Map;for(let n of t)i.set(n,It(e,n));let r=yield ut(e.dataManager.knowledgeGraph,Array.from(i.values()));for(let n of[...e.layers,...e.tables]){let o=n.objectType.name;if(o===null)continue;let s=r.get(It(e,o));if(s){let p=JSON.parse(s);p===null||typeof p!="object"||p.hasOwnProperty("showLabels")||(p.showLabels=!1),n.read(p,{origin:"service"})}}})},It=(e,t)=>e.type==="knowledge-graph"?`${t}/Map`:`${t}/LinkChart/LinkChartSubLayer`;function rr(e,t){return _(this,null,function*(){return Ht.initializeLayersFromClientData(e,t)})}var Q=class e{constructor(){this._featureLookup=new Map}static getInstance(){return e.instance||(e.instance=new e),e.instance}static resetInstance(){e.instance&&(e.instance=null)}deleteFromStore(t){t.forEach(i=>{this._featureLookup.delete(i)})}readFromStoreByList(t){let i=[];return t.forEach(r=>{let n=this.readFromStoreById(r);n&&i.push(n)}),i}readFromStoreById(t){return this._featureLookup.get(t)??null}writeToStore(t,i,r){let n=[];return t.forEach(o=>{if(!o?.id)return;o.properties||(o.properties=[]);let s,p=null;if(r&&o.properties[r]&&(p=Le(o.properties[r])),"originId"in o&&"destinationId"in o&&(o.properties[ae]=o.originId,o.properties[se]=o.destinationId),o.properties[i]=o.id,o.id&&this._featureLookup.has(o.id)&&this._featureLookup.get(o.id).attributes){let a=this._featureLookup.get(o.id),l=JSON.parse(JSON.stringify(Object.assign(a.attributes,o.properties)));r&&o.properties[r]&&(l[r]=je(o.properties[r])),s=new Ne(p?JSON.parse(JSON.stringify(p)):a?.geometry?JSON.parse(JSON.stringify(a.geometry)):null,l,null,o.properties[i])}else s=new Ne(p?JSON.parse(JSON.stringify(p)):null,o.properties,null,o.properties[i]);this._featureLookup.set(`${o.typeName?`${o.typeName}__${o.id}`:o.id}`,s),n.push(s)}),n}};var Se,E=null;function ur(){return Se||(Se=import("./chunk-EMPGLKDT.js").then(e=>e.l).then(({default:e})=>e({locateFile:t=>Oe(`esri/libs/linkchartlayout/${t}`)})).then(e=>{Qt(e)}),Se)}function Qt(e){E=e}var _t,Nt,X,le;function Wt(e){let t=Object.keys(X).filter(r=>isNaN(parseInt(r,10))).indexOf(e.timeDirection),i=Object.keys(le).filter(r=>isNaN(parseInt(r,10))).indexOf(e.eventsTicksVisualization);return{timeDirection:{value:t>-1?t:X.right},timeBannerUTCOffsetInMinutes:e.timeBannerUTCOffsetInMinutes,eventsTicksVisualization:{value:i>-1?i:le.startAndEnd},showDurationLineForNonZeroDurationEntityEvents:e.showDurationLineForNonZeroDurationEntityEvents,durationLineWidth:e.durationLineWidth,entityPositionAtDurationRatio:e.entityPositionAtDurationRatio,showNonZeroDurationIntervalBounds:e.showNonZeroDurationIntervalBounds,separateTimeOverlaps:e.separateTimeOverlaps,separateTimelineOverlaps:e.separateTimelineOverlaps,moveFirstBends:e.moveFirstBends,secondBendRatio:e.secondBendRatio,lineSeparationMultiplier:e.lineSeparationMultiplier,spaceSeparatedLinesEvenly:e.spaceSeparatedLinesEvenly,useBezierCurves:e.useBezierCurves,separatedLineShapeRatio:e.separatedLineShapeRatio}}function W(e,t,i,r,n,o){let s=i.length,p=n.length,a=Float64Array.BYTES_PER_ELEMENT,l=Uint32Array.BYTES_PER_ELEMENT,h=Uint8Array.BYTES_PER_ELEMENT,T=16,u=T+s*(h+2*a)+p*(2*l),b=E._malloc(u);try{let g=b+T-b%T,y=g+s*a,N=y+s*a,L=N+p*l,C=L+p*l,w=()=>[E.HEAPF64.subarray(g>>3,(g>>3)+s),E.HEAPF64.subarray(y>>3,(y>>3)+s),E.HEAPU32.subarray(N>>2,(N>>2)+p),E.HEAPU32.subarray(L>>2,(L>>2)+p),E.HEAPU8.subarray(C,C+s)],[S,I,m,A,M]=w();S.set(i),I.set(r),m.set(n),A.set(o),M.set(t);let R=e(s,C,g,y,p,N,L),D=null,O=null;if(R){let ge=E.getLayoutLinksTypes(),Te=E.getLayoutLinksVerticesEndIndices(),be=E.getLayoutLinksVertices(),Re=E.countLayoutLinksVertices();!p||ge&&Te?Re&&!be?R=!1:(D={types:new Uint8Array(E.HEAPU8.subarray(ge,ge+p)),vertexEndIndex:new Uint32Array(E.HEAPU32.subarray(Te>>2,(Te>>2)+p)),vertices:new Float64Array(E.HEAPF64.subarray(be>>3,(be>>3)+2*Re))},O=E.getAuxiliaryGraphicElements()):R=!1}let[F,ee,te,fe,$t]=w();return i.set(F),r.set(ee),n.set(te),o.set(fe),t.set($t),{success:R,links:D,graphics:O}}finally{E._free(b),E.cleanupLayout()}}(function(e){e[e.None=0]="None",e[e.IsMovable=1]="IsMovable",e[e.IsGeographic=2]="IsGeographic",e[e.IsRoot=4]="IsRoot",e[e.IsOld=8]="IsOld"})(_t||(_t={})),function(e){e[e.Regular=0]="Regular",e[e.Curved=1]="Curved",e[e.Recursive=2]="Recursive"}(Nt||(Nt={})),function(e){e[e.right=0]="right",e[e.left=1]="left",e[e.top=2]="top",e[e.bottom=3]="bottom"}(X||(X={})),function(e){e[e.none=0]="none",e[e.startOnly=1]="startOnly",e[e.startAndEnd=2]="startAndEnd"}(le||(le={}));var Lt=2,Ct=1,Mt=-1,St,Ft,Dt,Rt,vt,At,kt,xt,Ot;(function(e){function t(){return E.getMinIdealEdgeLength()}function i(r,n,o,s,p,a=Lt,l=Ct,h=Mt){return W((T,u,b,g,y,N,L)=>E.applyForceDirectedLayout(T,u,b,g,y,N,L,a,l,h),r,n,o,s,p)}e.getMinIdealEdgeLength=t,e.apply=i})(St||(St={})),function(e){function t(i,r,n,o,s,p=Lt,a=Ct,l=Mt){return W((h,T,u,b,g,y,N)=>E.applyCommunityLayout(h,T,u,b,g,y,N,p,a,l),i,r,n,o,s)}e.apply=t}(Ft||(Ft={})),function(e){function t(i,r,n,o,s){return W(E.applySimpleLayout,i,r,n,o,s)}e.apply=t}(Dt||(Dt={})),function(e){function t(i,r,n,o,s){return W(E.applyHierarchicalLayout,i,r,n,o,s)}e.apply=t}(Rt||(Rt={})),function(e){function t(i,r,n,o,s){return W(E.applyRadialTreeLayout,i,r,n,o,s)}e.apply=t}(vt||(vt={})),function(e){function t(i,r,n,o,s){return W(E.applySmartTreeLayout,i,r,n,o,s)}e.apply=t}(At||(At={})),function(e){function t(i,r,n,o,s,p,a,l,h,T,u){let b={timeDirection:X.right,timeBannerUTCOffsetInMinutes:0,eventsTicksVisualization:le.startAndEnd,showDurationLineForNonZeroDurationEntityEvents:!0,durationLineWidth:5,entityPositionAtDurationRatio:1,showNonZeroDurationIntervalBounds:!1,separateTimeOverlaps:!0,separateTimelineOverlaps:!0,moveFirstBends:!0,secondBendRatio:.3,lineSeparationMultiplier:1,spaceSeparatedLinesEvenly:!1,useBezierCurves:!1,separatedLineShapeRatio:0};return W((g,y,N,L,C,w,S)=>{if(o.length!==g||s.length!==g||l.length!==C||h.length!==C)return!1;let I=Float64Array.BYTES_PER_ELEMENT,m=16,A=E._malloc(m+g*I),M=E._malloc(m+g*I),R=E._malloc(m+C*I),D=E._malloc(m+C*I),O=A+m-A%m,F=M+m-M%m,ee=R+m-R%m,te=D+m-D%m;try{E.HEAPF64.subarray(O>>3,(O>>3)+g).set(o),E.HEAPF64.subarray(F>>3,(F>>3)+g).set(s),E.HEAPF64.subarray(ee>>3,(ee>>3)+C).set(l),E.HEAPF64.subarray(te>>3,(te>>3)+C).set(h);let fe=Wt(Object.assign(b,u));return E.applyChronologicalLayout(g,y,N,L,O,F,C,w,S,ee,te,T,fe)}finally{E._free(A),E._free(M),E._free(R),E._free(D)}},i,r,n,p,a)}e.apply=t}(kt||(kt={})),function(e){e[e.Undirected=0]="Undirected",e[e.Directed=1]="Directed",e[e.Reversed=2]="Reversed"}(xt||(xt={})),function(e){e[e.ByCC_Raw=0]="ByCC_Raw",e[e.ByCC_NormalizeGlobally=1]="ByCC_NormalizeGlobally",e[e.ByCC_NormalizeByCC=2]="ByCC_NormalizeByCC"}(Ot||(Ot={}));var pe;(function(e){e.ELEMENTUID="ELEMENTUID",e.TYPENAME="TYPENAME"})(pe||(pe={}));var Vt=[pe.ELEMENTUID,pe.TYPENAME],Fe,De;(function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"})(Fe||(Fe={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(De||(De={}));var Pt,me,he,V;(function(e){e[e.featureResult=0]="featureResult",e[e.countResult=1]="countResult",e[e.idsResult=2]="idsResult"})(Pt||(Pt={})),function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(me||(me={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(he||(he={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(V||(V={}));function qt(e){if(!e.spatialReference.isWGS84)throw new q("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map(t=>[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]])}function ai(e,t){return _(this,null,function*(){let i=[],r=new Map,n=[];if(t.dataModel?.relationshipTypes)for(let o of t.dataModel.relationshipTypes)o.name&&r.set(o.name,[]);for(let o of e)r.has(o.typeName)&&r.get(o.typeName)?.push(o.id);for(let[o,s]of r){if(s.length<1)continue;let p=new U({openCypherQuery:`MATCH (n)-[r:${o}]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]`,bindParameters:{ids:s}});n.push(z(t,p).then(a=>_(this,null,function*(){let l=a.resultRowsStream.getReader();for(;;){let{done:h,value:T}=yield l.read();if(h)break;for(let u of T)i.push({id:u[0],typeName:u[1]}),i.push({id:u[2],typeName:u[3]})}})))}return yield Promise.all(n),i})}function si(e,t){return _(this,null,function*(){t??=!1;let i={generateAllSublayers:t,namedTypeDefinitions:new Map};return yield Zt(e).then(r=>{Xt(r,i)}),i})}function li(e){return _(this,null,function*(){let t=yield Ce(),i=new t.MapOfObjectIdentifierSets;Yt(i,t,e);let r=new t.MapOfObjectIdentifierSetsEncoder;try{r.set_map_of_identifier_sets(i),r.encode();let n=r.get_encoding_result();if(n.error.error_code!==0)throw new q("knowledge-graph:layer-support-utils",n.error.error_message);let o=structuredClone(n.get_byte_buffer());return r.delete(),o}finally{i.delete()}})}function Yt(e,t,i){for(let[r,n]of i.namedTypeDefinitions){if(!n.members||n.useAllData)continue;let o=n.members.keys(),s=!1,p=!0,a=new t.ObjectIdArray,l=new t.StringArray,h=new t.GlobalIdArray,T=new t.IdentifierArray,u=new t.ObjectIdentifierSet;for(let b of o)p&&(s=!isNaN(Number(b)),p=!1),s?a.add_objectid(Number(b)):(l.add_string(b),h.add_globalid(b)),T.add_identifier(b);u.set_oid_array(a),u.set_string_array(l),u.set_globalid_array(h),u.set_identifier_array(T),a.delete(),l.delete(),h.delete(),T.delete(),e.put_identifier_set(r,u),u.delete()}return e}function Zt(e){return _(this,null,function*(){let t=yield Pe(e,{responseType:"array-buffer"}),i=yield t.data;return Kt(new Uint8Array(i))})}function Kt(e){return _(this,null,function*(){let t=new(yield Ce()).MapOfObjectIdentifierSetsDecoder,i=t.decode(new Uint8Array(e)),r=new Map;if(i.error_code!==0)throw new q("knowledge-graph:layer-support-utils",i.error_message);let n=t.get_map_of_identifier_sets(),o=n.keys,s=o.size();for(let p=0;p<s;p++){let a=o.get(p),l=n.query_identifier_set(a),h=[];if(l.id_array_type.value===V.GLOBALID_ARRAY){let T=l.get_globalid_array(),u=T.count();for(let b=0;b<u;b++)h.push(T.get_globalid_at(b))}else if(l.id_array_type.value===V.IDENTIFIER_ARRAY){let T=l.get_identifier_array(),u=T.count();for(let b=0;b<u;b++)h.push(T.get_identifier_at(b).toString())}else if(l.id_array_type.value===V.STRING_ARRAY){let T=l.get_string_array(),u=T.count();for(let b=0;b<u;b++)h.push(T.get_string_at(b))}else{if(l.id_array_type.value!==V.OID_ARRAY)throw new q("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{let T=l.get_oid_array(),u=T.count();for(let b=0;b<u;b++)h.push(T.get_objectid_at(b).toString())}}r.set(a,h)}return t.delete(),r})}function Xt(e,t){for(let[i,r]of e){let n=G(t.namedTypeDefinitions,i,()=>({useAllData:!1,members:new Map}));for(let o of r)n.members.has(o)||n.members.set(o,{id:o})}return t}var P=class extends xe{constructor(e){super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;let t=new Map;e.knowledgeGraph.dataModel.entityTypes?.forEach(i=>{i.name&&(t.set(i.name,"entity"),this._processingCacheUpdatesLookup.set(i.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.entityTypeNames.add(i.name),i.properties?.forEach(r=>{r.geometryType&&r.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(i.name,{name:r.name??"",geometryType:r.geometryType})}))}),e.knowledgeGraph.dataModel.relationshipTypes?.forEach(i=>{i.name&&(t.set(i.name,"relationship"),this._processingCacheUpdatesLookup.set(i.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.relationshipTypeNames.add(i.name),i.properties?.forEach(r=>{r.geometryType&&r.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(i.name,{name:r.name??"",geometryType:r.geometryType})}))}),e.inclusionModeDefinition?.namedTypeDefinitions.forEach((i,r)=>{if(t.get(r)==="entity")this.entityTypeNames.add(r);else{if(t.get(r)!=="relationship")return re.getLogger(this).warn(`A named type, ${r}, was in the inclusion list that wasn't in the data model and will be removed`),void e.inclusionModeDefinition?.namedTypeDefinitions.delete(r);this.relationshipTypeNames.add(r)}let n=new Map;i.members?.forEach(o=>{G(this.memberIdTypeLookup,o.id,()=>new Set).add(r);let s=this.getById(o.id);s&&n.set(o.id,s)}),this.sublayerCaches.set(r,n)})}addToLayer(e){e.forEach(({typeName:t,id:i})=>{if(!this.inclusionModeDefinition)throw new q("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){let r=this.inclusionModeDefinition.namedTypeDefinitions.get(t);r.members||(r.members=new Map),r.members.set(i,{id:i}),G(this.memberIdTypeLookup,i,()=>new Set).add(t)}}else{let r=new Map;r.set(i,{id:i}),this.inclusionModeDefinition.namedTypeDefinitions.set(t,{useAllData:!1,members:r}),G(this.memberIdTypeLookup,i,()=>new Set).add(t)}})}getById(e){return Q.getInstance().readFromStoreById(e)}getData(e,t,i){return _(this,null,function*(){if(t.objectType.name&&this.inclusionModeDefinition?.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let r;if(r=e||new B({where:"1=1",outFields:["*"]}),t.parentCompositeLayer.type==="link-chart"){let n=t.parentCompositeLayer,o=this._processingCacheUpdatesLookup.get(t.objectType.name??""),s=r.outFields;s&&s.length===1&&s[0]===v&&r.where==="1=1"||(yield Promise.all(o??[]));let p=this.sublayerCaches.has(t.objectType.name??"")?Array.from(this.sublayerCaches.get(t.objectType.name)?.values()):[],a=[];return p.forEach(l=>{if(this.relationshipTypeNames.has(t.objectType.name)){l.geometry=n.relationshipLinkChartDiagramLookup.get(l.attributes[t.objectIdField]);let h=this.memberIdTypeLookup.get(l.attributes[ae]),T=this.memberIdTypeLookup.get(l.attributes[se]),u=this._isEndEntitySpatial(h,l,ae),b=this._isEndEntitySpatial(T,l,se);l.attributes[H]=Number(u&&b)}else{l.geometry=n.entityLinkChartDiagramLookup.get(l.attributes[t.objectIdField]);let h=this.geographicLookup.get(t.objectType.name);h&&l.attributes[h.name]?l.attributes[H]=1:l.attributes[H]=0}l.attributes[ye]=l.geometry,a.push(l)}),a}return this.retrieveDataFromService(r,t,i)})}getConnectedRecordIds(e,t){return _(this,null,function*(){let i=[],r="",n=[],o=new Map;if(e.forEach(h=>{if(this.memberIdTypeLookup.has(h))for(let T of this.memberIdTypeLookup.get(h)){if(!this.entityTypeNames.has(T))return;o.has(T)?o.get(T)?.push(h):o.set(T,[h])}}),t&&t?.length!==0){for(let h of t)r=r+h+"|";r=r.slice(0,-1)}let s={},p="",a=-1;for(let[h,T]of o){a++,a!==0&&(p+=" UNION ");let u=`${h}_ids`;s[u]=T,p+=t&&t?.length!==0?`MATCH (n:${h}) WHERE id(n) IN $${u} WITH n MATCH (n)-[r:${r}]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`:`MATCH (n:${h}) WHERE id(n) IN $${u} WITH n MATCH (n)-[r]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`}if(!p)return i;let l=new Promise(h=>{_(this,null,function*(){let T=(yield z(this.knowledgeGraph,new U({openCypherQuery:p,bindParameters:s}))).resultRowsStream.getReader();try{for(;;){let{done:u,value:b}=yield T.read();if(u)break;for(let g=0;g<b.length;g++){let y=b[g];i.push({id:y[0],typeName:y[1]}),i.push({id:y[2],typeName:y[3]})}}}catch(u){if(u.name!=="AbortError")throw u;re.getLogger(this).info("Request aborted as expected")}}).then(()=>{h()})});return n.push(l),this.refreshCacheContent(),yield Promise.all(n),i})}getRelationshipsBetweenNodes(e,t){return _(this,null,function*(){let i=[],r="MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",n=(yield z(this.knowledgeGraph,new U({openCypherQuery:r,bindParameters:{nodeIds:e,relationshipExclusionIds:t}}))).resultRowsStream.getReader();try{for(;;){let{done:o,value:s}=yield n.read();if(o)break;for(let p=0;p<s.length;p++){let a=s[p];i.push({id:a[0],typeName:a[1]})}}}catch(o){if(o.name!=="AbortError")throw o;re.getLogger(this).info("Request aborted as expected")}return i})}getRelationshipsFromNodes(e,t,i){return _(this,null,function*(){let r=[],n="MATCH (n)-[r]-(m) WHERE id(n) IN $targetEntityIds AND id(m) in $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",o=(yield z(this.knowledgeGraph,new U({openCypherQuery:n,bindParameters:{targetEntityIds:e,possibleConnectionEntityIds:t,relationshipExclusionIds:i}}))).resultRowsStream.getReader();try{for(;;){let{done:s,value:p}=yield o.read();if(s)break;for(let a=0;a<p.length;a++){let l=p[a];r.push({id:l[0],typeName:l[1]})}}}catch(s){if(s.name!=="AbortError")throw s;re.getLogger(this).info("Request aborted as expected")}return r})}refreshCacheContent(e,t,i,r=!0){return _(this,null,function*(){let n=Q.getInstance(),o=[],s=new Map,p=new Map;this.knowledgeGraph.dataModel.entityTypes?.forEach(a=>{a.name&&p.set(a.name,a)}),this.knowledgeGraph.dataModel.relationshipTypes?.forEach(a=>{a.name&&p.set(a.name,a)}),e||this.inclusionModeDefinition?e?e.forEach(a=>{if(this.memberIdTypeLookup.has(a))for(let l of this.memberIdTypeLookup.get(a))s.has(l)?s.get(l)?.push(a):s.set(l,[a])}):this.inclusionModeDefinition?.namedTypeDefinitions?.forEach((a,l)=>{a.useAllData?s.set(l,null):a.members&&a.members.forEach(h=>{s.has(l)&&s.get(l)!==null?s.get(l)?.push(h.id):s.set(l,[h.id])})}):(this.knowledgeGraph.dataModel.entityTypes?.forEach(a=>{a.name&&s.set(a.name,null)}),this.knowledgeGraph.dataModel.entityTypes?.forEach(a=>{a.name&&s.set(a.name,null)}));for(let[a,l]of s){let h=new Promise(T=>{_(this,null,function*(){let b=new Set,g=[],y,N="",L=!1;if(t||p.get(a)?.properties?.forEach(w=>{w.name&&b.add(w.name)}),i&&this.geographicLookup.has(a)){let w=this.geographicLookup.get(a)?.name;w&&b.add(w)}if(this.entityTypeNames.has(a))N=`MATCH (n:${a}) ${l?"WHERE id(n) IN $ids ":""}return ID(n)`,b.forEach(w=>{N+=`, n.${w}`,g.push(w)});else{if(!this.relationshipTypeNames.has(a))throw new q("knowledge-graph:layer-data-manager",`The graph type of ${a} could not be determined. Was this type set in the KG data model and inclusion definition?`);L=!0,N=`MATCH ()-[n:${a}]->() ${l?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,b.forEach(w=>{N+=`, n.${w}`,g.push(w)})}y=new U(l?{openCypherQuery:N,bindParameters:{ids:l}}:{openCypherQuery:N});let C=(yield z(this.knowledgeGraph,y)).resultRowsStream.getReader();for(;;){let{done:w,value:S}=yield C.read();if(w)break;let I=[];for(let M=0;M<S.length;M++){let R=S[M],D=0,O=0,F={properties:{}};for(F.id=R[D],D++,O++,L&&(F.originId=R[D],D++,O++,F.destinationId=R[D],D++,O++,G(this.nodeConnectionsLookup,F.originId,()=>new Set).add(F.id),G(this.nodeConnectionsLookup,F.destinationId,()=>new Set).add(F.id),G(this.relationshipConnectionsLookup,F.id,()=>[F.originId,F.destinationId]));D<R.length;D++)F.properties[g[D-O]]=R[D];I.push(F)}let m=n.writeToStore(I,v,this.geographicLookup.get(a)?.name);this.sublayerCaches.has(a)||this.sublayerCaches.set(a,new Map),r&&!this.inclusionModeDefinition?.namedTypeDefinitions.has(a)&&this.inclusionModeDefinition?.namedTypeDefinitions.set(a,{useAllData:!1,members:new Map}),r&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(a).members&&(this.inclusionModeDefinition.namedTypeDefinitions.get(a).members=new Map);let A=this.sublayerCaches.get(a);m.forEach(M=>{A?.set(M.attributes[v],M),r&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(a).members.has(M.attributes[v])&&(this.inclusionModeDefinition?.namedTypeDefinitions.get(a).members.set(M.attributes[v],{id:M.attributes[v]}),G(this.memberIdTypeLookup,M.attributes[v],()=>new Set).add(a))})}}).then(()=>{T(null)})});o.push(h),this._processingCacheUpdatesLookup.get(a)?.push(h)}yield Promise.all(o)})}removeFromLayer(e){let t=new Set,i=new Set(e.map(r=>r.id));for(let r of e)t.add(r.typeName),this.memberIdTypeLookup.get(r.id)?.size===1?this.memberIdTypeLookup.delete(r.id):this.memberIdTypeLookup.get(r.id)?.delete(r.typeName),this.inclusionModeDefinition?.namedTypeDefinitions.forEach((n,o)=>{o===r.typeName&&n.members?.has(r.id)&&n.members.delete(r.id)});t.forEach(r=>{this.sublayerCaches.get(r)?.forEach((n,o)=>{i.has(o)&&this.sublayerCaches.get(r)?.delete(o)})})}retrieveDataFromService(e,t,i){return _(this,null,function*(){let r=Q.getInstance(),n=new Set,o=[],s,p="",a=[],l=t.graphType==="relationship",h=this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData,T=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name),u=!h&&T?Array.from(T).sort():null;if(this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData)this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData&&e.objectIds!=null&&(u=e.objectIds);else if(e.objectIds!=null&&u&&u.length>0){let g=e.objectIds;e.objectIds=u.filter(y=>g.includes(y))}else if(e.objectIds!=null)u=e.objectIds;else{if(this.inclusionModeDefinition?.namedTypeDefinitions.has(t.objectType.name)&&(!this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members||this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members?.size<1))return e.objectIds=[],[];e.objectIds=u}if(e.outFields!=null){let g=e.outFields;g.includes("*")?t.fields.forEach(y=>{n.add(y.name)}):g.forEach(y=>{y!==v&&y!==t.geometryFieldName&&n.add(y)})}if(e.geometry!=null){let g=e.geometry,y,N=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,L=N?.spatialReference,C=N?.serviceCapabilities?.geometryCapabilities,w=C?.geometryMaxBoundingRectangleSizeX,S=C?.geometryMaxBoundingRectangleSizeY;if(g.type==="point"){let I=g;I.spatialReference?.isWGS84||(yield ne(I.spatialReference,j),I=K(I,j)),y=new Z({spatialReference:j,xmin:I.x-1e-4,ymin:I.y-1e-4,xmax:I.x+1e-4,ymax:I.y+1e-4})}else g?.extent?.spatialReference&&!g.spatialReference?.isWGS84?(yield ne(g.extent.spatialReference,j),y=K(g.extent,j)):y=g.extent;if(w&&S&&L){if(L.wkid!==4326){let I=new Z({spatialReference:L,xmax:w,ymax:S}),m=K(I,j);w=m.xmax,S=m.ymax}if(y.xmax-y.xmin>w)throw new q("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${w}\xB0 latitude, limit exceeded`);if(y.ymax-y.ymin>S)throw new q("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${S}\xB0 longitude, limit exceeded`)}if(e.where!=null&&e.where!=="1=1"){let I=yield _e(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach(m=>{I.fieldNames.includes(m.name)&&n.add(m.name)})}p=l?`Match ()-[n:${t.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${t.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n)`,t.geometryFieldName&&n.add(t.geometryFieldName),n.forEach(I=>{p+=`, n.${I}`,o.push(I)}),s=new U({openCypherQuery:p,bindParameters:{param_filter_geom:new ie({rings:qt(y)})}})}else{let g="";if(e.where!=null&&e.where!=="1=1"){let L=yield _e(e.where,t.fieldsIndex);t.fields.forEach(m=>{L.fieldNames.includes(m.name)&&n.add(m.name)});let C=new Set(["column-reference","string","number","binary-expression"]),w=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]),S=!1,I=m=>{if(m.type==="column-reference")return`n.${m.column}`;if(m.type==="string")return`'${m.value}'`;if(m.type==="number")return`${m.value}`;if(m.type==="binary-expression"&&C.has(m.left.type)&&C.has(m.right.type)&&w.has(m.operator))return`${I(m.left)} ${m.operator} ${I(m.right)}`;if(m.type==="binary-expression"&&m.operator==="LIKE"){let A="";if(m.left.type==="function"&&m.left.args.value[0].type==="column-reference")A+=`lower(n.${m.left.args.value[0].column})`;else{if(m.left.type!=="column-reference")return S=!0,"";A+=`lower(n.${m.left.column})`}if(A+=" CONTAINS (",m.right.type!=="string")return S=!0,"";{let M=m.right.value;M.charAt(0)==="%"&&(M=M.slice(1)),M.charAt(M.length-1)==="%"&&(M=M.slice(0,-1)),A+=`'${M.toLowerCase()}')`}return A}return S=!0,""};g=I(L.parseTree),S&&(g="")}let y="";y=l?`Match ()-[n:${t.objectType.name}]->()`:`Match (n:${t.objectType.name})`;let N=!1;u&&(N=!0,y+=" WHERE ID(n) IN $ids"),g&&(y+=N?" AND":" WHERE",y+=` ${g}`),y+=" return ID(n)",l&&(y+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&n.add(t.geometryFieldName),n.forEach(L=>{y+=`, n.${L}`,o.push(L)}),s=new U(u?{openCypherQuery:y,bindParameters:{ids:u}}:{openCypherQuery:y})}let b=(yield z(t.parentCompositeLayer.dataManager.knowledgeGraph,s,i)).resultRowsStream.getReader();for(;;){let{done:g,value:y}=yield b.read();if(g)break;let N=[];for(let L=0;L<y.length;L++){let C=y[L],w=0,S=0,I={properties:{}};for(I.id=C[w],w++,S++,l&&(I.originId=C[w],w++,S++,I.destinationId=C[w],w++,S++);w<C.length;w++)I.properties[o[w-S]]=C[w];N.push(I)}a=a.concat(r.writeToStore(N,v,t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name)?.name))}return a})}_isEndEntitySpatial(e,t,i){for(let r of e??[])if(this.entityTypeNames.has(r)){let n=this.geographicLookup.get(r),o=n&&this.sublayerCaches.get(r)?.get(t.attributes[i]);if(n&&o?.attributes[n.name])return!0}return!1}};d([c()],P.prototype,"knowledgeGraph",void 0),d([c()],P.prototype,"inclusionModeDefinition",void 0),d([c()],P.prototype,"entityTypeNames",void 0),d([c()],P.prototype,"relationshipTypeNames",void 0),d([c()],P.prototype,"geographicLookup",void 0),d([c()],P.prototype,"sublayerCaches",void 0),d([c()],P.prototype,"nodeConnectionsLookup",void 0),d([c()],P.prototype,"relationshipConnectionsLookup",void 0),d([c()],P.prototype,"memberIdTypeLookup",void 0),P=d([Y("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],P);var Gt=lt(),jt=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return d([c(Gt.fields)],t.prototype,"fields",void 0),d([c(Gt.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=d([Y("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],t),t};function x(e){if(!e.json)return e;e.json.write=Ut(e.json.write);let t=e.json.origins;if(!t)return e;let i;for(i in t){let r=t[i];r&&(r.write=Ut(r.write))}return e}function Ut(e){return typeof e=="object"&&e?(e.enabled!==!1&&(e.overridePolicy=er(e)),e):e===!0?de():e}function er(e){let o=e,{target:t,writer:i,overridePolicy:r}=o,n=Ae(o,["target","writer","overridePolicy"]);return function(s,p){let a=Bt.call(this,s,p);return a.enabled?J(J({},n),a):a}}function de(){return{overridePolicy:Bt}}function Bt(e,t){let i=!!this.geometryType,r={enabled:i};return i&&(r=J(J({},r),zt.call(this,e,t))),r}function zt(e,t){return{ignoreOrigin:this.originIdOf(t)>ke.DEFAULTS}}var f=class extends jt(rt(Xe(ze(ot(st(He($e(Ge(Et))))))))){constructor(e){super(e),this.blendMode="normal",this.capabilities=Ve(!1,!1),this.charts=null,this.definitionExpression=null,this.displayField="",this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.labelingInfo=null,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=v,this.objectType=null,this.opacity=1,this.orderBy=null,this.parent=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then(()=>{let t=new MessageChannel;return new ct(t.port1,{channel:t,client:{queryFeatures:(i,r={})=>{let n=B.fromJSON(i);return this.queryFeaturesJSON(n,r)}}}),[t.port2]})},this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){let t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){let e=[];return this.objectType?.properties?.forEach(t=>{let i=t.fieldType==="esriFieldTypeOID"?"esriFieldTypeInteger":t.fieldType;e.push(oe.fromJSON({name:t.name,type:i,alias:t.alias,defaultValue:t.defaultValue,editable:t.editable,nullable:t.nullable}))}),e.push(oe.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),oe.fromJSON({name:Me,type:"esriFieldTypeInteger",alias:Me,editable:!1}),oe.fromJSON({name:H,type:"esriFieldTypeInteger",alias:H,editable:!1})),e}get geometryType(){if(this.parentCompositeLayer?.type==="link-chart")return this.graphType==="relationship"?"polyline":"point";let e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.geometryType;return t&&t!=="esriGeometryNull"?$.fromJSON(t):null}get geometryFieldName(){return this.parentCompositeLayer?.type==="link-chart"?ye:this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name)?.name??null}get graphTypeName(){return this.objectType?.name}get hasM(){let e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name;return(t?this.objectType?.properties?.[t]:null)?.hasM??!1}get hasZ(){let e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name;return(t?this.objectType?.properties?.[t]:null)?.hasZ??!1}set renderer(e){yt(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){return this._isOverridden("renderer")?this._get("renderer"):this.parentCompositeLayer?.type==="link-chart"?this.graphType==="relationship"?ue(ce($.toJSON("polyline")).renderer):ue(ce($.toJSON("point")).renderer):ue(ce($.toJSON(this.geometryType)).renderer)}get spatialReference(){return this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel?.spatialReference??we.WGS84}set timeInfo(e){this._set("timeInfo",e)}get title(){return this._isOverridden("title")?this._get("title"):this.graphTypeName}set title(e){this._set("title",e)}writeTitle(e,t){t.title=e??"Layer"}createPopupTemplate(e){return dt(this,e)}createQuery(){return new B({where:"1=1",outFields:["*"]})}getField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];return null}getFieldDomain(e,t){return null}queryFeatures(e,t){return _(this,null,function*(){let{resolvedQuery:i,queryEngine:r}=yield this._setupQueryObjects(e),n=Ze.fromJSON(yield r.executeQuery(i.toJSON(),t?.signal));return n.features.forEach(o=>{o.sourceLayer=this}),n})}queryFeaturesJSON(e,t){return _(this,null,function*(){let{resolvedQuery:i,queryEngine:r}=yield this._setupQueryObjects(e);return yield r.executeQuery(i.toJSON(),t?.signal)})}queryFeatureCount(e,t){return _(this,null,function*(){let{resolvedQuery:i,queryEngine:r}=yield this._setupQueryObjects(e);return r.executeQueryForCount(i.toJSON(),t?.signal)})}queryExtent(){return _(this,arguments,function*(e={},t){let i=ve(J({},e),{returnGeometry:!0}),{resolvedQuery:r,queryEngine:n}=yield this._setupQueryObjects(i),o=yield n.executeQueryForExtent(r.toJSON(),t?.signal),s;return s=o.extent?.xmin!=null&&o.extent?.xmax!=null&&o.extent?.ymin!=null&&o.extent?.ymax!=null?new Z(o.extent):new Z,{count:o.count,extent:s}})}queryObjectIds(e,t){return _(this,null,function*(){let i=B.from(e),r;if(this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)r=this._cachedQueryEngine;else{let n=yield this.parentCompositeLayer.dataManager.getData(i,this,t);r=this.loadQueryEngine(n)}return r.executeQueryForIds(i.toJSON(),t?.signal)})}loadQueryEngine(e){let t=new Qe({geometryType:$.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),i=new We({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:$.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:this.timeInfo?.toJSON(),featureStore:t});return i.featureStore.addMany(e),i}refreshCachedQueryEngine(){return _(this,null,function*(){let e=yield this.parentCompositeLayer.dataManager.getData(new B({where:"1=1",outFields:[v]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)})}load(e){return this.addResolvingPromise(this.parent.load(e).then(()=>{mt(this.timeInfo,this.fieldsIndex)})),Promise.resolve(this)}_setupQueryObjects(e,t){return _(this,null,function*(){let i=B.from(e),r=i.geometry,n;if(r&&!r.spatialReference?.isWGS84&&(yield ne(r.spatialReference,j),i.geometry=K(r instanceof ie||r instanceof Ie||r instanceof Ee?r:r.extent,j)),this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)n=this._cachedQueryEngine;else{let o=yield this.parentCompositeLayer.dataManager.getData(i,this,t);n=this.loadQueryEngine(o)}return{resolvedQuery:i,queryEngine:n}})}};d([c(x(k(Ue)))],f.prototype,"blendMode",void 0),d([c()],f.prototype,"capabilities",void 0),d([c({json:{origins:{"web-scene":{write:!1}},write:de()}})],f.prototype,"charts",void 0),d([c({readOnly:!0})],f.prototype,"defaultPopupTemplate",null),d([c({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],f.prototype,"definitionExpression",void 0),d([c()],f.prototype,"displayField",void 0),d([c(x(k(Be)))],f.prototype,"effect",void 0),d([c()],f.prototype,"elevationInfo",void 0),d([c(x(k(Ke)))],f.prototype,"featureEffect",void 0),d([c(x(k(tt)))],f.prototype,"featureReduction",null),d([c()],f.prototype,"fields",null),d([c()],f.prototype,"geometryType",null),d([c()],f.prototype,"geometryFieldName",null),d([c({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],f.prototype,"graphType",void 0),d([c({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],f.prototype,"graphTypeName",null),d([c()],f.prototype,"hasM",null),d([c()],f.prototype,"hasZ",null),d([c({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],f.prototype,"id",void 0),d([c(x(k(ft)))],f.prototype,"labelsVisible",void 0),d([c({type:[et],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:pt,write:de()}})],f.prototype,"labelingInfo",void 0),d([c({readOnly:!0,json:{read:!1,write:{writer(e,t){switch(this.parentCompositeLayer.type){case"link-chart":t.layerType="LinkChartSubLayer";break;case"knowledge-graph":t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"}},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],f.prototype,"layerType",void 0),d([c(x(k(gt)))],f.prototype,"legendEnabled",void 0),d([c(x(k(wt)))],f.prototype,"maxScale",void 0),d([c(x(k(bt)))],f.prototype,"minScale",void 0),d([c()],f.prototype,"objectIdField",void 0),d([c()],f.prototype,"objectType",void 0),d([c(x(k(Tt)))],f.prototype,"opacity",void 0),d([c(x(k(it)))],f.prototype,"orderBy",void 0),d([c({clonable:!1})],f.prototype,"parent",void 0),d([c()],f.prototype,"parentCompositeLayer",void 0),d([c(x(k(ht)))],f.prototype,"popupEnabled",void 0),d([c({type:Je,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],f.prototype,"popupTemplate",void 0),d([c({type:Number,json:{write:{overridePolicy:zt}}})],f.prototype,"refreshInterval",void 0),d([c({types:Ye,json:{name:"layerDefinition.drawingInfo.renderer",write:de()}})],f.prototype,"renderer",null),d([c()],f.prototype,"source",void 0),d([c()],f.prototype,"spatialReference",null),d([c({type:nt,json:{name:"layerDefinition.timeInfo",write:!0,origins:{"web-document":{name:"layerDefinition.timeInfo",read:!0,write:!0},"portal-item":{name:"layerDefinition.timeInfo",read:!0,write:!0}}}})],f.prototype,"timeInfo",null),d([c({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],f.prototype,"title",null),d([qe("title")],f.prototype,"writeTitle",null),d([c({json:{read:!1}})],f.prototype,"type",void 0),d([c(x(k(at)))],f.prototype,"useViewTime",void 0),d([c({type:Boolean,json:{name:"visibility",write:de()}})],f.prototype,"visible",void 0),f=d([Y("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],f);var Ho=f;export{v as a,ae as b,se as c,ye as d,Me as e,rr as f,Q as g,ur as h,_t as i,Nt as j,St as k,Ft as l,Dt as m,Rt as n,vt as o,At as p,kt as q,ai as r,si as s,li as t,P as u,Ho as v};
