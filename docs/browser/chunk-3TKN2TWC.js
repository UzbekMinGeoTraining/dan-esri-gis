import{b as z}from"./chunk-QGKQ2OTS.js";import{a as Z}from"./chunk-7DG45AVS.js";import{a as j}from"./chunk-JBGML6IF.js";import{a as o}from"./chunk-S2HMCZNZ.js";import{b as R,c as N,d as w,f as x,g as L,h as q}from"./chunk-ONDKJR4V.js";import{c as F,g as V,h as W}from"./chunk-QB4KDO4M.js";import{a as k}from"./chunk-NNNTRPDR.js";import{b as i}from"./chunk-J7UK2QPE.js";import{a as D,b as M}from"./chunk-N6PITG7Q.js";import{a as H}from"./chunk-GKUBZAEG.js";import{a as B,d as U}from"./chunk-UW734WOQ.js";import{j as I,l as b,m as E}from"./chunk-ATV5GTE5.js";import{h as g}from"./chunk-PQPFAB53.js";import{a as O}from"./chunk-G5SIQY64.js";import{a as y}from"./chunk-RDGFIF46.js";import{a as l,f as S,i as u,m as d}from"./chunk-NPIYHDQ7.js";import{a as C}from"./chunk-YJ3RZNO6.js";import{a as p}from"./chunk-4OZVVJHM.js";import{b as v}from"./chunk-J6ZRC6RI.js";import{a as n}from"./chunk-7W6RATG7.js";import{x as A}from"./chunk-BDF7KEUQ.js";import{f}from"./chunk-YRTBL7EE.js";import{a as s}from"./chunk-BMVJCP2M.js";var c=class extends M{constructor(t,e,a){super(t,e,new D(z,()=>import("./chunk-WR324BGU.js")),a)}_createPipeline(t,e){let{oitPass:a,output:m,transparent:Q,cullFace:J,draped:Y,hasOccludees:P,polygonOffset:K,enableOffset:X}=t,$=a===O.NONE,tt=a===O.FrontFace;return E({blending:m===l.Color&&Q?R(a):null,culling:I(J),depthTest:Y?null:{func:L(a)},depthWrite:N(t),drawBuffers:m===l.Depth?{buffers:[A.NONE]}:q(a,m),colorWrite:b,stencilWrite:P?F:null,stencilTest:P?e?W:V:null,polygonOffset:$||tt?K?et:null:x(X)})}initializePipeline(t){return this._occludeePipelineState=this._createPipeline(t,!0),this._createPipeline(t,!1)}getPipeline(t){return t?this._occludeePipelineState:super.getPipeline()}},et={factor:1,units:1};var r=class extends k{constructor(){super(...arguments),this.cullFace=p.None,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.transparent=!1,this.discardInvisibleFragments=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.objectAndLayerIdColorInstanced=!1,this.vvColor=!1,this.draped=!1,this.textureCoordinateType=B.None,this.emissionSource=H.None,this.occlusionPass=!1,this.hasVvInstancing=!0,this.vvSize=!1,this.vvOpacity=!1}};s([i({count:p.COUNT})],r.prototype,"cullFace",void 0),s([i()],r.prototype,"hasSlicePlane",void 0),s([i()],r.prototype,"hasVertexColors",void 0),s([i()],r.prototype,"transparent",void 0),s([i()],r.prototype,"discardInvisibleFragments",void 0),s([i()],r.prototype,"polygonOffset",void 0),s([i()],r.prototype,"enableOffset",void 0),s([i()],r.prototype,"writeDepth",void 0),s([i()],r.prototype,"hasOccludees",void 0),s([i()],r.prototype,"terrainDepthTest",void 0),s([i()],r.prototype,"cullAboveTerrain",void 0),s([i()],r.prototype,"objectAndLayerIdColorInstanced",void 0),s([i()],r.prototype,"vvColor",void 0),s([i()],r.prototype,"draped",void 0);var G=class extends Z{constructor(t){super(t,_),this._configuration=new r,this.supportsEdges=!0,this.produces=new Map([[o.OPAQUE_MATERIAL,e=>this._isOpaqueMaterialPass(e)],[o.OPAQUE_MATERIAL_WITHOUT_NORMALS,e=>this._isOpaqueNoSSAODepthPass(e)],[o.TRANSPARENT_MATERIAL,e=>u(e)&&this._transparent&&this.parameters.writeDepth],[o.TRANSPARENT_MATERIAL_WITHOUT_NORMALS,e=>d(e)&&this._transparent&&this.parameters.writeDepth],[o.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>u(e)&&this._transparent&&!this.parameters.writeDepth],[o.DRAPED_MATERIAL,e=>S(e)]])}getConfiguration(t,e){return this._configuration.output=t,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors&&!this.parameters.vvColor,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this._transparent,this._configuration.discardInvisibleFragments=this._transparent&&!this._isOpaquePass(t)&&this.parameters.discardInvisibleFragments,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=e.hasOccludees,this._configuration.oitPass=e.oitPass,this._configuration.enableOffset=e.camera.relativeElevation<w,this._configuration.terrainDepthTest=e.terrainDepthTest,this._configuration.cullAboveTerrain=e.cullAboveTerrain,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.draped=this.parameters.draped,this._configuration}get visible(){return this.parameters.color[3]>=C}get _transparent(){return this.parameters.color[3]<1||this.parameters.forceTransparentMode}_isOpaquePass(t){return this._isOpaqueMaterialPass(t)||this._isOpaqueNoSSAODepthPass(t)}_isOpaqueMaterialPass(t){return t===l.Highlight||u(t)&&!this._transparent}_isOpaqueNoSSAODepthPass(t){return d(t)&&this.parameters.writeDepth&&!this._transparent}createGLMaterial(t){return new T(t)}createBufferWriter(){let t=v().vec3f(n.POSITION);return y()&&t.vec4u8(n.OBJECTANDLAYERIDCOLOR),this.parameters.vvColor?t.f32(n.COLORFEATUREATTRIBUTE):t.vec4u8(n.COLOR),new j(t)}},T=class extends U{beginSlot(t){return this.acquireTechnique(c,t)}},_=class extends g{constructor(){super(...arguments),this.color=f,this.forceTransparentMode=!1,this.writeDepth=!0,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=p.None,this.draped=!1,this.discardInvisibleFragments=!1}};export{G as a};
