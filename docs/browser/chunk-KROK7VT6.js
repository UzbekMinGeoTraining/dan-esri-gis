import{i as C}from"./chunk-NZ7WSL6F.js";import{a as w,b as I}from"./chunk-R7Q3STHM.js";import{a as h}from"./chunk-2R4SNL6O.js";import{B as b}from"./chunk-7D4IYTAJ.js";import{b as g}from"./chunk-S4PLWG55.js";import{g as m}from"./chunk-JEGVIFEP.js";var N=/^-?(\d+)(\.(\d+))?$/i;function M(e,t){return e-t}function v(e,t){let n,i;return n=Number(e.toFixed(t)),n<e?i=n+1/10**t:(i=n,n-=1/10**t),n=Number(n.toFixed(t)),i=Number(i.toFixed(t)),[n,i]}function R(e,t,n,i,r){let o=T(e,t,n,i),a=o.previous==null||o.previous<=r,l=o.next==null||o.next<=r;return a&&l||o.previous+o.next<=2*r}function V(e){let t=String(e),n=t.match(N);if(n?.[1])return{integer:n[1].split("").length,fractional:n[3]?n[3].split("").length:0};if(t.toLowerCase().includes("e")){let i=t.split("e"),r=i[0],o=i[1];if(r&&o){let a=Number(r),l=Number(o),s=l>0;s||(l=Math.abs(l));let A=V(a);return s?(A.integer+=l,l>A.fractional?A.fractional=0:A.fractional-=l):(A.fractional+=l,l>A.integer?A.integer=1:A.integer-=l),A}}return{integer:0,fractional:0}}function T(e,t,n,i){let r={previous:null,next:null};if(n!=null){let o=e-n,a=t-n-o;r.previous=Math.floor(Math.abs(100*a/o))}if(i!=null){let o=i-e,a=i-t-o;r.next=Math.floor(Math.abs(100*a/o))}return r}function S(e,t={}){let n=e.slice(),{tolerance:i=2,strictBounds:r=!1,indexes:o=n.map((a,l)=>l)}=t;o.sort(M);for(let a=0;a<o.length;a++){let l=o[a],s=n[l],A=l===0?null:n[l-1],F=l===n.length-1?null:n[l+1],p=V(s).fractional;if(p){let u,f=0,c=!1;for(;f<=p&&!c;){let d=v(s,f);u=r&&a===0?d[1]:d[0],c=R(s,u,A,F,i),f++}c&&(n[l]=u)}}return n}var y={maximumFractionDigits:20};function U(e){return g(e,y)}var B="<",E=">";function H(e,t,n,i){let r="";return t===0?r=`${B} `:t===n&&(r=`${E} `),r+(i?I(e,i):U(e))}var Z=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];function x(e){return m(this,null,function*(){if(!("visualVariables"in e)||!e.visualVariables)return null;let t=e.visualVariables.find(a=>a.type==="color");if(!t)return null;let n=null,i=null;if(t.stops){if(t.stops.length===1)return t.stops[0].color;n=t.stops[0].value,i=t.stops[t.stops.length-1].value}let r=n!=null&&i!=null?n+(i-n)/2:0,{getColor:o}=yield import("./chunk-7PBEMZJ7.js");return o(t,r)??null})}function X(e,t){return m(this,null,function*(){let n=e.trailCap,i=e.trailWidth||1,r=t||(yield x(e))||e.color;return new C({cap:n,color:r,width:i})})}function Q(e,t){if(!t.field)return null;if("featureReduction"in e)switch(e.featureReduction?.type){case"cluster":case"binning":{let n=e.featureReduction.fields.find(({name:i})=>i.toLowerCase()===t.field.toLowerCase());return n&&"getField"in e?e.getField(n.onStatisticField):null}}return"getField"in e?e.getField?.(t.field):null}function q(e,t){let n="popupTemplate"in e?e.popupTemplate?.fieldInfos:null;if(n?.length&&t)return n.find(i=>i.fieldName?.toLowerCase()===t.toLowerCase())?.format?.dateFormat}function Y(e,t,n){let i=Q(e,t);if(!i||!w(i)&&!b(i))return null;let r=q(e,i.name);if(!r&&i.type==="date"){let o=0,a=0;t.stops?(o=t.stops?.at(0)?.value??o,a=t.stops?.at(-1)?.value??a):"minDataValue"in t&&"maxDataValue"in t&&(o=t.minDataValue??o,a=t.maxDataValue??a),r=a-o>2*h.days?"short-date":"short-date-short-time"}return{fieldType:i.type,format:r,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in e?e.preferredTimeZone:null,viewTimeZone:n,datesInUnknownTimezone:"datesInUnknownTimezone"in e&&e.datesInUnknownTimezone}}}function P(e){if("authoringInfo"in e)return e.authoringInfo?.visualVariables?.find(({theme:t})=>t==="reference-size")}export{V as a,T as b,S as c,B as d,E as e,H as f,Z as g,x as h,X as i,Y as j,P as k};
