import{a as N}from"./chunk-RNEZKVER.js";import{b as F,d as A}from"./chunk-OC7V2CEX.js";import{e as x}from"./chunk-VTCODMOL.js";import{a as _}from"./chunk-THY6AAMN.js";import{h as u,p as f}from"./chunk-BDF7KEUQ.js";import{n as U,r as w,t as d}from"./chunk-3IBUFXWY.js";import{a as g,b as M}from"./chunk-JEGVIFEP.js";var p=class e{constructor(t,r,n,i,s,a,o){this.instanceId=t,this.textureKey=r,this.indexStart=n,this.indexCount=i,this.vertexStart=s,this.vertexCount=a,this.overlaps=o}updateBaseOffsets(t){this.vertexStart+=t.vertexFrom,this.indexStart+=t.indexFrom}clone(){return new e(this.instanceId,this.textureKey,this.indexStart,this.indexCount,this.vertexStart,this.vertexCount,this.overlaps)}static write(t,r,n,i,s,a,o,c){t.push(r),t.push(n),t.push(i),t.push(s),t.push(a),t.push(o),t.push(c)}serialize(t){return t.push(this.instanceId),t.push(this.textureKey),t.push(this.indexStart),t.push(this.indexCount),t.push(this.vertexStart),t.push(this.vertexCount),t.push(this.overlaps),t}static deserialize(t){let r=t.readInt32(),n=t.readInt32(),i=t.readInt32(),s=t.readInt32(),a=t.readInt32(),o=t.readInt32(),c=t.readInt32();return new e(r,n,i,s,a,o,c)}};p.byteSizeHint=7*Uint32Array.BYTES_PER_ELEMENT;function h(e,t){if(t!==null){e.push(t.length);for(let r of t)r.serialize(e);return e}e.push(0)}function E(e,t,r){let n=e.readInt32(),i=new Array(n);for(let s=0;s<i.length;s++)i[s]=t.deserialize(e,r);return i}var y=class e{constructor(t,r){this.id=t,this.sortKey=r,this.records=[]}serialize(t){return t.push(this.id),t.writeF32(this.sortKey),h(t,this.records),t}static deserialize(t){let r=t.readInt32(),n=t.readF32(),i=new e(r,n);return i.records=E(t,p)??[],i}};y.byteSizeHint=2*Uint32Array.BYTES_PER_ELEMENT+p.byteSizeHint;var b=new Float32Array(1),v=new Uint32Array(b.buffer);function k(e){return b[0]=e,v[0]}function K(e,t){return 65535&e|t<<16}function T(e){let t=k(e),r=t>>>31,n=t>>>23&255,i=8388607&t;return n-=127,n>15?r<<15|31744:n<-25?0:(n<-14&&(i+=8388608,i/=2**(-14-n),n=-15),n+=15,i/=8192,i=C(i,1023),r<<15|n<<10|i)}function C(e,t){let r=Math.floor(e),n=e-r;return r<t&&(n>.5||n===.5&&r%2==1)?r+1:r}function I(e){let t=e>>>15,r=e>>10&31,n=1023&e;return t=t?-1:1,r-=15,n/=1024,r>-15?n+=1:r=-14,t*2**r*n}function Q(e){let t=e.map(({name:r,count:n,type:i})=>`${r}.${n}.${i}`).join(",");return U(t)}function l(e,t,r,n,i,s,a){if(e.primitiveName===t){let o=n?.readWithDefault(i,s,e[r]&&a);return e.type==="text"&&(o=o.toString()),void(e[r]=o)}if("type"in e&&e.type!=null){if(e.effects)for(let o of e.effects)l(o,t,r,n,i,s,a);switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.symbolLayers)for(let o of e.symbolLayers)l(o,t,r,n,i,s,a);break;case"CIMTextSymbol":e.symbol&&l(e.symbol,t,r,n,i,s,a);break;case"CIMHatchFill":e.lineSymbol&&l(e.lineSymbol,t,r,n,i,s,a);break;case"CIMPictureMarker":case"CIMCharacterMarker":case"CIMVectorMarker":if(e.markerPlacement&&l(e.markerPlacement,t,r,n,i,s,a),e.type==="CIMVectorMarker"&&e.markerGraphics)for(let o of e.markerGraphics)l(o,t,r,n,i,s,a),l(o.symbol,t,r,n,i,s,a)}}}var D=400;function W(e){let t=e.width;return e.effects!=null?D:Math.max(1.25*t,8)}var L=()=>w.getLogger("esri.views.2d.engine.webgl.Utils");function mt(e){switch(e){case f.UNSIGNED_BYTE:return 1;case f.UNSIGNED_SHORT_4_4_4_4:return 2;case f.FLOAT:return 4;default:return void L().error(new d("webgl-utils",`Unable to handle type ${e}`))}}function dt(e){switch(e){case f.UNSIGNED_BYTE:return Uint8Array;case f.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case f.FLOAT:return Float32Array;default:return void L().error(new d("webgl-utils",`Unable to handle type ${e}`))}}function z(e){let t=new Map;for(let r in e){let n=e[r],i=0;t.set(r,n.map(s=>{let a=new _(s.name,s.count,s.type,i,0,s.normalized||!1);return i+=s.count*x(s.type),a})),t.get(r).forEach(s=>s.stride=i)}return t}var O=e=>{let t=new Map;for(let r in e)for(let n of e[r])t.set(n.name,n.location);return t},H=e=>{let t={};return e.forEach((r,n)=>t[n]=r?.length?r[0].stride:0),t},S=new Map,yt=(e,t)=>{if(!S.has(e)){let r=z(t),n={strides:H(r),bufferLayouts:r,attributes:O(t)};S.set(e,n)}return S.get(e)},Tt=e=>e.includes("data:image/svg+xml");function It(e){let t=[];for(let r=0;r<e.length;r++)t.push(e.charCodeAt(r));return t}function St(e,t,r){let n=new F(t.width,t.height);return n.dataType=t.dataType,t.depth&&(n.depth=t.depth),t.flipped&&(n.flipped=t.flipped),t.hasMipmap&&(n.hasMipmap=t.hasMipmap),n.internalFormat=t.internalFormat,t.isImmutable&&(n.isImmutable=t.isImmutable),t.isOpaque&&(n.isOpaque=t.isOpaque),t.maxAnisotropy&&(n.maxAnisotropy=t.maxAnisotropy),n.pixelFormat=t.pixelFormat,t.preMultiplyAlpha&&(n.preMultiplyAlpha=t.preMultiplyAlpha),t.samplingMode&&(n.samplingMode=t.samplingMode),t.target&&(n.target=t.target),n.uniform=t.uniform,t.unpackAlignment&&(n.unpackAlignment=t.unpackAlignment),t.wrapMode&&(n.wrapMode=t.wrapMode),new A(e,n,r)}function gt(e){return"url"in e&&"urlHash"in e?M(g({},e),{url:""}):e}var B=class e{constructor(t,r,n,i,s,a,o,c,m=[]){this.entityTexel=t,this.anchorX=r,this.anchorY=n,this.directionX=i,this.directionY=s,this.maxScale=a,this.minScale=o,this.referenceBounds=c,this.bounds=m}serialize(t){t.push(this.entityTexel),t.writeF32(this.anchorX),t.writeF32(this.anchorY),t.writeF32(this.directionX),t.writeF32(this.directionY),t.writeF32(this.maxScale),t.writeF32(this.minScale),this.referenceBounds===null?(t.writeF32(0),t.writeF32(0),t.writeF32(0)):(t.writeF32(this.referenceBounds.size),t.writeF32(this.referenceBounds.offsetX),t.writeF32(this.referenceBounds.offsetY)),h(t,this.bounds)}static deserialize(t){let r=t.readInt32(),n=t.readF32(),i=t.readF32(),s=t.readF32(),a=t.readF32(),o=t.readF32(),c=t.readF32(),m=t.readF32(),R=t.readF32(),Y=t.readF32(),P=E(t,N)??[];return new e(r,n,i,s,a,o,c,{size:m,offsetX:R,offsetY:Y},P)}};function Nt(e,t,r,n){let i=r.packPrecisionFactor??1;switch(r.type){case u.BYTE:if(r.count===1)e.setInt8(n+r.offset,t*i);else for(let s=0;s<r.count;s++){let a=s*Int8Array.BYTES_PER_ELEMENT;e.setInt8(n+r.offset+a,t[s]*i)}break;case u.UNSIGNED_BYTE:if(r.count===1)e.setUint8(n+r.offset,t*i);else for(let s=0;s<r.count;s++){let a=s*Uint8Array.BYTES_PER_ELEMENT;e.setUint8(n+r.offset+a,t[s]*i)}break;case u.SHORT:if(r.count===1)e.setInt16(n+r.offset,t*i,!0);else for(let s=0;s<r.count;s++){let a=s*Int16Array.BYTES_PER_ELEMENT;e.setInt16(n+r.offset+a,t[s]*i,!0)}break;case u.UNSIGNED_SHORT:if(r.count===1)e.setUint16(n+r.offset,t*i,!0);else for(let s=0;s<r.count;s++){let a=s*Uint16Array.BYTES_PER_ELEMENT;e.setUint16(n+r.offset+a,t[s]*i,!0)}break;case u.INT:if(r.count===1)e.setInt32(n+r.offset,t*i,!0);else for(let s=0;s<r.count;s++){let a=s*Int32Array.BYTES_PER_ELEMENT;e.setInt32(n+r.offset+a,t[s]*i,!0)}break;case u.UNSIGNED_INT:if(r.count===1)e.setUint32(n+r.offset,t*i,!0);else for(let s=0;s<r.count;s++){let a=s*Uint32Array.BYTES_PER_ELEMENT;e.setUint32(n+r.offset+a,t[s]*i,!0)}break;case u.FLOAT:if(r.count===1)e.setFloat32(n+r.offset,t*i,!0);else for(let s=0;s<r.count;s++){let a=s*Float32Array.BYTES_PER_ELEMENT;e.setFloat32(n+r.offset+a,t[s]*i,!0)}break;case u.HALF_FLOAT:if(r.count===1)e.setUint16(n+r.offset,T(t*i),!0);else for(let s=0;s<r.count;s++){let a=s*Uint16Array.BYTES_PER_ELEMENT;e.setUint16(n+r.offset+a,T(t[s]*i),!0)}}}function bt(e,t,r){switch(t.type){case u.BYTE:{if(t.count===1)return e.getInt8(r+t.offset);let n=[];for(let i=0;i<t.count;i++){let s=i*Int8Array.BYTES_PER_ELEMENT;n.push(e.getInt8(r+t.offset+s))}return n}case u.UNSIGNED_BYTE:{if(t.count===1)return e.getUint8(r+t.offset);let n=[];for(let i=0;i<t.count;i++){let s=i*Uint8Array.BYTES_PER_ELEMENT;n.push(e.getUint8(r+t.offset+s))}return n}case u.SHORT:{if(t.count===1)return e.getInt16(r+t.offset,!0);let n=[];for(let i=0;i<t.count;i++){let s=i*Int16Array.BYTES_PER_ELEMENT;n.push(e.getInt16(r+t.offset+s,!0))}return n}case u.UNSIGNED_SHORT:{if(t.count===1)return e.getUint16(r+t.offset,!0);let n=[];for(let i=0;i<t.count;i++){let s=i*Uint16Array.BYTES_PER_ELEMENT;n.push(e.getUint16(r+t.offset+s,!0))}return n}case u.INT:{if(t.count===1)return e.getInt32(r+t.offset,!0);let n=[];for(let i=0;i<t.count;i++){let s=i*Int32Array.BYTES_PER_ELEMENT;n.push(e.getInt32(r+t.offset+s,!0))}return n}case u.UNSIGNED_INT:{if(t.count===1)return e.getUint32(r+t.offset,!0);let n=[];for(let i=0;i<t.count;i++){let s=i*Uint32Array.BYTES_PER_ELEMENT;n.push(e.getUint32(r+t.offset+s,!0))}return n}case u.FLOAT:{if(t.count===1)return e.getFloat32(r+t.offset,!0);let n=[];for(let i=0;i<t.count;i++){let s=i*Float32Array.BYTES_PER_ELEMENT;n.push(e.getFloat32(r+t.offset+s,!0))}return n}case u.HALF_FLOAT:{if(t.count===1)return I(e.getUint16(r+t.offset,!0));let n=[];for(let i=0;i<t.count;i++){let s=i*Uint16Array.BYTES_PER_ELEMENT;n.push(I(e.getUint16(r+t.offset+s,!0)))}return n}}}export{p as a,E as b,y as c,mt as d,dt as e,yt as f,Tt as g,It as h,St as i,gt as j,K as k,Q as l,l as m,W as n,Nt as o,bt as p,B as q};
