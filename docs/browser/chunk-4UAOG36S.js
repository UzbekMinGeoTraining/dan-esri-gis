import{a as u}from"./chunk-SDRDL3LF.js";import{D as l,H as d,L as m,Q as S,b as F,c as h,sa as w,w as s,y as p}from"./chunk-4RJTDUBN.js";import"./chunk-MTRBRBPC.js";import"./chunk-A7GYEEN6.js";import"./chunk-WUZAEWWX.js";import{c as y,e as A}from"./chunk-KAOR3JAH.js";import{a as g}from"./chunk-ACVF7Z7X.js";import"./chunk-ZGDQY5ZD.js";import"./chunk-QH2MD2O2.js";import"./chunk-6EZNY6L4.js";import"./chunk-7XLHE26H.js";import"./chunk-EN6CTWVM.js";import"./chunk-LVPMJTA6.js";import"./chunk-NNETCWLJ.js";import"./chunk-K72LO6P2.js";import"./chunk-2R4SNL6O.js";import"./chunk-OFZ6SV37.js";import"./chunk-YSOJWUIW.js";import"./chunk-Q5WFUDPQ.js";import"./chunk-DPZGANVI.js";import"./chunk-T7BKG6V3.js";import"./chunk-R6VC74T7.js";import"./chunk-6WKJD7BM.js";import"./chunk-3CR7P5WT.js";import"./chunk-GYH7NDHH.js";import"./chunk-S3UQHW42.js";import"./chunk-5PTS4JDF.js";import"./chunk-MUI46NAG.js";import"./chunk-N27U3N2T.js";import"./chunk-4R5NBZMW.js";import"./chunk-NDYVXEZ5.js";import"./chunk-CMMPCPP5.js";import"./chunk-4DLSYLKE.js";import"./chunk-VPXBKZQM.js";import"./chunk-ZTKK3KB7.js";import"./chunk-GZXWFBZI.js";import"./chunk-B7IARA3F.js";import"./chunk-IZVEJCCI.js";import"./chunk-TEY6TKJV.js";import"./chunk-4M6XQSBA.js";import"./chunk-2JF6YUJG.js";import"./chunk-GGZQ5GCM.js";import"./chunk-TFUPB3ZG.js";import"./chunk-ANPNMGFG.js";import"./chunk-BMVJCP2M.js";import"./chunk-GMC3I5VG.js";import"./chunk-WGF2T2BG.js";import"./chunk-YZP43POT.js";import"./chunk-VEDIBGHD.js";import"./chunk-3IBUFXWY.js";import"./chunk-BP73DJTS.js";import{g as f}from"./chunk-JEGVIFEP.js";function c(a,n,t,e){return f(this,null,function*(){if(t.length===1){if(l(t[0]))return u(a,t[0],s(t[1],-1));if(m(t[0]))return u(a,t[0].toArray(),s(t[1],-1))}else if(t.length===2){if(l(t[0]))return u(a,t[0],s(t[1],-1));if(m(t[0]))return u(a,t[0].toArray(),s(t[1],-1));if(d(t[0])){let i=yield t[0].load(),r=yield v(A.create(t[1],{fieldsIndex:i.getFieldsIndex(),timeZone:i.dateFieldsTimeZoneDefaultUTC}),e,n);return x(n,yield t[0].calculateStatistic(a,r,s(t[2],1e3),n.abortSignal))}}else if(t.length===3&&d(t[0])){let i=yield t[0].load(),r=yield v(A.create(t[1],{fieldsIndex:i.getFieldsIndex(),timeZone:i.dateFieldsTimeZoneDefaultUTC}),e,n);return x(n,yield t[0].calculateStatistic(a,r,s(t[2],1e3),n.abortSignal))}return u(a,t,-1)})}function x(a,n){return n instanceof y?g.fromReaderAsTimeStampOffset(n.toStorageFormat()):n instanceof Date?g.dateJSAndZoneToArcadeDate(n,w(a)):n}function v(a,n,t){return f(this,null,function*(){let e=a.getVariables();if(e.length>0){let i=[];for(let o=0;o<e.length;o++){let T={name:e[o]};i.push(yield n.evaluateIdentifier(t,T))}let r={};for(let o=0;o<e.length;o++)r[e[o]]=i[o];return a.parameters=r,a}return a})}function q(a){a.mode==="async"&&(a.functions.stdev=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("stdev",n,r,a))},a.functions.variance=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("variance",n,r,a))},a.functions.average=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("mean",n,r,a))},a.functions.mean=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("mean",n,r,a))},a.functions.sum=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("sum",n,r,a))},a.functions.min=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("min",n,r,a))},a.functions.max=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("max",n,r,a))},a.functions.count=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>f(this,null,function*(){if(S(r,1,1,n,t),d(r[0]))return r[0].count(e.abortSignal);if(l(r[0])||p(r[0]))return r[0].length;if(m(r[0]))return r[0].length();throw new h(n,F.InvalidParameter,t)}))})}export{q as registerFunctions};
