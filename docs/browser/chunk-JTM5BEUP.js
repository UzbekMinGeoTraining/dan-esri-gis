import{a as ce,b as le,c as pe,d as F}from"./chunk-AKDLIRLE.js";import{a as P}from"./chunk-L62KOIOF.js";import{a as te,b as re,c as oe,d as N,e as se}from"./chunk-5TKTI2G2.js";import{a as Z}from"./chunk-VDNXTMSC.js";import{a as S,b as X,i as Y}from"./chunk-MBJHSEMD.js";import{b as J}from"./chunk-DZAY272R.js";import{a as G}from"./chunk-VWF5VUO3.js";import{a as Q}from"./chunk-TBYT66N3.js";import{c as q}from"./chunk-ZTKK3KB7.js";import{a as ee}from"./chunk-GZXWFBZI.js";import{b as K}from"./chunk-IZVEJCCI.js";import{t as W}from"./chunk-4M6XQSBA.js";import{L as U,Q as m,a as B}from"./chunk-GGZQ5GCM.js";import{U as V,o as M}from"./chunk-TFUPB3ZG.js";import{a as h}from"./chunk-BMVJCP2M.js";import{D as z,h as D,i as $,p as A}from"./chunk-GMC3I5VG.js";import{b as L}from"./chunk-WGF2T2BG.js";import{b as x,r as R}from"./chunk-3IBUFXWY.js";import{b as ae}from"./chunk-LOX6V3YR.js";import{a as de}from"./chunk-FGVQZMJ3.js";import{a as ne,b as ie}from"./chunk-PXV7KILP.js";import{d as j,e as k}from"./chunk-C73532AX.js";import{a as v,g as C}from"./chunk-JEGVIFEP.js";function he(){let{classList:e}=document.body,t=window.matchMedia("(prefers-color-scheme: dark)").matches,r=()=>e.contains(ie)||e.contains(ne)&&t?"dark":"light",o=a=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:a}})),c=a=>{i!==a&&o(a),i=a},i=r();o(i),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a=>c(a.matches?"dark":"light")),new MutationObserver(()=>c(r())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}function Ne(){de()&&(document.readyState==="interactive"?he():document.addEventListener("DOMContentLoaded",()=>he(),{once:!0})),ae()}var Ie=Ne;Ie();var me;function ue(){try{j(".")}catch{k(W(K(me)))}}function Ke(e){let t=[];for(let r of Object.keys(e))customElements.get(`calcite-${r}`)||t.push(e[r]?.());return t.length>0?Promise.all(t):null}me="components/assets";function fe(e){return typeof e=="string"?document.getElementById(e):e??null}function Xe(e,t){for(;;){let r=e.firstChild;if(!r)break;t.appendChild(r)}}var ge={handleInterceptedEvent:(e,t,r,o)=>(e.scheduleRender(),t.properties[`on${o.type}`].apply(t.properties.bind||r,[o]))};var Le={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,r)=>{t.charAt(0)==="-"?e.style.setProperty(t,r):e.style[t]=r}},ve=e=>v(v({},Le),e);var Ae=(e,t)=>{let r=[];for(;e&&e!==t;)r.push(e),e=e.parentNode;return r},Se=(e,t)=>e.find(t),ye=(e,t,r=!1)=>{let o=e;return t.forEach((c,i)=>{let a=o?.children?Se(o.children,n=>n.domNode===c):void 0;r&&!a&&i!==t.length-1||(o=a)}),o},_e=e=>{let t,r=v(v({},ge),e),o=ve(r),c=o.performanceLogger,i,a=!0,n=!1,s=[],u=[],f=(p,d,w)=>{let y;o.eventHandlerInterceptor=(Te,Oe,He,xe)=>function(_){let E;c("domEvent",_);let I=Ae(_.currentTarget,y.domNode),Ce=I.some(b=>customElements.get(b?.tagName?.toLowerCase()));if(_.eventPhase===Event.CAPTURING_PHASE||!Ce)I.reverse(),E=ye(y.getLastRender(),I);else{let b=_.composedPath(),Re=b.slice(b.indexOf(_.currentTarget),b.indexOf(y.domNode)).reverse();E=ye(y.getLastRender(),Re,!0)}let H;return E&&(H=r.handleInterceptedEvent(t,E,this,_)),c("domEventProcessed",_),H},r.postProcessProjectionOptions?.(o);let O=w();y=p(d,O,o),o.eventHandlerInterceptor=void 0,s.push(y),u.push(w),r.afterFirstVNodeRendered&&r.afterFirstVNodeRendered(y,O)},g=()=>{if(i=void 0,a){a=!1,c("renderStart",void 0);for(let p=0;p<s.length;p++){let d=u[p]();c("rendered",void 0);try{s[p].update(d)}catch(w){console.error(w)}c("patched",void 0)}c("renderDone",void 0),a=!0}};return r.modifyDoRenderImplementation&&(g=r.modifyDoRenderImplementation(g,s,u)),t={renderNow:g,scheduleRender:()=>{i||n||(i=requestAnimationFrame(g))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),n=!0},resume:()=>{n=!1,a=!0,t.scheduleRender()},append:(p,d)=>{f(P.append,p,d)},insertBefore:(p,d)=>{f(P.insertBefore,p,d)},merge:(p,d)=>{f(P.merge,p,d)},replace:(p,d)=>{f(P.replace,p,d)},detach:p=>{for(let d=0;d<u.length;d++)if(u[d]===p)return u.splice(d,1),s.splice(d,1)[0];throw new Error("renderFunction was not found")}},t};var be=new Set;function Pe(e){be.add(e),e.finally(()=>be.delete(e))}var we,je="esri.widgets.Widget",ke=0;function Ee(e,t){let r=Object.prototype.hasOwnProperty;for(let o in t)r.call(t,o)&&r.call(e,o)&&(e[o]!=null&&t[o]!=null&&typeof e[o]=="object"&&typeof t[o]=="object"?Ee(e[o],t[o]):e[o]=t[o]);return e}var Fe=_e({postProcessProjectionOptions(e){let t=e.eventHandlerInterceptor,r=/capture$/i;e.eventHandlerInterceptor=(o,c,i,a)=>{let n=t?.(o,c,i,a),s=r.test(o);if(!((o=o.replace(r,"")).toLowerCase()in i)||s){let u=o[2].toLowerCase()+o.slice(3),f=d=>n?.call(i,d);i.addEventListener(u,f,s);let g=()=>i.removeEventListener(u,f,s),p=a.afterRemoved;a.afterRemoved=d=>{p?.(d),g()}}return n}},handleInterceptedEvent(e,t,r,o){let{eventPhase:c,type:i}=o,a=c===Event.CAPTURING_PHASE,n=`on${i}${a?"capture":""}`,s=t.properties;(s&&n in s||(n=`on${i[0].toUpperCase()}${i.slice(1)}${a?"Capture":""}`,s&&n in s))&&(te(),e.scheduleRender(),s[n].call(s.bind||r,o))}}),T=!1,l=class extends Q(G.EventedAccessor){constructor(e,t){super(e,t),this._attached=!1,this._projector=Fe,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=z(()=>C(this,null,function*(){if(this._messageBundleProps?.length){let n=yield Promise.allSettled(this._messageBundleProps.map(f=>C(this,[f],function*({bundlePath:s,propertyName:u}){if(this.destroyed)return;let g=yield J(s);this.uiStrings&&Object.keys(this.uiStrings)&&(g=Ee(x(g),this.uiStrings)),this[u]=g})));if(this.destroyed)return;for(let s of n)s.status==="rejected"&&R.getLogger(this).error("widget-intl:locale-error",this.declaredClass,s.reason)}yield this.loadLocale()})),ue();let r="esri-widget-uid-"+Z(),o=this.render.bind(this);this._trackingTarget=new U(()=>{this.autoRenderingEnabled&&this.scheduleRender()});let c=()=>({vnodeSelector:"div",properties:{key:`${r}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),i=()=>{if(!this._readyForTrueRender||this.destroyed)return null;let n=o()??c(),s=n.properties??={};if(s.key??=r,F(n.vnodeSelector)){if(!this.visible)return c()}else this.visible?s.styles||(s.styles={}):(s.class="",s.styles={display:"none"}),s.styles.display??="";let u=0;return n.children?.forEach(f=>{F(f.vnodeSelector)||(f.properties??={},f.properties.key??=`${this.id}--${u++}`)}),pe(this,n)};this.render=()=>{if(T)return i();let n=re(this)??null;if(n)return n;this._trackingTarget.clear(),T=!0;try{n=M(this._trackingTarget,i)}catch(s){throw R.getLogger(this).error(s),s}finally{T=!1}return n&&oe(this,n),n};let a=this.beforeFirstRender();a?this._resourcesFetch=a.then(()=>{this._readyForTrueRender=!0,this._postInitialize()}):(this._resourcesFetch=Promise.resolve().then(()=>{this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),Pe(this._resourcesFetch)}normalizeCtorArgs(e,t){let r=v({},e);return t&&(r.container=t),r}postInitialize(){}beforeFirstRender(){let e=this.loadDependencies();return this._messageBundleProps?.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(A):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(L(this._trackingTarget),L(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,N(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return fe(e)}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+ke++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(we=ce,le)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(N(this),this._projector.scheduleRender())}own(e){B(R.getLogger(this),"`Widget.own()` is deprecated in favor of 'Widget.addHandles()'",{replacement:"Widget.addHandles()",version:"4.28"}),this.addHandles(e)}classes(...e){return se.apply(this,e)}renderNow(){N(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(S(()=>this.viewModel,(t,r)=>{r&&this.removeHandles("delegated-events"),t&&D(t)&&this.addHandles(this._delegatedEventNames.map(o=>$(t,o,c=>{this.emit(o,c)})),"delegated-events")},Y)),this.postInitialize();let e=()=>C(this,null,function*(){yield this._loadLocale().catch(A),this.scheduleRender()});this.addHandles([q(e),S(()=>this.uiStrings,e),X(()=>this.container,t=>{this.destroyed||this._attach(t)},{initial:!0,once:!0})])}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}};l[we]=!0,l.vnodeSelector="div",h([m()],l.prototype,"_readyForTrueRender",void 0),h([m({value:null})],l.prototype,"container",null),h([ee("container")],l.prototype,"castContainer",null),h([m()],l.prototype,"icon",null),h([m()],l.prototype,"id",null),h([m()],l.prototype,"label",null),h([m()],l.prototype,"renderable",null),h([m()],l.prototype,"uiStrings",void 0),h([m()],l.prototype,"viewModel",void 0),h([m({value:!0})],l.prototype,"visible",null),h([m()],l.prototype,"key",void 0),h([m()],l.prototype,"children",void 0),h([m()],l.prototype,"afterCreate",void 0),h([m()],l.prototype,"afterUpdate",void 0),h([m()],l.prototype,"afterRemoved",void 0),l=h([V(je)],l);var xt=l;function $t(e){return(t,r)=>{t.hasOwnProperty("_messageBundleProps")||(t._messageBundleProps=t._messageBundleProps?t._messageBundleProps.slice():[]),t._messageBundleProps.push({bundlePath:e,propertyName:r})}}export{fe as a,Xe as b,Ke as c,xt as d,$t as e};
