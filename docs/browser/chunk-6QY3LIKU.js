import{b as X}from"./chunk-DTZ5TCG3.js";import{a as Y}from"./chunk-7DG45AVS.js";import{b as $}from"./chunk-O2VLZ273.js";import{a as J}from"./chunk-JBGML6IF.js";import{a as m}from"./chunk-S2HMCZNZ.js";import{i as Q,q as Z}from"./chunk-WUAC4CFP.js";import{a as L,c as N,d as B,f as V,g as W,h as q}from"./chunk-ONDKJR4V.js";import{c as U,g as k,h as H}from"./chunk-QB4KDO4M.js";import{a as K}from"./chunk-NNNTRPDR.js";import{b as a}from"./chunk-J7UK2QPE.js";import{a as b,b as F}from"./chunk-N6PITG7Q.js";import{a as G}from"./chunk-GKUBZAEG.js";import{a as j,e as z}from"./chunk-UW734WOQ.js";import{f as w,j as M,l as y,m as C}from"./chunk-ATV5GTE5.js";import{k as R}from"./chunk-MJXFSFCY.js";import{a as O}from"./chunk-G5SIQY64.js";import{a as S,e as I,g as d}from"./chunk-NPIYHDQ7.js";import{a as c}from"./chunk-4OZVVJHM.js";import{a as E}from"./chunk-EBGO44EK.js";import{a as n}from"./chunk-7W6RATG7.js";import{a as x}from"./chunk-B4JAL745.js";import{a as s}from"./chunk-BMVJCP2M.js";import{a as P}from"./chunk-JEGVIFEP.js";var g=class extends F{constructor(e,t,i){super(e,t,new b($,()=>import("./chunk-VB74U6P4.js")),i,A)}_getPipelineState(e,t){let{oitPass:i,output:T,hasOccludees:u,enableOffset:h,cullFace:l}=e,o=i===O.NONE,f=i===O.FrontFace;return C({blending:T===S.Color?o?w:L(i):null,culling:M(l),depthTest:{func:W(i)},depthWrite:N(e),drawBuffers:q(i,T),colorWrite:y,stencilWrite:u?U:null,stencilTest:u?t?H:k:null,polygonOffset:o||f?null:V(h)})}initializePipeline(e){return this._occludeePipeline=this._getPipelineState(e,!0),this._getPipelineState(e,!1)}getPipeline(e){return e?this._occludeePipeline:super.getPipeline()}},A=new Map([[n.POSITION,0],[n.UV0,2],[n.PERSPECTIVEDIVIDE,3]]);var r=class extends K{constructor(){super(...arguments),this.cullFace=c.None,this.hasSlicePlane=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.perspectiveInterpolation=!0,this.textureCoordinateType=j.None,this.emissionSource=G.None,this.discardInvisibleFragments=!0,this.occlusionPass=!1,this.objectAndLayerIdColorInstanced=!1}};s([a({count:c.COUNT})],r.prototype,"cullFace",void 0),s([a()],r.prototype,"hasSlicePlane",void 0),s([a()],r.prototype,"enableOffset",void 0),s([a()],r.prototype,"writeDepth",void 0),s([a()],r.prototype,"hasOccludees",void 0),s([a()],r.prototype,"terrainDepthTest",void 0),s([a()],r.prototype,"cullAboveTerrain",void 0),s([a()],r.prototype,"perspectiveInterpolation",void 0);var ee=class extends Y{constructor(e){super(e,_),this._configuration=new r,this.vertexAttributeLocations=A,this.supportsEdges=!0,this.produces=new Map([[m.OPAQUE_MATERIAL,t=>I(t)],[m.TRANSPARENT_MATERIAL,t=>d(t)&&this.parameters.writeDepth],[m.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,t=>d(t)&&!this.parameters.writeDepth],[m.DRAPED_MATERIAL,t=>d(t)||I(t)]])}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=t.hasOccludees,this._configuration.oitPass=t.oitPass,this._configuration.enableOffset=t.camera.relativeElevation<B,this._configuration.terrainDepthTest=t.terrainDepthTest,this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration.perspectiveInterpolation=this.parameters.perspectiveInterpolation,this._configuration}get visible(){return!0}createGLMaterial(e){return new v(e)}createBufferWriter(){let e=X.clone();return this.parameters.perspectiveInterpolation&&e.f32(n.PERSPECTIVEDIVIDE),new D(e)}},v=class extends z{constructor(e){super(P(P({},e),e.material.parameters))}beginSlot(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.acquireTechnique(g,e)}},D=class extends J{write(e,t,i,T,u,h){for(let l of this.vertexBufferLayout.fields.keys()){let o=i.get(l);if(o)if(l===n.PERSPECTIVEDIVIDE){E(o.size===1);let f=u.getField(l,x);f&&Q(o,f,h)}else Z(l,o,e,t,u,h)}}},_=class extends R{constructor(){super(...arguments),this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=c.None,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0,this.perspectiveInterpolation=!1}};export{ee as a};
