import{a as N,j as P}from"./chunk-QMGVGOIN.js";import{a as G}from"./chunk-R7Q3STHM.js";import{e as S,f as q}from"./chunk-NKMODNM6.js";import{a as w}from"./chunk-2R4SNL6O.js";import{B as L}from"./chunk-7D4IYTAJ.js";import{a as Y}from"./chunk-GLWPOGYF.js";import{a as D}from"./chunk-YFBPRKIN.js";import{c as R}from"./chunk-RDHMB7M5.js";import{l as C}from"./chunk-N27U3N2T.js";import{a as A}from"./chunk-NDYVXEZ5.js";import{A as U,n as O}from"./chunk-4DLSYLKE.js";import{a as M,b as V,g as z}from"./chunk-JEGVIFEP.js";var c=null,B=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;function _(t,e,o){return t.x<0?t.x+=e:t.x>o&&(t.x-=e),t}function ae(t,e,o,r){let i=U(o)?O(o):null,u=i?Math.round((i.valid[1]-i.valid[0])/e.scale[0]):null;return t.map(s=>{let l=new C(s.geometry);return R(e,l,l),s.geometry=i?_(l,u??0,r[0]):l,s})}function ue(t,e=18,o,r,i){let u=new Float64Array(r*i);e=Math.round(D(e));let s=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,I=q(o);for(let{geometry:p,attributes:v}of t){let{x:$,y:f}=p,g=Math.max(0,$-e),E=Math.max(0,f-e),T=Math.min(i,f+e),F=Math.min(r,$+e),h=+I(v);for(let m=E;m<T;m++)for(let d=g;d<F;d++){let x=m*r+d,b=S(d-$,m-f,e)*h,a=u[x]+=b;s=Math.min(s,a),l=Math.max(l,a)}}return{min:s,max:l}}function k(t){let e=B.exec(t);if(!e)return null;let{hh:o,mm:r,ss:i,ms:u}=e.groups;return Number(o)*w.hours+Number(r)*w.minutes+Number(i)*w.seconds+Number(u||0)}function fe(t,e,o=!0){return z(this,null,function*(){if(!e)return[];let{field:r,field2:i,field3:u,fieldDelimiter:s,fieldInfos:l,timeZone:I}=t,p=r&&l?.find(a=>a.name.toLowerCase()===r.toLowerCase()),v=!!p&&L(p),$=!!p&&G(p),f=t.valueExpression,g=t.normalizationType,E=t.normalizationField,T=t.normalizationTotal,F=[],h=t.viewInfoParams,m=null,d=null;if(f){if(!c){let{arcadeUtils:a}=yield Y();c=a}c.hasGeometryOperations(f)&&(yield c.enableGeometryOperations()),m=c.createFunction(f),d=h?c.getViewInfo({viewingMode:h.viewingMode,scale:h.scale,spatialReference:new A(h.spatialReference)}):null}let x=t.fieldInfos,b=!(e[0]&&"declaredClass"in e[0]&&e[0].declaredClass==="esri.Graphic")&&x?{fields:x}:null;return e.forEach(a=>{let y=a.attributes,n;if(f){let j=b?V(M({},a),{layer:b}):a,W=c.createExecContext(j,d,I);n=c.executeFunction(m,W)}else y&&(n=y[r],i?(n=`${N(n)}${s}${N(y[i])}`,u&&(n=`${n}${s}${N(y[u])}`)):typeof n=="string"&&o&&($?n=n?new Date(n).getTime():null:v&&(n=n?k(n):null)));if(g&&typeof n=="number"&&isFinite(n)){let j=y&&parseFloat(y[E]);n=P(n,g,j,T)}F.push(n)}),F})}export{ae as a,ue as b,k as c,fe as d};
