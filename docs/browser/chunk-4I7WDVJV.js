import{a as Tn,b as Cn,c as ui,e as kn}from"./chunk-HIET2WMU.js";import{b as In,c as me,e as di,f as zn,g as Gn}from"./chunk-JQ2B3NNN.js";import{a as pi,g as Zt,h as ci,i as vn,j as _n,k as xn,l as bn,s as Sn,t as Mn}from"./chunk-ADMU4VMS.js";import{a as On,b as ze,n as Ln}from"./chunk-3TP25Q6W.js";import{a as Pn,b as En,c as Dn,e as Rn,g as Vn,j as Fn,k as An,l as Un}from"./chunk-FG5U4A7J.js";import{a as A,b as si,d as fn,e as ai,f as li,g as gn,h as Q,i as yn}from"./chunk-4LK7YMUL.js";import{a as wn}from"./chunk-4AMJ3NIP.js";import{a as de}from"./chunk-2YEZLTQO.js";import{H as Hn,b as Pt,g as Le,i as ln,o as pn,q as cn,r as un,s as dn,v as ri,w as mn,x as ni,y as hn}from"./chunk-AB4CTIUZ.js";import{c as ft}from"./chunk-2HYJESCC.js";import{e as nn,g as sn}from"./chunk-OZ5LGYCJ.js";import{c as an}from"./chunk-G54NHNUC.js";import{a as on}from"./chunk-YFTQBYV4.js";import{a as Qr}from"./chunk-EIHMNF7R.js";import{f as Hr,o as Nr}from"./chunk-ZPQQQXRA.js";import{a as zr}from"./chunk-VQ5WF3XI.js";import{a as ii,b as rn}from"./chunk-XRVFK5TR.js";import{a as en}from"./chunk-N5XPA5VH.js";import{a as tn}from"./chunk-23WSQWHC.js";import{a as W,b as et,c as jr,d as at,e as ot,f as xt,j as Y,k as lt,l as Ue,m as Jr}from"./chunk-E24SCC45.js";import{b as $r,e as Wr,f as Yr,k as Xr,l as ei,n as Ae,o as qr,v as Kr}from"./chunk-3KFX3FFC.js";import{a as oi}from"./chunk-XI5TLVWU.js";import{d as ti}from"./chunk-RLQK45UV.js";import{b as Zr,e as ue}from"./chunk-K55ZDM2S.js";import{a as ce}from"./chunk-M2F4B74F.js";import{a as pe}from"./chunk-2WNCPIJC.js";import{c as Vr}from"./chunk-PVCDKA4D.js";import{d as Rr}from"./chunk-WYOOSF42.js";import{a as Gr}from"./chunk-GB5RQL32.js";import{e as Nt}from"./chunk-X7XJWAFC.js";import{d as Ur,i as Lr}from"./chunk-ILCAH2F6.js";import{a as Jo}from"./chunk-CYCLIMTY.js";import{e as Fr}from"./chunk-QBRYULPI.js";import{a as Ar}from"./chunk-HVNUIUKO.js";import{a as Dr}from"./chunk-7X2HMUNN.js";import{b as jo}from"./chunk-LW2464MZ.js";import{a as Br}from"./chunk-63EK7JRZ.js";import{a as Ve}from"./chunk-AYOI2Y26.js";import{a as Ht,b as Fe}from"./chunk-JMSMQ4Z7.js";import{h as _r,r as xr}from"./chunk-FW33MEBA.js";import{b as It,c as Ee,d as br,e as wr,f as Tr,g as $o,j as Wo,o as Yo,x as Xo}from"./chunk-XTES2GPX.js";import{A as qo,B as Ko,E as Qo,b as Cr,c as kr,d as De,e as Re,n as Ot,p as Sr,s as Mr,u as Ir,v as Or,w as Pr,x as Er}from"./chunk-2HUIJUS4.js";import{c as zt,d as st,e as se}from"./chunk-JTM5BEUP.js";import{c as Yi}from"./chunk-S5E62J6M.js";import{e as u,f as P}from"./chunk-AKDLIRLE.js";import{e as $i,f as Wi}from"./chunk-5TKTI2G2.js";import{a as Bi}from"./chunk-VDNXTMSC.js";import{a as F,b as Zi,d as Ao,g as Lt,h as Uo,i as mt}from"./chunk-MBJHSEMD.js";import{a as _t,d as Mt,e as Ho,f as Pe,i as No}from"./chunk-YFBPRKIN.js";import{a as dr,o as Gt,p as fr}from"./chunk-T7BKG6V3.js";import{h as mr,k as Go,l as hr}from"./chunk-R6VC74T7.js";import{a as Ie}from"./chunk-3CR7P5WT.js";import{a as D,b as gr,c as yr,i as Zo,j as vr,m as Bo}from"./chunk-PYQRTZNZ.js";import{b as Ut,c as vt}from"./chunk-S4PLWG55.js";import{c as Fo}from"./chunk-VQHENXDQ.js";import{a as nt}from"./chunk-VWF5VUO3.js";import{f as ne}from"./chunk-HRP5LYWJ.js";import{n as Oe}from"./chunk-5PTS4JDF.js";import{f as Me,h as pr,i as cr,k as ur,l as G}from"./chunk-N27U3N2T.js";import{a as ht}from"./chunk-NDYVXEZ5.js";import{$ as nr,B as zo,J as tr,P as er,Q as or,R as ir,S as rr,a as Xi,b as qi,ba as ae,d as Ki,da as le,e as Lo,ea as sr,g as Qi,ha as ar,ia as Se,k as ji,ka as lr,u as Ji}from"./chunk-4DLSYLKE.js";import{M as Vo,Q as s,S as M,y as Ro,z as ke}from"./chunk-GGZQ5GCM.js";import{U as d}from"./chunk-TFUPB3ZG.js";import{a as r}from"./chunk-BMVJCP2M.js";import{a as kt,c as Gi,i as St,l as Hi,p as Eo,u as Do,z as Ni}from"./chunk-GMC3I5VG.js";import{b as tt,g as zi}from"./chunk-WGF2T2BG.js";import{b as re,t as Ce}from"./chunk-3IBUFXWY.js";import{g as Li,u as At}from"./chunk-BP73DJTS.js";import{a as x,b as dt,g as T}from"./chunk-JEGVIFEP.js";function $t(){return Xi()}function he(){return qi()}function Bt(t,e){let o=[];t=(t=(t=t.replaceAll(/[\u00B0\u00BA]/g,"^")).replaceAll("\u2032","'")).replaceAll("\u2033",'"');let i=ha(e);return Qi.dmsToGeog(i,1,[t],o)?new G(o[0][0],o[0][1],e||ht.WGS84):null}function Nn(t){return t&&$t()?vt(t)??Bt(`0\xB0 0' 0" N | ${t}`)?.longitude??Bt(`0 | ${t}`)?.longitude??null:null}function Zn(t){return t&&$t()?vt(t)??Bt(`${t} | 0\xB0 0' 0" E`)?.latitude??Bt(`${t} | 0`)?.latitude??null:null}function ha(t){let e=null;if(t||(t=ht.WGS84),t.wkid){if(e=Lo.geogcs(t.wkid),!e)throw new Ce("coordinate-formatter:invalid-spatial-reference","wkid is not valid")}else{if(!t.wkt2&&!t.wkt)throw new Ce("coordinate-formatter:invalid-spatial-reference","wkid and wkt are missing");if(e=Lo.fromString(Ki.PE_TYPE_GEOGCS,t.wkt2||t.wkt),!e)throw new Ce("coordinate-formatter:invalid-spatial-reference","wkt is not valid")}return e}var E="esri-tooltip",Bn=`${E}-content`,$n=`${E}-content--input`,Wn=`${E}-content__header`,Yn=`${E}-content__header__spacer`,mi=`${E}-content__header__actions`,Ge=`${E}-draw-header-actions`,Xn=`${E}-table`,qn=`${E}-help-message`,Kn=`${E}-help-message__text`,Qn=`${E}-help-message__icon`;var He=`${E}-field`,Ne={base:He,inputMode:`${He}--input`,title:`${He}__title`,value:`${He}__value`},b=class extends st{constructor(){super(...arguments),this.hidden=!1,this.mode="feedback"}render(){return u("div",{class:this.classes({[Ne.base]:!0,[Ne.inputMode]:this.mode==="input"})},u("div",{class:Ne.title,key:"title"},this.title),u("div",{class:Ne.value,key:"value"},this.value))}};r([s()],b.prototype,"hidden",void 0),r([s()],b.prototype,"mode",void 0),r([s()],b.prototype,"title",void 0),r([s()],b.prototype,"value",void 0),b=r([d("esri.views.interactive.tooltip.components.TooltipField")],b);var fa={base:`${E}-value-by-value`},j=class extends st{constructor(){super(...arguments),this.divider="\xD7"}render(){return u("div",{class:fa.base},u("span",null,this.left),u("span",null,this.divider),u("span",null,this.right))}};r([s()],j.prototype,"left",void 0),r([s()],j.prototype,"divider",void 0),r([s()],j.prototype,"right",void 0),j=r([d("esri.views.interactive.tooltip.components.ValueByValue")],j);var Ze=1,Jn=6;function ts(t,e){return{angleRelative:ga,direction:ya,directionRelative:va,directionRelativeBilateral:_a,latitudeDecimalDegrees:ba,longitudeDecimalDegrees:xa,area:(o,i)=>bn(t,o,i??e.area),length:(o,i,n)=>ci(t,o,i??e.length,n),lengthRelative:(o,i)=>vn(t,o,i??e.length),totalLength:(o,i)=>ci(t,o,i??e.length),verticalLength:(o,i)=>_n(t,o,i??e.verticalLength),verticalLengthRelative:(o,i)=>xn(t,o,i??e.verticalLength),percentage:wa,scalar:ns,scale:Ta}}function ga(t){return Ut(t,x({signDisplay:"exceptZero"},hi(Ze)))}function ya(t){return Zt(t,t.rotationType,Ze)}function va(t){let e=Q(t);return Ut(e,x({style:"unit",unitDisplay:"narrow",unit:"degree",signDisplay:e>0?"never":"exceptZero"},hi(Ze)))}function _a(t){return Zt(t,t.rotationType,Ze)}function xa(t){return is(t,us)}function ba(t){return is(t,ds)}function es(t){return rs(t,us)}function os(t){return rs(t,ds)}function is(t,e){return Zt(ot(t,"degrees"),"geographic",Jn,e,!1)}function rs(t,e){let i=e.normalize(ot(t,"degrees").value,void 0,!1);return ns(W(i),Jn)}function wa(t){return Ut(t.value,{style:"percent"})}function Ta(t){return Ut(t,{style:"percent",maximumFractionDigits:0})}function ns(t,e){return Ut(t.value,hi(e))}function hi(t){return{minimumFractionDigits:t,maximumFractionDigits:t}}function X({createQuantity:t,sanitize:e}){return(o,i)=>{if(o==null)return null;e&&(o=e(o));let n=vt(o);return n==null?null:t(n,i)}}function Be(t){return t.replaceAll(/[*^~°º]/g,"")}var Ca=t=>{let e=`[-+]?[0-9${t.thousands}]+`;return t.decimal!==""&&(e+=`${t.decimal}[0-9]+`),new RegExp(`^(${e}\\s*)${t.separator}(\\s*${e})$`,"i")},ka="\u202F",ss=[];for(let t of[",","\\|","\\s+"])for(let e of["\\.",",",""])for(let o of["",",","\\.",ka,"\\s+"])t!==e&&t!==o&&e!==o&&ss.push({separator:t,decimal:e,thousands:o,pattern:Ca({decimal:e,thousands:o,separator:t})});function as(t){for(let{decimal:e,thousands:o,pattern:i}of ss){i.lastIndex=0;let n=t.match(i);if(!n)continue;let a=vt(jn(n[1],e,o)),l=vt(jn(n[2],e,o));if(a!=null&&l!=null)return{x:W(a),y:W(l)}}return null}function jn(t,e,o){let i=t.replaceAll(/[\s+]/g,"");return o!==""&&(i=i.replaceAll(o,"")),e!==""&&(i=i.replaceAll(e,".")),i}function ls(t){if(!t||vt(t)!=null||!$t())return null;let e=Bt(t),o=Et(e?.latitude),i=Et(e?.longitude);return i!=null&&o!=null?{latitude:o,longitude:i}:null}function ps(t){return Et(Nn(t))}function cs(t){return Et(Zn(t))}function Et(t){return t!=null?at(t,"degrees","geographic"):null}var us=new oi(-180,180),ds=new oi(-90,90);var fi=Symbol("dragHandles"),f=class extends st{constructor(){super(...arguments),this._focusAbortController=new AbortController,this._transitionInfo=null,this._mode="feedback",this._getFormatters=de(ts),this._onHeaderPointerDown=t=>{let e=t.target;e instanceof HTMLElement&&e?.tagName?.toLowerCase()!=="calcite-button"&&(this.removeHandles(fi),e.setPointerCapture(t.pointerId),this.tooltip.onDragStart(t.clientX,t.clientY),this.addHandles([St(e,"pointermove",({clientX:o,clientY:i})=>{this.tooltip.onDrag(o,i)}),St(e,["pointerup","pointercancel"],o=>{this.removeHandles(fi),e.releasePointerCapture(t.pointerId),this.tooltip.onDragEnd()}),St(e,"touchstart",o=>o.preventDefault())],fi))},this._onDiscard=()=>{this.destroyed||(this.tooltip.emit("discard"),this.info.clearInputValues(),this.exitInputMode())},this._onCommit=(t,e)=>{if(this.destroyed)return;if(this.tooltip.emit("commit",{type:e}),e==="commit-and-exit")return void this.exitInputMode();if(e==="commit-on-blur")return;let o=this._getFocusableElements(),i=o.length,n=o.indexOf(t);if(n===-1)return void this.exitInputMode();let a=((n+(e==="commit-and-next"?1:-1))%i+i)%i;$e(o.at(a))},this._onKeyDown=t=>{switch(t.code){case ft.next:return this._onNextKey(t);case ft.discard:return t.stopPropagation(),this._onDiscard()}}}get mode(){return this._mode}get _displayUnits(){let{displayUnits:t}=this.info.sketchOptions.values,e=pi(this.tooltip.view);return{length:t.length??e,verticalLength:t.verticalLength??e,area:t.area??e}}get _inputUnitInfos(){let t=this._messagesUnits,e=p=>({unit:p,abbreviation:tn(t,p,"abbr")}),{inputUnits:o}=this.info.sketchOptions.values,i=pi(this.tooltip.view),n=o.length??i,a=o.verticalLength??i,l=o.area??i;return{length:e(or(n)),verticalLength:e(ir(a)),area:e(rr(l)),angle:e("degrees")}}get _formatters(){return this._getFormatters(this._messagesUnits,this._displayUnits)}get fieldContext(){return{formatters:this._formatters,inputUnitInfos:this._inputUnitInfos,messages:this._messagesTooltip,sketchOptions:this.info.sketchOptions,onCommit:this._onCommit,onDiscard:this._onDiscard}}render(){let{visibleElements:t}=this.info.sketchOptions.tooltips,e=this._renderedContent,o=this._renderedActions,i=this._renderedHelpMessage,n=e.length>0,a=n||!!i,l=this.mode==="input";return u("div",{class:$i(Bn,l&&$n),onkeydown:this._onKeyDown,tabIndex:-1},l&&a&&t.header?u("div",{class:Wn,"data-testid":"tooltip-header",key:"header",onpointerdown:this._onHeaderPointerDown},u("calcite-button",{appearance:"transparent","data-testid":"tooltip-back-button",iconFlipRtl:"both",iconStart:"chevron-left",key:"discard-button",kind:"neutral",onclick:this._onDiscard,scale:"s",tabIndex:-1}),o.length>0?u(P,null,u("div",{class:Yn,key:"spacer"}),u("div",{class:mi,key:"actions"},o)):null):null,n?u("div",{class:Xn,key:"content"},...e):null,i)}destroy(){this._focusAbortController.abort(),this._transitionInfo?.transition.skipTransition()}_renderActions(){return null}loadDependencies(){return zt({button:()=>import("./chunk-DNI5Y472.js"),icon:()=>import("./chunk-7ENH7JJJ.js"),input:()=>import("./chunk-YYGIDEVG.js")})}enterInputMode(t,e){return T(this,null,function*(){try{yield this._transitionTo("input",e),yield this._focusField(t)}catch(o){Eo(o)}})}exitInputMode(){return T(this,arguments,function*({focusOnView:t=!0}={}){try{let{container:e,info:o}=this;o.clearInputValues();let i=t?e?.closest(".esri-view")?.querySelector(".esri-view-surface"):null;yield this._transitionTo("feedback"),i instanceof HTMLElement&&i.focus()}catch(e){Eo(e)}})}_onNextKey(t){let e=this._getFocusableElements(),o=e.at(0),i=e.at(-1);o&&i&&(t.shiftKey?document.activeElement===o&&(t.preventDefault(),t.stopPropagation(),$e(i)):document.activeElement===i&&(t.preventDefault(),t.stopPropagation(),$e(o)))}get _renderedContent(){return ms(this._renderContent())}get _renderedActions(){return ms(this._renderActions())}get _renderedHelpMessage(){let{sketchOptions:t,visibleElements:e}=this.info;if(!e.helpMessage)return null;let o=t.tooltips.helpMessage??this._defaultHelpMessage;if(!o)return null;let i=t.tooltips.helpMessageIcon??"information";return u("div",{class:qn,key:"help-message"},i?u("calcite-icon",{class:Qn,icon:i,scale:"s"}):null,u("div",{class:Kn},o))}get _defaultHelpMessage(){let{helpMessage:t,viewType:e}=this.info;if(t==null)return null;let o=e==="3d"?"helpMessages3d":"helpMessages2d";return this._messagesTooltip?.sketch?.[o]?.[t]}_focusField(t){return T(this,null,function*(){this._focusAbortController?.abort(),this._focusAbortController=new AbortController;let{signal:e}=this._focusAbortController;yield this._waitForInputs(),Hi(e);let o=this._getFocusableInputs(),i=t?o.find(n=>n.getAttribute("data-field-name")===t):o.at(0);yield $e(i)})}_transitionTo(t,e){return T(this,null,function*(){if(this._mode===t&&!this._transitionInfo)return;if(this._transitionInfo?.mode===t)return this._transitionInfo.transition.finished;this._transitionInfo?.transition.skipTransition();let o=()=>T(this,null,function*(){this.destroyed||(this._mode=t,yield Ro(),this.destroyed||(this.renderNow(),yield Ro(),this.destroyed||e?.()))});if(!this.domNode?.firstChild||!document.startViewTransition||en())return void(yield o());this.autoRenderingEnabled=!1;let i=this._transitionInfo={transition:document.startViewTransition(()=>T(this,null,function*(){this.destroyed||i!==this._transitionInfo||(this.autoRenderingEnabled=!0,yield o())})),mode:t};try{yield i.transition.finished}finally{i===this._transitionInfo&&(this._transitionInfo=null)}})}_waitForInputs(){return T(this,null,function*(){let t=()=>Array.from(this.domNode?.querySelectorAll("calcite-input")??[]);for(;t().length===0;)yield Ni(Sa);yield ke()})}_getFocusableInputs(){return Array.from(this.domNode?.querySelectorAll("calcite-input:not([read-only]):not([disabled])")??[])}_getFocusableElements(){let t=this.domNode?.querySelector(`.${Ge}`);return[...Array.from(t?.querySelectorAll(`.${mi} calcite-button:not([disabled])`)??[]),...this._getFocusableInputs()]}};function $e(t){return T(this,null,function*(){yield t?.setFocus()})}function ms(t){return(Array.isArray(t)?t:[t]).flat(10).filter(e=>!!e)}r([se("esri/core/t9n/Units"),s()],f.prototype,"_messagesUnits",void 0),r([se("esri/views/interactive/tooltip/t9n/Tooltip"),s()],f.prototype,"_messagesTooltip",void 0),r([s()],f.prototype,"info",void 0),r([s()],f.prototype,"tooltip",void 0),r([s()],f.prototype,"_mode",void 0),r([s()],f.prototype,"mode",null),r([s()],f.prototype,"_displayUnits",null),r([s()],f.prototype,"_inputUnitInfos",null),r([s()],f.prototype,"_formatters",null),r([s()],f.prototype,"fieldContext",null),r([s()],f.prototype,"_renderedContent",null),r([s()],f.prototype,"_renderedActions",null),r([s()],f.prototype,"_renderedHelpMessage",null),r([s()],f.prototype,"_defaultHelpMessage",null),f=r([d("esri.views.interactive.tooltip.content.TooltipContent")],f);var Sa=20;var We=class extends f{_renderContent(){let{area:t,radius:e,xSize:o,ySize:i,visibleElements:n}=this.info,a=this._messagesTooltip.sketch,l=this._formatters;return u(P,null,n.radius&&e!=null?u(b,{title:a.radius,value:l.length(e)}):null,n.size&&o!=null&&i!=null?u(b,{title:a.size,value:u(j,{left:l.length(o),right:l.length(i)})}):null,n.area?u(b,{title:a.area,value:l.area(t)}):null)}};We=r([d("esri.views.interactive.tooltip.content.TooltipContentDrawCircle")],We);var q=`${E}-editable-field`,$={base:q,inputMode:`${q}--input`,feedbackMode:`${q}--feedback`,readOnly:`${q}--read-only`,locked:`${q}--locked`,title:`${q}__title`,value:`${q}__value`,valueContent:`${q}__value__content`,valueContentReadOnly:`${q}__value__content--read-only`,lockIcon:`${q}__lock-icon`,input:`${q}__input`,inputSuffix:`${q}__input-suffix`,button:`${q}__button`},gi={lock:"lock",unlock:"unlock"},K=class extends st{constructor(){super(...arguments),this._input=null,this._lock=null,this._onLockClick=()=>{this.field.toggleLock(this.context)},this._onLockAfterCreate=t=>{this._lock=t},this._onLockAfterRemoved=()=>{this._lock=null},this._onKeyDown=t=>{t.key===ft.discard&&this.mode==="input"&&this._input&&this.context.onDiscard(this._input)},this._onInputKeyDown=t=>{let e=this._input;if(e)switch(t.key){case ft.commit:return this.field.onCommit("commit-and-exit",e,this.context);case ft.next:{t.preventDefault(),t.stopPropagation();let o=t.shiftKey?"commit-and-previous":"commit-and-next";return this.field.onCommit(o,e,this.context)}}},this._onInput=t=>{this.field.onInput(t.target.value)},this._onInputBlur=t=>{let e=this._input;e&&t.relatedTarget!==this._lock&&this.field.onCommit("commit-on-blur",e,this.context)},this._selectText=()=>{let t=()=>{this._input===document.activeElement&&this._input?.selectText()};t(),ke().then(t)},this._onAfterCreate=t=>{this._input=t,t.addEventListener("paste",this._onPaste),t.addEventListener("beforeinput",this._onBeforeInput)},this._onAfterRemoved=t=>{t.removeEventListener("paste",this._onPaste),t.removeEventListener("beforeinput",this._onBeforeInput)},this._onPaste=t=>{let e=t.clipboardData?.getData("text");e&&this.field.parse(e,this.context)!=null&&(t.stopPropagation(),this.field.onInput(e))},this._onBeforeInput=t=>{(t.inputType==="historyUndo"||t.inputType==="historyRedo")&&!this.field.dirty&&t.preventDefault()}}initialize(){this.addHandles(F(()=>this._rawDisplayValue,()=>{let{committed:t,inputValue:e}=this.field;t||e||this._input!==document.activeElement||this._selectText()}))}loadDependencies(){return zt({button:()=>import("./chunk-DNI5Y472.js"),icon:()=>import("./chunk-7ENH7JJJ.js"),input:()=>import("./chunk-YYGIDEVG.js")})}render(){let{field:t,mode:e}=this,o=e==="input",{locked:i,readOnly:n}=t;return u("div",{class:this.classes({[$.base]:!0,[$.feedbackMode]:e==="feedback",[$.inputMode]:e==="input",[$.locked]:i,[$.readOnly]:n})},u("div",{class:$.title,key:"title"},this._title),u("div",{class:$.value,key:"value",onkeydown:this._onKeyDown},o?this._renderValueInputMode():this._renderValueFeedbackMode()))}get _formattedValue(){return this.field.getFormattedValue(this.context)||hs}get _rawDisplayValue(){return this.field.getRawDisplayValue(this.context)}get _suffix(){return this.field.getSuffix(this.context)}get _title(){let{title:t}=this.field;return typeof t=="string"?t:t(this.context)}_renderValueFeedbackMode(){return u(P,null,u("div",{class:$.valueContent,key:"value-feedback"},this._formattedValue),this.field.locked&&this.mode!=="input"?u("calcite-icon",{class:$.lockIcon,icon:gi.lock,key:"icon",scale:"s"}):null)}_renderValueInputMode(){return this.field.readOnly?this._renderValueReadOnly():this._renderValueWritable()}_renderValueReadOnly(){return u("div",{class:this.classes($.valueContent,$.valueContentReadOnly),key:"value-read-only"},this._formattedValue)}_renderValueWritable(){let{field:t}=this,{name:e,invalid:o,locked:i}=t,n=this.context?.messages.sketch??{},a=i?n.unlockConstraint:n.lockConstraint;return u(P,null,u("calcite-input",{afterCreate:this._onAfterCreate,afterRemoved:this._onAfterRemoved,class:$.input,"data-field-name":e,"data-testid":`tooltip-field-${e}`,key:"input",onblur:this._onInputBlur,onfocus:this._selectText,onkeydown:this._onInputKeyDown,scale:"s",status:o?"invalid":"idle",type:"text",value:this._rawDisplayValue??hs,onCalciteInputInput:this._onInput}),u("div",{class:$.inputSuffix,key:"suffix"},this._suffix),t.lockable?u("calcite-button",{afterCreate:this._onLockAfterCreate,afterRemoved:this._onLockAfterRemoved,alignment:"center",appearance:"transparent",class:$.button,"data-testid":`tooltip-field-${e}-lock`,iconStart:i?gi.lock:gi.unlock,key:"lock",kind:"neutral",label:a,onclick:this._onLockClick,scale:"s",tabIndex:-1,title:a}):u("div",{key:"lock-empty"}))}};r([s()],K.prototype,"field",void 0),r([s()],K.prototype,"context",void 0),r([s()],K.prototype,"mode",void 0),r([s()],K.prototype,"_input",void 0),r([s()],K.prototype,"_lock",void 0),r([s()],K.prototype,"_formattedValue",null),r([s()],K.prototype,"_rawDisplayValue",null),r([s()],K.prototype,"_suffix",null),r([s()],K.prototype,"_title",null),K=r([d("esri.views.interactive.tooltip.components.TooltipEditableField")],K);var hs="\u2014";function U(t){let e=t.fields.filter(o=>o?.visible===!0);return e.length===0?null:u(P,null,e.map(o=>u(K,{context:t.context,field:o,key:o.id,mode:t.mode})))}var Ye=class extends f{_renderContent(){let{fieldContext:t,info:e,mode:o}=this,{visibleElements:i}=e;return u(U,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0,i.orientation?e.orientation:void 0,i.scale?e.scale:void 0],mode:o})}};Ye=r([d("esri.views.interactive.tooltip.content.TooltipContentDrawMesh")],Ye);var Xe=class extends f{_renderContent(){let{fieldContext:t,info:e,mode:o}=this,{elevation:i,visibleElements:n}=e;return u(U,{context:t,fields:[n.coordinates?e.effectiveX:void 0,n.coordinates?e.effectiveY:void 0,n.elevation?i:void 0],mode:o})}};Xe=r([d("esri.views.interactive.tooltip.content.TooltipContentDrawPoint")],Xe);var qe={absolute:"absolute-direction",relative:"relative-direction"};var gt=class extends st{constructor(t){super(t),this.visibleElements={}}render(){return u("div",{class:Ge},this._isElementVisible("direction")?u(Ma,{messages:this.messages,sketchOptions:this.sketchOptions}):null)}loadDependencies(){return zt({button:()=>import("./chunk-DNI5Y472.js"),dropdown:()=>import("./chunk-FMX4IUI3.js"),"dropdown-item":()=>import("./chunk-BO7NEAAA.js"),"dropdown-group":()=>import("./chunk-QJL3UP63.js")})}_isElementVisible(t){return this.visibleElements?.[t]??this.sketchOptions.tooltips.visibleElements[t]}};function Ma(t){let{directionMode:e}=t.sketchOptions.values,o=t.messages?.sketch,i=o?.directionModeSelect?.title,n="absolute",a="relative";return u("calcite-dropdown",{key:"direction-mode",placement:"bottom-end",scale:"s",widthScale:"s",onCalciteDropdownSelect:l=>{let p=l.target.selectedItems?.[0]?.getAttribute("data-mode");t.sketchOptions.values.directionMode=p??"absolute"}},u("calcite-button",{alignment:"end",appearance:"transparent",iconStart:qe[e],kind:"neutral",label:i,scale:"s",slot:"trigger",title:i}),u("calcite-dropdown-group",{selectionMode:"single"},u("calcite-dropdown-item",{"data-mode":a,"data-testid":"tooltip-direction-mode-relative",iconStart:qe.relative,key:"relative",selected:e===a},o?.directionModeSelect?.relative),u("calcite-dropdown-item",{"data-mode":n,"data-testid":"tooltip-direction-mode-absolute",iconStart:qe.absolute,key:"absolute",selected:e===n},o?.directionModeSelect?.absolute)))}r([se("esri/views/interactive/tooltip/t9n/Tooltip"),s()],gt.prototype,"messages",void 0),r([s()],gt.prototype,"sketchOptions",void 0),r([s()],gt.prototype,"visibleElements",void 0),gt=r([d("esri.views.interactive.tooltip.components.DrawHeaderActions")],gt);var Ke=class extends f{_renderContent(){let{fieldContext:t,info:e,mode:o}=this,{xyMode:i,visibleElements:n}=e;return u(U,{context:t,fields:[...i==="direction-distance"?[n.direction?e.direction:void 0,n.distance?e.distance:void 0]:[n.coordinates?e.effectiveX:void 0,n.coordinates?e.effectiveY:void 0],n.elevation?e.elevation:void 0,n.area?e.area:void 0],mode:o})}_renderActions(){let{xyMode:t,sketchOptions:e}=this.info;return u(gt,{sketchOptions:e,visibleElements:{direction:t==="direction-distance"}})}};Ke=r([d("esri.views.interactive.tooltip.content.TooltipContentDrawPolygon")],Ke);var Qe=class extends f{_renderContent(){let{fieldContext:t,info:e,mode:o}=this,{xyMode:i,visibleElements:n}=e;return u(U,{context:t,fields:[...i==="direction-distance"?[n.direction?e.direction:void 0,n.distance?e.distance:void 0]:[n.coordinates?e.effectiveX:void 0,n.coordinates?e.effectiveY:void 0],n.elevation?e.elevation:void 0,n.totalLength?e.totalLength:void 0],mode:o})}_renderActions(){let{xyMode:t,sketchOptions:e}=this.info;return u(gt,{sketchOptions:e,visibleElements:{direction:t==="direction-distance"}})}};Qe=r([d("esri.views.interactive.tooltip.content.TooltipContentDrawPolyline")],Qe);var je=class extends f{_renderContent(){let{area:t,xSize:e,ySize:o,visibleElements:i}=this.info,n=this._messagesTooltip.sketch,a=this._formatters;return u(P,null,i.size&&e!=null&&o!=null?u(b,{title:n.size,value:u(j,{left:a.length(e),right:a.length(o)})}):null,i.area?u(b,{title:n.area,value:a.area(t)}):null)}};je=r([d("esri.views.interactive.tooltip.content.TooltipContentDrawRectangle")],je);var Je=class extends f{_renderContent(){let{angle:t,visibleElements:e}=this.info,o=this._messagesTooltip.sketch;return u(P,null,e.rotation?u(b,{title:o.rotation,value:this._formatters.angleRelative(t)}):null)}};Je=r([d("esri.views.interactive.tooltip.content.TooltipContentExtentRotate")],Je);var to=class extends f{_renderContent(){let t=this.info,{visibleElements:e}=t,o=this._messagesTooltip.sketch,i=this._formatters;return u(P,null,e.size?u(b,{title:o.size,value:u(j,{left:i.length(t.xSize),right:i.length(t.ySize)})}):null,e.scale?u(b,{title:o.scale,value:u(j,{left:i.scale(t.xScale),right:i.scale(t.yScale)})}):null)}};to=r([d("esri.views.interactive.tooltip.content.TooltipContentExtentScale")],to);var eo=class extends f{_renderContent(){let{fieldContext:t,info:e,mode:o}=this,{visibleElements:i}=e;return u(U,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0],mode:o})}};eo=r([d("esri.views.interactive.tooltip.content.TooltipContentMovePoint")],eo);var oo=class extends f{_renderContent(){let{fieldContext:t,info:e,mode:o}=this,{visibleElements:i}=e;return u(U,{context:t,fields:[i.distance?e.distance:void 0,i.area?e.area:void 0,i.totalLength?e.totalLength:void 0],mode:o})}};oo=r([d("esri.views.interactive.tooltip.content.TooltipContentReshapeEdgeOffset")],oo);var io=class extends f{_renderContent(){let{fieldContext:t,info:e,mode:o}=this,{visibleElements:i}=e;return u(U,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0,i.area&&e.geometryType==="polygon"?e.area:null,i.totalLength&&e.geometryType==="polyline"?e.totalLength:null],mode:o})}};io=r([d("esri.views.interactive.tooltip.content.TooltipContentSelectedVertex")],io);var ro=class extends f{_renderContent(){let{fieldContext:t,info:e,mode:o}=this,{visibleElements:i}=e;return u(U,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0,i.orientation?e.orientation:void 0,i.scale?e.scale:void 0],mode:o})}};ro=r([d("esri.views.interactive.tooltip.content.TooltipContentTransformMesh")],ro);var no=class extends f{_renderContent(){let{fieldContext:t,info:e,mode:o}=this,{visibleElements:i}=e;return u(U,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0,i.orientation?e.orientation:void 0,i.size?e.size:void 0],mode:o})}};no=r([d("esri.views.interactive.tooltip.content.TooltipContentTransformPoint")],no);var so=class extends f{_renderContent(){let{info:t}=this,{visibleElements:e}=t,o=this._messagesTooltip.sketch,i=this._formatters;return u(P,null,e.distance?u(b,{title:o.distance,value:i.length(t.distance)}):null)}};so=r([d("esri.views.interactive.tooltip.content.TooltipContentTranslate")],so);var ao=class extends f{_renderContent(){let{distance:t,elevation:e,area:o,totalLength:i,visibleElements:n}=this.info,a=this._messagesTooltip.sketch,l=this._formatters;return u(P,null,n.distance?u(b,{title:a.distance,value:l.length(t)}):null,n.elevation&&e?.actual!=null?u(b,{title:a.elevation,value:l.verticalLength(e.actual)}):null,n.area&&o!=null?u(b,{title:a.area,value:l.area(o)}):null,n.totalLength&&i!=null?u(b,{title:a.totalLength,value:l.length(i)}):null)}};ao=r([d("esri.views.interactive.tooltip.content.TooltipContentTranslateVertex")],ao);var lo=class extends f{_renderContent(){let{info:t}=this,{visibleElements:e}=t,o=this._messagesTooltip.sketch,i=this._formatters;return u(P,null,e.distance?u(b,{title:o.distance,value:i.length(t.distance)}):null)}};lo=r([d("esri.views.interactive.tooltip.content.TooltipContentTranslateXY")],lo);var po=class extends f{_renderContent(){let{info:t}=this,{visibleElements:e}=t,o=this._messagesTooltip.sketch;return u(P,null,e.distance?u(b,{title:o.distance,value:this._formatters.verticalLengthRelative(t.distance)}):null)}};po=r([d("esri.views.interactive.tooltip.content.TooltipContentTranslateZ")],po);function fs(t,e){if(e==null)return null;let o=document.createElement("div");switch(e.type){case"draw-point":return new Xe({tooltip:t,info:e,container:o});case"draw-polygon":return new Ke({tooltip:t,info:e,container:o});case"draw-polyline":return new Qe({tooltip:t,info:e,container:o});case"draw-mesh":return new Ye({tooltip:t,info:e,container:o});case"draw-rectangle":return new je({tooltip:t,info:e,container:o});case"draw-circle":return new We({tooltip:t,info:e,container:o});case"extent-rotate":return new Je({tooltip:t,info:e,container:o});case"extent-scale":return new to({tooltip:t,info:e,container:o});case"move-point":return new eo({tooltip:t,info:e,container:o});case"selected-vertex":return new io({tooltip:t,info:e,container:o});case"transform-point":return new no({tooltip:t,info:e,container:o});case"transform-mesh":return new ro({tooltip:t,info:e,container:o});case"translate":return new so({tooltip:t,info:e,container:o});case"translate-vertex":return new ao({tooltip:t,info:e,container:o});case"translate-z":return new po({tooltip:t,info:e,container:o});case"translate-xy":return new lo({tooltip:t,info:e,container:o});case"reshape-edge-offset":return new oo({tooltip:t,info:e,container:o})}}var fe={base:`${E}`,ltr:`${E}--ltr`,rtl:`${E}--rtl`,debug:`${E}--debug`},Ia=20,Oa=16,Pa="bottom-end",R=class extends nt.EventedAccessor{constructor(t){super(t),this.info=null,this.options=null,this.position=null,this.content=null,this._focused=!1,this.outerContainer=document.createElement("div"),this.debug=!1,this._lastPosition=null,this._rtl=!1,this._prevXY=[0,0]}initialize(){let{outerContainer:t}=this;this.addHandles([F(()=>this.view.overlay?.surface,e=>{t.remove(),e?.appendChild(t),this._rtl=Wi(e)},mt),F(()=>this.info,(e,o)=>{if(this.content!=null&&e!=null&&o!=null&&e.type===o.type)this.content.info=e;else{tt(this.content);let i=fs(this,e);i?(this.content=i,i.container&&t.appendChild(i.container),this.exitInputMode()):this.content=null}},mt),F(()=>({container:this.outerContainer,style:this._outerContainerStyle}),({container:e,style:o})=>{Object.assign(e.style,o)},Uo),F(()=>({outerContainer:this.outerContainer,placement:this.effectivePlacement,effectiveOffset:this._effectiveOffset,rtl:this._rtl,debug:this.debug}),({outerContainer:e,placement:o,effectiveOffset:i,rtl:n,debug:a})=>{let{classList:l}=e;l.add(fe.base),l.toggle(fe.rtl,n),l.toggle(fe.ltr,!n),l.toggle(fe.debug,a),this.outerContainer.style.setProperty("--offset",`${i}px`),Yi(e),Ra(e,o)},Uo),Zi(()=>this.mode==="feedback",()=>{this.position=null,this._clearOverride("effectivePlacement")},Lt),St(this.outerContainer,"paste",e=>{this.emit("paste",e)}),St(this.outerContainer,["focusin","focusout"],()=>{setTimeout(()=>{this._focused=this.content?.container?.contains(document.activeElement)??!1})})])}destroy(){this.info=null,this.content=tt(this.content),this.outerContainer.remove()}get mode(){return this.content?.mode??"feedback"}get focused(){return this._focused}get visible(){return this._outerContainerStyle.display!=="none"}get contentContainer(){return this.content?.container}get effectivePlacement(){let t=this.options?.placement;return t==="auto"?"bottom-end":t??Pa}get _screenPoint(){let{inputManager:t}=this.view;return t?.multiTouchActive?null:t?.latestPointerLocation}get _effectiveOffset(){return this.options?.offset??Ia}get _outerContainerStyle(){let t=this.position??this._screenPoint;return this._lastPosition=Ho(t),t!=null&&this.content!=null?{display:"block",transform:`translate(${Math.round(t.x)}px, ${Math.round(t.y)}px)`}:{display:"none",transform:"none"}}clear(){this.info=null}enterInputMode(t){return T(this,null,function*(){let e=this.position??this._lastPosition??this._screenPoint,o=this.position=Ho(e),{effectivePlacement:i}=this;this._override("effectivePlacement",i);let n=()=>{o&&(this.position=Ea(this.contentContainer,o,this._effectiveOffset,this.view),Object.assign(this.outerContainer.style,this._outerContainerStyle))};yield this.content?.enterInputMode(t,n)})}exitInputMode(t){return T(this,null,function*(){yield this.content?.exitInputMode(t)})}onDragStart(t,e){this._prevXY=[t,e]}onDrag(t,e){let o=t-this._prevXY[0],i=e-this._prevXY[1];this._prevXY=[t,e];let{position:n}=this;if(n){let{view:a}=this,l=t-a.position[0],p=e-a.position[1];if(l<0||l>a.width||p<0||p>a.height-Oa)return;this.position=Mt(n.x+o,n.y+i)}}onDragEnd(){this._prevXY=[0,0]}};function Ea(t,e,o,i){if(!t||!i.container)return e;let n=t.getBoundingClientRect(),{left:a,top:l}=i.container.getBoundingClientRect(),{x:p,y:c}=e,m=n.left-a-o;m<0&&(p-=m);let h=n.right-a+o-i.width;h>0&&(p-=h);let y=n.top-l-o;y<0&&(c-=y);let S=n.bottom-l+o-i.height;return S>0&&(c-=S),Mt(p,c)}r([s({nonNullable:!0})],R.prototype,"view",void 0),r([s()],R.prototype,"info",void 0),r([s()],R.prototype,"options",void 0),r([s()],R.prototype,"position",void 0),r([s()],R.prototype,"content",void 0),r([s({readOnly:!0})],R.prototype,"mode",null),r([s()],R.prototype,"_focused",void 0),r([s({readOnly:!0})],R.prototype,"focused",null),r([s({readOnly:!0})],R.prototype,"outerContainer",void 0),r([s({readOnly:!0})],R.prototype,"contentContainer",null),r([s({readOnly:!0})],R.prototype,"effectivePlacement",null),r([s()],R.prototype,"debug",void 0),r([s()],R.prototype,"_lastPosition",void 0),r([s()],R.prototype,"_screenPoint",null),r([s()],R.prototype,"_rtl",void 0),r([s()],R.prototype,"_effectiveOffset",null),r([s()],R.prototype,"_outerContainerStyle",null),R=r([d("esri.views.interactive.Tooltip")],R);var Da=["top","bottom","leading","trailing"].flatMap(t=>[co(`${t}-start`),co(t),co(`${t}-end`)]);function co(t){return`${fe.base}--${t}`}function Ra({classList:t},e){Da.forEach(o=>t.remove(o)),t.add(co(e))}var gs=R;function ys(t){let e=new gs(t());return e.addHandles(F(()=>t(),({view:o,options:i,info:n})=>{e.view=o,i!==void 0&&(e.options=i),n!==void 0&&(e.info=n)})),e}function vs(t,e){let o=jo(e.vertexSpace),{scale:i,orientation:n}=t,{transform:a}=e,l=Ua(a);o&&l!=null?(n.actual=at(l,"degrees","arithmetic"),n.visible=!0):(n.actual=null,n.visible=!1),o?(i.actual=W(xs(a)),i.visible=!0):(i.actual=null,i.visible=!1)}function sf(t,e,o){if(!e||!jo(e.vertexSpace))return;let i=e.transform??=new zr;Va(t,i,o),Fa(t,i,o)}function Va(t,e,o){let i=yn(t.orientation.actual),n=_s(e.rotationAxis);if(i==null||n==null)return;let a=e.rotationAngle,l=i*n,p=(i-a)*n;a!==l&&(o?.onRotateStart(0),e.rotationAngle=l,o?.onRotate(p),o?.onRotateStop(p))}function Fa(t,e,o){let i=t.scale.actual?.value,n=xs(e);if(i==null||i===n)return;let{scale:a}=e,l;if(n===0)l=gr(vr);else{let p=i/n;l=Ot(D(),a,p)}o?.onScaleStart(a[0],a[1],a[2]),e.scale=l,o?.onScale(l[0],l[1],l[2]),o?.onScaleStop(l[0],l[1],l[2])}function af(t,e){let{x:o,y:i,z:n}=e,{x:a,y:l,z:p}=Aa(t,e.spatialReference);return{dx:a==null||Oe(a,o)?0:a-o,dy:l==null||Oe(l,i)?0:l-i,dz:p==null||n==null||Oe(p,n)?0:p-n}}function Aa(t,e){let o,i;t.geographic?(o=Q(t.longitude.actual),i=Q(t.latitude.actual),Ji(e)&&(o!=null&&i!=null?[o,i]=Me(o,i,yi):o!=null?o=Me(o,0,yi)[0]:i!=null&&(i=Me(0,i,yi)[1]))):(o=t.x.actual?.value,i=t.y.actual?.value);let n=t.elevation.actual,a=Se(e);return{x:o,y:i,z:a!=null&&n!=null?xt(n,a):void 0}}var yi=[0,0];function Ua(t){if(!t)return 0;let e=_s(t.rotationAxis);return e!=null?e*t.rotationAngle:null}function _s(t){return Qo(t,Bo)?1:Qo(t,La)?-1:null}var La=Mr(D(),Bo);function xs(t){return t?Math.max(...t.scale):1}function bs(t,e){return!(t.type!=="key-down"||t.key!==ft.enterInputMode||!e||!za(e.info))&&(e.enterInputMode(),t.preventDefault(),t.stopPropagation(),!0)}function za(t){let e=t?.sketchOptions;if(!e)return!1;let{inputEnabled:o,visibleElements:i}=e.tooltips;return o&&t.editableFields.some(({name:n})=>n==="x"||n==="y"?i.coordinates:i[n])===!0}function lf(t,e){let o=null;return Gi([t.on("paste",i=>T(this,null,function*(){o?.abort(),o=ne(()=>T(this,null,function*(){$t()||(yield he()),vi(i,t.info,e)}))})),ne(()=>he()),kt(()=>o?.abort())])}function vi(t,e,o){if(!e||!("geographic"in e))return;let i=t.clipboardData?.getData("text");if(!i)return;let n=a=>{t.stopPropagation(),t.preventDefault(),o?.onBeforePaste(),a(),o?.onAfterPaste()};if(e.geographic){let a=ls(i);a&&n(()=>{e.longitude.applyValue(a.longitude),e.latitude.applyValue(a.latitude)})}else{let a=as(i);a&&n(()=>{e.x.applyValue(a.x),e.y.applyValue(a.y)})}}var uo=class extends M{constructor(t){super(t),this.enabled=!1}};r([s({type:Boolean,nonNullable:!0})],uo.prototype,"enabled",void 0),uo=r([d("esri.views.interactive.sketch.SketchLabelOptions")],uo);var Wt=uo;var Yt=class extends M{constructor(t){super(t),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};r([s({type:String,nonNullable:!0})],Yt.prototype,"mode",void 0),Yt=r([d("esri.views.interactive.sketch.SketchTooltipElevationOptions")],Yt);var H=class extends M{constructor(t){super(t),this.area=!0,this.coordinates=!0,this.direction=!0,this.distance=!0,this.elevation=!0,this.header=!0,this.helpMessage=!1,this.orientation=!0,this.radius=!0,this.rotation=!0,this.scale=!0,this.size=!0,this.totalLength=!0}};r([s({type:Boolean,nonNullable:!0})],H.prototype,"area",void 0),r([s({type:Boolean,nonNullable:!0})],H.prototype,"coordinates",void 0),r([s({type:Boolean,nonNullable:!0})],H.prototype,"direction",void 0),r([s({type:Boolean,nonNullable:!0})],H.prototype,"distance",void 0),r([s({type:Boolean,nonNullable:!0})],H.prototype,"elevation",void 0),r([s({type:Boolean,nonNullable:!0})],H.prototype,"header",void 0),r([s({type:Boolean,nonNullable:!0})],H.prototype,"helpMessage",void 0),r([s({type:Boolean,nonNullable:!0})],H.prototype,"orientation",void 0),r([s({type:Boolean,nonNullable:!0})],H.prototype,"radius",void 0),r([s({type:Boolean,nonNullable:!0})],H.prototype,"rotation",void 0),r([s({type:Boolean,nonNullable:!0})],H.prototype,"scale",void 0),r([s({type:Boolean,nonNullable:!0})],H.prototype,"size",void 0),r([s({type:Boolean,nonNullable:!0})],H.prototype,"totalLength",void 0),H=r([d("esri.views.interactive.sketch.SketchTooltipVisibleElements")],H);var _i=H;var N=class extends M{constructor(t){super(t),this.enabled=!1,this.forceEnabled=!1,this.helpMessage=null,this.helpMessageIcon=null,this.inputEnabled=!0,this.elevation=new Yt,this.placement="auto",this.offset=null,this.visibleElements=new _i,this.visualVariables=null,this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};r([s({type:Boolean,nonNullable:!0})],N.prototype,"enabled",void 0),r([s()],N.prototype,"forceEnabled",void 0),r([s()],N.prototype,"effectiveEnabled",null),r([s()],N.prototype,"helpMessage",void 0),r([s()],N.prototype,"helpMessageIcon",void 0),r([s({type:Boolean,nonNullable:!0})],N.prototype,"inputEnabled",void 0),r([s({type:Yt,nonNullable:!0})],N.prototype,"elevation",void 0),r([s()],N.prototype,"placement",void 0),r([s()],N.prototype,"offset",void 0),r([s({type:_i,nonNullable:!0})],N.prototype,"visibleElements",void 0),r([s()],N.prototype,"visualVariables",void 0),r([s()],N.prototype,"xyMode",void 0),N=r([d("esri.views.interactive.sketch.SketchTooltipOptions")],N);var xi=N;var Xt=class extends M{constructor(t){super(t),this.length=null,this.verticalLength=null,this.area=null}};r([s()],Xt.prototype,"length",void 0),r([s()],Xt.prototype,"verticalLength",void 0),r([s()],Xt.prototype,"area",void 0),Xt=r([d("esri.views.interactive.sketch.Units")],Xt);var ge=Xt;var bt=class extends M{constructor(t){super(t),this.directionMode="relative",this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case"relative":return this.relativeDirectionIsBilateral?A.RelativeBilateral:A.Relative;case"absolute":return A.Absolute}}get displayUnits(){return this._get("displayUnits")??new ge}set displayUnits(t){this._set("displayUnits",t)}get inputUnits(){return this._get("inputUnits")??new ge}set inputUnits(t){this._set("inputUnits",t)}};r([s({type:String,nonNullable:!0})],bt.prototype,"directionMode",void 0),r([s({type:Boolean,nonNullable:!0})],bt.prototype,"relativeDirectionIsBilateral",void 0),r([s()],bt.prototype,"effectiveDirectionMode",null),r([s({type:ge,nonNullable:!0})],bt.prototype,"displayUnits",null),r([s({type:ge,nonNullable:!0})],bt.prototype,"inputUnits",null),bt=r([d("esri.views.interactive.sketch.SketchValueOptions")],bt);var bi=bt;var qt=class extends M{constructor(t){super(t),this.labels=new Wt,this.tooltips=new xi,this.values=new bi}};r([s({nonNullable:!0,type:Wt})],qt.prototype,"labels",void 0),r([s({nonNullable:!0,type:xi})],qt.prototype,"tooltips",void 0),r([s({nonNullable:!0,type:bi})],qt.prototype,"values",void 0),qt=r([d("esri.views.interactive.sketch.SketchOptions")],qt);var wi=qt;var Z;(function(t){t[t.NeverApplied=0]="NeverApplied",t[t.Applied=1]="Applied",t[t.Undone=2]="Undone"})(Z||(Z={}));var pt;(function(t){t.UndoRedoUpdating="UndoRedoUpdating",t.UndoInvalidError="UndoInvalidError",t.RedoInvalidError="RedoInvalidError",t.ApplyInvalidError="ApplyInvalidError"})(pt||(pt={}));var ho={[pt.UndoRedoUpdating]:"Cannot perform operation whilst undo redo is updating",[pt.UndoInvalidError]:"There are no items to Undo",[pt.RedoInvalidError]:"There are no items to Redo",[pt.ApplyInvalidError]:"Cannot apply an item that is already applied"},wt=class extends Error{constructor(){super(ho[pt.UndoRedoUpdating]),this.type="undo-redo-updating-error"}},Dt=class extends Error{constructor(){super(ho[pt.UndoInvalidError]),this.type="undo-redo-undo-error"}},ye=class extends Error{constructor(){super(ho[pt.RedoInvalidError]),this.type="undo-redo-redo-error"}},mo=class extends Error{constructor(){super(ho[pt.ApplyInvalidError]),this.type="undo-redo-apply-error"}};var ct;(function(t){t[t.Apply=0]="Apply",t[t.Undo=1]="Undo",t[t.Redo=2]="Redo"})(ct||(ct={}));var fo=class extends M{constructor(){super(...arguments),this.name="",this.tag=Symbol(),this.status=Z.NeverApplied}get canUndo(){return this.status===Z.Applied}get canRedo(){return this.status===Z.Undone}executeUndoRedoOperation(t){return T(this,null,function*(){switch(t){case ct.Apply:if(this.status!==Z.NeverApplied)throw new mo;return yield this.apply(),void(this.status=Z.Applied);case ct.Undo:if(this.status!==Z.Applied)throw new Dt;return yield this.undo(),void(this.status=Z.Undone);case ct.Redo:if(this.status!==Z.Undone)throw new Dt;return yield this.redo(),void(this.status=Z.Applied)}})}};r([s()],fo.prototype,"name",void 0),r([s()],fo.prototype,"tag",void 0),fo=r([d("esri.undoredo.UndoableOperation")],fo);var it=class extends M{constructor(){super(...arguments),this._stack=new Fo,this._stackPosition=-1,this._updatingHandles=new Ve}get updating(){return this._updatingHandles.updating}get canUndo(){return this.hasUndo&&!this.updating}get hasUndo(){return this._stackPosition>=0}get canRedo(){return this.hasRedo&&!this.updating}get hasRedo(){return this._stackPosition<this._stack.length-1}_truncateForwardStack(){this._stack.splice(this._stackPosition+1,this._stack.length-this._stackPosition).forEach(t=>t.destroy())}_drainStack(){this._stack.drain(t=>t.destroy()),this._stackPosition=-1}undo(){return T(this,null,function*(){if(!this.hasUndo)throw new Dt;if(this.updating)throw new wt;let t=this._stack.getItemAt(this._stackPosition);t&&(yield this._updatingHandles.addPromise(T(this,null,function*(){yield t.executeUndoRedoOperation(ct.Undo),--this._stackPosition,t.canRedo||this._truncateForwardStack()})))})}redo(){return T(this,null,function*(){if(!this.hasRedo)throw new ye;if(this.updating)throw new wt;let t=this._stack.getItemAt(this._stackPosition+1);if(!t)throw new ye;yield this._updatingHandles.addPromise(T(this,null,function*(){yield t.executeUndoRedoOperation(ct.Redo),++this._stackPosition}))})}peekUndo(){if(this.canUndo)return this._stack.getItemAt(this._stackPosition)}peekRedo(){if(this.canRedo)return this._stack.getItemAt(this._stackPosition+1)}inject(t){return T(this,null,function*(){if(this.updating)throw new wt;yield this._updatingHandles.addPromise(T(this,null,function*(){t.status===Z.NeverApplied&&(yield t.executeUndoRedoOperation(ct.Apply)),t.canUndo?(this._stack.splice(this._stackPosition+1,0,t),this._stackPosition++):this._stackPosition>-1&&(this._stack.splice(0,this._stackPosition+1).forEach(e=>e.destroy()),this._stackPosition=-1)}))})}add(t){return T(this,null,function*(){if(this.updating)throw new wt;yield this._updatingHandles.addPromise(T(this,null,function*(){t.status===Z.NeverApplied&&(yield t.executeUndoRedoOperation(ct.Apply)),this._stackPosition>=-1&&this._truncateForwardStack(),t.canUndo?(this._stack.push(t),this._stackPosition=this._stack.length-1):this._drainStack()}))})}removeTagged(t,e=!1){return T(this,null,function*(){if(this.updating&&!e)return;yield Ao(()=>!this.updating);let o=new Fo;for(let i=0;i<this._stack.length;i++){let n=this._stack.getItemAt(i);n&&(n.tag===t?(n.destroy(),i===this._stackPosition&&(this._stackPosition=o.length-1)):o.push(n))}this._stack=o,this._stackPosition>o.length-1&&(this._stackPosition=o.length-1)})}clear(t=!1){return T(this,null,function*(){if(this.updating&&!t)throw new wt;yield Ao(()=>!this.updating),this._drainStack()})}};r([s()],it.prototype,"_stack",void 0),r([s()],it.prototype,"_stackPosition",void 0),r([s()],it.prototype,"updating",null),r([s({readOnly:!0})],it.prototype,"canUndo",null),r([s({readOnly:!0})],it.prototype,"hasUndo",null),r([s({readOnly:!0})],it.prototype,"canRedo",null),r([s({readOnly:!0})],it.prototype,"hasRedo",null),it=r([d("esri.UndoRedo")],it);var go=class{constructor(){this.committedVertices=null,this.cursorVertex=null,this.full=null,this.outline=null,this.cursorEdge=null,this.circle=null,this.rectangle=null}};var Ti,Tt=Ti=class extends Gt{constructor(t){super(t),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}initialize(){let t=this.center,e=this.numberOfPoints;if(this.hasZ=t?.hasZ??!1,this.rings.length!==0||!t)return;let o=er(this.radius,this.radiusUnit,"meters"),i=t.spatialReference,n,a="geographic";if(i.isWebMercator?a="webMercator":((i.wkid&&ji[i.wkid])!=null||(i.wkt2||i.wkt)&&lr(i.wkt2||i.wkt))&&(a="projected"),this.geodesic){let l;switch(a){case"webMercator":l=cr(t);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":l=t}n=this._createGeodesicCircle(l,o,e),a==="webMercator"&&(n=pr(n))}else{let l;a==="webMercator"||a==="projected"?l=o/sr(t.spatialReference):a==="geographic"&&(l=nr(o,"meters",tr(t.spatialReference).radius)),n=this._createPlanarCircle(t,l,e)}this.spatialReference=n.spatialReference,this.addRing(n.rings[0])}clone(){let{center:t,numberOfPoints:e,radius:o,radiusUnit:i,geodesic:n}=this;return new Ti({center:t?.clone(),numberOfPoints:e,radius:o,radiusUnit:i,geodesic:n})}_createGeodesicCircle(t,e,o){let i=0,n=[];for(;i<360;){let a=[0,0],l=[t.x,t.y];nn(a,l,i,e,ht.WGS84),this.hasZ&&a.push(t.z),n.push(a),i+=360/o}return n.push(n[0]),new Gt({rings:[n]})}_createPlanarCircle(t,e,o){let i=[],n=2*Math.PI/o;for(let a=0;a<o;++a){let l=n*a,p=[t.x+Math.cos(-l)*e,t.y+Math.sin(-l)*e];this.hasZ&&p.push(t.z),i.push(p)}return i.push(i[0]),new Gt({spatialReference:t.spatialReference,rings:[i]})}};r([s({type:G})],Tt.prototype,"center",void 0),r([s()],Tt.prototype,"geodesic",void 0),r([s()],Tt.prototype,"numberOfPoints",void 0),r([s()],Tt.prototype,"radius",void 0),r([s()],Tt.prototype,"radiusUnit",void 0),Tt=Ti=r([d("esri.geometry.Circle")],Tt);var ws=Tt;function yo(t,e,o=null){return o!=null?[t,e,o]:[t,e]}function C(t,e,o=null){return o!=null?{x:t,y:e,z:o}:{x:t,y:e}}var vo=class{constructor(e){this.spatialReference=e}mapToLocalMultiple(e){return e.map(o=>this.mapToLocal(o)).filter(At)}get doUnnormalization(){return!1}},Ci=class extends vo{constructor(e,o,i=null){super(o),this._defaultZ=i,this.transform=ii(),this.transformInv=ii(),this.transform=rn(e),Vr(this.transformInv,this.transform)}makeMapPoint(e,o){return yo(e,o,this._defaultZ)}mapToLocal(e){return C(this.transform[0]*e[0]+this.transform[2]*e[1]+this.transform[4],this.transform[1]*e[0]+this.transform[3]*e[1]+this.transform[5])}localToMap(e){return yo(this.transformInv[0]*e.x+this.transformInv[2]*e.y+this.transformInv[4],this.transformInv[1]*e.x+this.transformInv[3]*e.y+this.transformInv[5],this._defaultZ)}},ki=class extends vo{constructor(e,o){super(e.spatialReference),this.view=e,this.defaultZ=null,this.pWS=D(),this.tangentFrameUpWS=D(),this.tangentFrameRightWS=D(),this.tangentFrameForwardWS=D(),this.localFrameRightWS=D(),this.localFrameUpWS=D(),this.worldToLocalTransform=Jo(),this.localToWorldTransform=Jo(),this.scale=1,this.scale=e.resolution,this.referenceMapPoint=o,this.defaultZ=o.hasZ?o.z:null;let i=e.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,Ie.X,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,Ie.Y,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,Ie.Z,this.tangentFrameForwardWS);let n=D();Ot(n,this.tangentFrameForwardWS,Or(i,this.tangentFrameForwardWS)),Re(this.localFrameRightWS,i,n),Ir(this.localFrameRightWS,this.localFrameRightWS),Pr(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),Lr(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),Ur(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return this.view.viewingMode==="global"}makeMapPoint(e,o){return yo(e,o,this.defaultZ)}mapToLocal(e){let o=D();this.view.renderCoordsHelper.toRenderCoords(new G({x:e[0],y:e[1],spatialReference:this.spatialReference}),o),qo(o,o,this.worldToLocalTransform);let i=this.view.renderCoordsHelper.fromRenderCoords(o,new G({spatialReference:this.view.spatialReference}));return i!=null?C(i.x/this.scale,i.y/this.scale):null}localToMap(e){let o=D();this.view.renderCoordsHelper.toRenderCoords(new G({x:e.x*this.scale,y:e.y*this.scale,spatialReference:this.spatialReference}),o),qo(o,o,this.localToWorldTransform);let i=this.view.renderCoordsHelper.fromRenderCoords(o,new G({spatialReference:this.view.spatialReference}));return i!=null?yo(i.x,i.y,this.defaultZ):null}};function Ts(t,e){if(t.type==="2d")return new Ci(t.state.transform,t.spatialReference,e.length>2?e[2]:null);if(t.type==="3d"){let o=e.length>2?new G({x:e[0],y:e[1],z:e[2],spatialReference:t.spatialReference}):new G({x:e[0],y:e[1],spatialReference:t.spatialReference});return new ki(t,o)}return null}function Rt(t,e){let o=new G({x:t[0],y:t[1],spatialReference:e});return t.length>2&&(o.z=t[2]),o}function Cs(t,e){return new dr({points:t,spatialReference:e})}function Si(t,e,o){let i=new fr({paths:t,spatialReference:e});return o&&Go(i),i}function jt(t,e,o,i=!0){let n=re(t);n.forEach(l=>{let p=l[0],c=l[l.length-1];Li(p,c)&&l.length!==1||l.push(l[0])});let a=new Gt({rings:n,spatialReference:e});return a.rings.forEach(l=>{mr(l)||l.reverse()}),o&&Go(a),i&&a.isSelfIntersecting&&zo(e)&&(a=Nr(a)),a}function Mi(t,e,o){let i=e.mapToLocalMultiple(t),n=[],a={x:i[0].x,y:i[0].y},l={x:i[1].x,y:i[1].y},p=Math.round(l.x-a.x),c=Math.round(l.y-a.y),m=Math.max(Math.abs(p),Math.abs(c));if(o){let h={x:a.x+m,y:a.y+m},y={x:a.x-m,y:a.y-m};n.push(C(h.x,y.y),C(y.x,y.y),C(y.x,h.y),C(h.x,h.y))}else{let h={x:p>0?a.x+m:a.x-m,y:c>0?a.y+m:a.y-m};n.push(C(a.x,a.y),C(h.x,a.y),C(h.x,h.y),C(a.x,h.y))}return Ss(jt([n.map(h=>e.localToMap(h)).filter(At)],e.spatialReference,e.doUnnormalization,!0),n,e)}function ks(t,e,o){let i=e.mapToLocalMultiple(t);if(i.length===1){let c=i[0];i=[C(c.x-48,c.y+48),C(c.x+48,c.y-48),C(c.x+48,c.y-48),C(c.x-48,c.y+48)]}let n=[],a={x:i[0].x,y:i[0].y},l={x:i[1].x,y:i[1].y};if(o){let p=Math.round(l.x-a.x),c=Math.round(l.y-a.y);n.push(C(a.x-p,a.y-c),C(l.x,a.y-c),C(l.x,l.y),C(a.x-p,l.y))}else n.push(C(a.x,a.y),C(l.x,a.y),C(l.x,l.y),C(a.x,l.y));return Ss(jt([n.map(p=>e.localToMap(p)).filter(At)],e.spatialReference,e.doUnnormalization,!0),n,e)}function Ss(t,e,o){let i=_o(e[3],e[2],o),n=_o(e[1],e[2],o),a=_o(e[0],e[1],o),l=_o(e[0],e[3],o);return{geometry:t,midpoints:i!=null&&n!=null&&a!=null&&l!=null?{top:i,right:n,bottom:a,left:l}:null}}function _o(t,e,o){Kt[0]=t.x,Kt[1]=t.y,Kt[2]=0,Qt[0]=e.x,Qt[1]=e.y,Qt[2]=0,Er(Kt,Kt,Qt,.5),xo.x=Kt[0],xo.y=Qt[1],xo.z=Qt[2];let i=o.localToMap(xo);return i!=null?Rt(i,o.spatialReference):null}var xo=C(0,0,0),Kt=D(),Qt=D();function Ii(t,e,o,i){let n=e.mapToLocalMultiple(t),a=null,l=null;if(o)a=n[0],l=n[1];else{let I=n[0],w=n[1],L=Math.round(w.x-I.x),O=Math.round(w.y-I.y),z=Math.max(Math.abs(L),Math.abs(O));a=C(L>0?I.x+z/2:I.x-z/2,O>0?I.y+z/2:I.y-z/2),l=C(Math.abs(L)>Math.abs(O)?a.x-z/2:a.x,Math.abs(L)>Math.abs(O)?a.y:a.y-z/2)}let p=e.localToMap(a),c=e.localToMap(l);if(p==null||c==null)return null;e.doUnnormalization&&hr([[p,c]],e.spatialReference);let m=Rt(p,e.spatialReference),h=Rt(c,e.spatialReference),y=le(e.spatialReference),S=0;if(zo(e.spatialReference))S=y*Hr(m,h,null);else{let I=a.x-l.x,w=a.y-l.y;S=y*Math.sqrt(I*I+w*w)*(i||1)}let g=new ws({center:m,radius:S,radiusUnit:"meters",spatialReference:e.spatialReference});return{geometry:jt(g.rings,g.spatialReference,!1),center:m,edge:h}}function Ms(t,e,o){let i=e.mapToLocalMultiple(t),n=i[0],a=i[1],l=Math.round(a.x-n.x),p=Math.round(a.y-n.y),c=C(o?n.x:n.x+l/2,o?n.y:n.y+p/2),m=o?l:l/2,h=o?p:p/2,y=60,S=[],g=2*Math.PI/y;function I(rt){let da=Math.cos(rt),ma=Math.sin(rt);return C(m*da+c.x,h*ma+c.y)}for(let rt=0;rt<y;rt++)S.push(I(rt*g));S.push(S[0]);let{spatialReference:w,doUnnormalization:L}=e,O=jt([S.map(rt=>e.localToMap(rt)).filter(At)],w,L,!1),z=e.localToMap(I(Math.PI/2)),oe=e.localToMap(I(0)),ie=e.localToMap(I(-Math.PI/2)),Te=e.localToMap(I(Math.PI));return{geometry:O,midpoints:z!=null&&oe!=null&&ie!=null&&Te!=null?{top:Rt(z,w),right:Rt(oe,w),bottom:Rt(ie,w),left:Rt(Te,w)}:null}}function bo(t,e){switch(t){case"point":case"multipoint":return Ga();case"polyline":return Ha(e);case"polygon":return Na(e);default:return}}function Ga(t){return"point"}function Ha(t){return(t!=null&&t.type==="polyline"&&t.paths.length?t.paths[0].length:0)<2?"polylineZeroVertices":"polylineOneVertex"}function Na(t){let e=t!=null&&t.type==="polygon"&&t.rings.length?t.rings[0].length:0;return e<3?"polylineZeroVertices":e<4?"polygonOneVertex":"polygonTwoVertices"}function Is(t,e){let o=t?.geometry;if(!t||o?.type!=="mesh"||!e)return;let{renderCoordsHelper:i,elevationProvider:n}=e,{camera:a}=e.state,{extent:l}=o,{center:p,spatialReference:c}=l,m=le(c),h=ae(c),y=le(i.spatialReference),S=l.width*m,g=l.height*h,I=(l.zmax??0)*h,w=I-(l.zmin??0)*h,L=Math.max(S,g,w)/y,{x:O,y:z}=p,oe=p.z??0;kr(wo,O,z,oe),i.toRenderCoords(wo,c,wo);let ie=L/a.computeScreenPixelSizeAt(wo);if(ie>a.width*Ba)return"meshTooClose";if(ie<Za)return"meshTooFar";let Te=Yr(t),{absoluteZ:rt}=qr(O,z,I,c,e,Te);return rt<(n.getElevation(O,z,oe,c,"ground")??0)*h+w*$a?"meshUnderground":"mesh"}var Za=20,Ba=1,$a=.1,wo=D();function Ps(t,e,o,i,n,a){let l="geodesic",p=sn(o),c=Pt();return Le(t,e,i,c),c[2]=0,p&&ce(c,o,c,p)||(l="euclidean",p=o),{mode:l,view:e,elevationInfo:i,hasZ:n,directionMode:a,spatialReference:t.spatialReference,measurementSR:p,origin:c}}function Wa(t,e,o){if(e==null||t==null)return;let i=ar(o.measurementSR);if(i==null)return;let n=_e(t,o);if(n==null)return;let a=xt(e,i);return new cn(n,a)}function Ya(t,e,o,i){if(o==null||t==null)return;let n=_e(t,i);if(n==null)return;let a=Q(o),l=10,p=m=>{if(m==null)return;let h=Pt(),y=at(m,"degrees","geographic");return gn(h,n,i.measurementSR,l,y,i.mode)?new dn(n,h):void 0},c=()=>{if(e!=null&&t!=null)return Q(si(e,t))};switch(i.directionMode){case A.Absolute:return p(a);case A.Relative:{let m=c();return m==null?void 0:p(m+a)}case A.RelativeBilateral:{let m=c();return m==null?void 0:ni([p(m+a),p(m-a)])}}}function Es(t,e){let o=Co(t,e);return o!=null?new un(o):void 0}function Ds(t,e,o){let{context:i,longitude:n,latitude:a,direction:l,distance:p,elevation:c}=o;if(n!=null||a!=null||p!=null||c!=null||l!=null){if(n!=null||a!=null){let m=Q(n),h=Q(a),y=Co(c,i);return new ri(m,h,y)}return Xa(t,e,o)}}function Xa(t,e,{context:o,direction:i,distance:n,elevation:a}){if(e==null)return Es(a,o);let{view:l,elevationInfo:p,measurementSR:c}=o,m=Le(e,l,p);if(!c||!ce(m,e.spatialReference,Os,c))return;let[h,y]=Os,S=n!=null?xt(n,"meters"):void 0,g=Q(i),I=Co(a,o),w=O=>{let z=new mn([h,y],c,S,I,O);return S==null||O==null||I==null&&o.hasZ?z:new pn(z.closestTo(m))};if(g==null)return w(void 0);let L=()=>{if(t!=null&&e!=null)return Q(si(t,e))};switch(o.directionMode){case A.Absolute:return w(g);case A.Relative:{let O=L();return O==null?void 0:w(O+g)}case A.RelativeBilateral:{let O=L();return O==null?void 0:ni([w(O+g),w(O-g)])}}}function Rs(t){return t.context.mode==="geodesic"?Ds(null,null,t):Fs(t)}function Vs(t,e,o){let{context:i,x:n,y:a,distance:l,direction:p,elevation:c}=o;return i.mode==="geodesic"?Ds(e,t,o):n!=null||a!=null?Fs(o):qa([Wa(t,l,i),Ya(t,e,p,i),Es(c,i)])}function Fs({x:t,y:e,elevation:o,context:i}){To.x=t?.value??0,To.y=e?.value??0,To.spatialReference=i.spatialReference;let n=_e(To,i,Qa);return new ri(t!=null&&n!=null?n[0]:void 0,e!=null&&n!=null?n[1]:void 0,Co(o,i))}function qa(t){let e;for(let o of t)o&&(e=e?.intersect(o)??o);return e}function _e(t,e,o=Pt()){let{view:i,elevationInfo:n,measurementSR:a,origin:l,mode:p}=e;if(Le(t,i,n,o),ce(o,t.spatialReference,o,a))return p!=="geodesic"&&Re(o,o,l),o}function As(t,e,o,i){let{view:n,measurementSR:a,spatialReference:l,origin:p,mode:c}=o;if(c==="geodesic"?Cr(ve,t):De(ve,t,p),ce(ve,a,ve,l))return ln(ve,n,e,o,i)}function Co(t,e){return Ka(t,e)?.value??void 0}function Ka(t,{view:e,origin:o,elevationInfo:i,hasZ:n,measurementSR:a}){if(t==null||!n)return;let l=Se(a);if(l==null)return;let[p,c]=o,m=xt(t,l),h=e?.type==="3d"?Ae(e,p,c,m,a,i):m;return h!=null?et(h,l):void 0}var Os=Pt(),Qa=Pt(),ve=Pt(),To=pe(0,0,0,ht.WGS84);var V=class extends M{constructor(t){super(t),this.helpMessage=void 0,this.viewType=void 0}get visibleElements(){return this.sketchOptions.tooltips.visibleElements}get allFields(){return[]}get editableFields(){return this.allFields.filter(t=>t.visible&&!t.readOnly)}clearInputValues(){this.allFields.forEach(t=>t.clearInputValue())}};r([s()],V.prototype,"sketchOptions",void 0),r([s()],V.prototype,"visibleElements",null),r([s()],V.prototype,"helpMessage",void 0),r([s()],V.prototype,"viewType",void 0),r([s()],V.prototype,"allFields",null),r([s()],V.prototype,"editableFields",null),V=r([d("esri.views.interactive.tooltip.infos.SketchTooltipInfo")],V);var ut=class extends V{constructor(t){super(t),this.type="draw-circle",this.radius=null,this.xSize=null,this.ySize=null,this.area=lt}get allFields(){return[]}};r([s()],ut.prototype,"type",void 0),r([s()],ut.prototype,"radius",void 0),r([s()],ut.prototype,"xSize",void 0),r([s()],ut.prototype,"ySize",void 0),r([s()],ut.prototype,"area",void 0),r([s()],ut.prototype,"allFields",null),ut=r([d("esri.views.interactive.tooltip.infos.DrawCircleTooltipInfo")],ut);var _=class extends M{constructor(t){super(t),this.actual=null,this.lockable=!0,this.id=Bi(),this.inputValue=null,this.readOnly=!1,this.suffix=null,this.visible=!0,this.invalid=!1,this.unlockOnVertexPlacement=!0}get committed(){return this.lockable?this._get("committed"):null}set committed(t){this.lockable&&this._set("committed",t)}get dirty(){return this.inputValue!=null}get locked(){return this.lockable&&this.committed!=null}onInput(t){this.inputValue=t}onCommit(t,e,o){this.lockable?this._onCommitLockable(t,o):this._onCommitNonLockable(o),this.invalid&&t==="commit-and-exit"||o.onCommit(e,t)}_onCommitLockable(t,e){let{inputValue:o,locked:i}=this;i&&ko(o)?this.unlock():(t==="commit-and-exit"&&!i||o!=null)&&this._parseInputAndLock(e)}_onCommitNonLockable(t){let{inputValue:e}=this;ko(e)?this.setActual(null):e!=null&&this._parseInputAndSetActual(t)}applyValue(t){this.lockable?this.lock(t):this.setActual(t)}clearInputValue(){this.inputValue=null,this.invalid=!1}setActual(t){this.actual=t,this.clearInputValue()}lock(t){this.lockable&&(this.committed=t??this.actual,this.clearInputValue())}unlock(){this.lockable&&(this.committed=null,this.clearInputValue())}toggleLock(t){this.lockable&&(this.locked?this.unlock():this._parseInputAndLock(t))}getSuffix(t){let{suffix:e}=this;return typeof e=="function"?e(t):e}getFormattedValue(t){let{actual:e,committed:o,format:i}=this;return o!=null?i(o,t):e!=null?i(e,t):null}getRawDisplayValue(t){let{actual:e,committed:o,inputValue:i}=this;return i??(this.lockable&&o!=null?this.formatForInputMode(o,t):e!=null?this.formatForInputMode(e,t):null)}_parseInputAndSetActual(t){let{inputValue:e}=this;if(e==null||ko(e))return this.setActual(null);let o=this.parse(e,t);o!=null?this.setActual(o):this.invalid=!0}_parseInputAndLock(t){let{inputValue:e,actual:o}=this;if(ko(e))return this.unlock();if(e==null)return this.lock(o);let i=this.parse(e,t);i!=null?this.lock(i):this.invalid=!0}};function ko(t){return t!=null&&t.trim()===""}r([s()],_.prototype,"actual",void 0),r([s()],_.prototype,"committed",null),r([s()],_.prototype,"dirty",null),r([s()],_.prototype,"format",void 0),r([s()],_.prototype,"formatForInputMode",void 0),r([s()],_.prototype,"lockable",void 0),r([s()],_.prototype,"locked",null),r([s()],_.prototype,"id",void 0),r([s()],_.prototype,"inputValue",void 0),r([s()],_.prototype,"name",void 0),r([s()],_.prototype,"parse",void 0),r([s()],_.prototype,"readOnly",void 0),r([s()],_.prototype,"suffix",void 0),r([s()],_.prototype,"title",void 0),r([s()],_.prototype,"visible",void 0),r([s()],_.prototype,"invalid",void 0),r([s()],_.prototype,"unlockOnVertexPlacement",void 0),_=r([d("esri.views.interactive.tooltip.fields.TooltipField")],_);var xe=class extends _{constructor(t){super(t),this.showAsZ=!1}normalizeCtorArgs(t){let e=o=>o.inputUnitInfos.verticalLength.unit;return x({name:"elevation",actual:Y,parse:X({createQuantity:(o,i)=>et(o,e(i))}),format:(o,i)=>i.formatters.verticalLength(o),formatForInputMode:(o,i)=>i.formatters.scalar(ot(o,e(i))),suffix:o=>o.inputUnitInfos.verticalLength.abbreviation,title:o=>o.messages.sketch[this.showAsZ?"z":"elevation"],unlockOnVertexPlacement:!1},t)}};r([s()],xe.prototype,"showAsZ",void 0),xe=r([d("esri.views.interactive.tooltip.fields.TooltipFieldElevation")],xe);var be=class extends _{constructor(t){super(t),this.precision=1}normalizeCtorArgs(t){let e=o=>o.inputUnitInfos.angle.unit;return x({name:"orientation",actual:null,parse:X({createQuantity:(o,i)=>at(o,e(i),"geographic"),sanitize:Be}),format:o=>{let i=li(o);return Zt(i,"geographic",this.precision)},formatForInputMode:(o,i)=>{let n=li(o);return i.formatters.scalar(n)},suffix:o=>o.inputUnitInfos.angle.abbreviation,title:o=>o.messages.sketch.orientation},t)}};r([s()],be.prototype,"precision",void 0),be=r([d("esri.views.interactive.tooltip.fields.TooltipFieldOrientation")],be);var we=class extends _{constructor(t){super(t),this.precision=null}normalizeCtorArgs(t){let e=o=>o.inputUnitInfos.length.unit;return x({name:"size",actual:null,parse:X({createQuantity:(o,i)=>et(o,e(i))}),format:(o,i)=>i.formatters.length(o),formatForInputMode:(o,i)=>i.formatters.scalar(ot(o,e(i))),suffix:o=>o.inputUnitInfos.length.abbreviation,title:o=>o.messages.sketch.size},t)}};r([s()],we.prototype,"precision",void 0),we=r([d("esri.views.interactive.tooltip.fields.TooltipFieldSize")],we);function So(t){let e=i=>i.inputUnitInfos.angle.unit,o=i=>i.sketchOptions.values.effectiveDirectionMode;return new _(x({name:"direction",actual:Ue,parse:X({createQuantity:(i,n)=>at(i,e(n),"geographic"),sanitize:Be}),format:(i,n)=>{let a=o(n),l=ai(i,a);switch(a){case A.Absolute:return n.formatters.direction(l);case A.Relative:return n.formatters.directionRelative(l);case A.RelativeBilateral:return n.formatters.directionRelativeBilateral(l)}},formatForInputMode:(i,n)=>{let a=ai(i,o(n));return n.formatters.scalar(ot(a,e(n)))},suffix:i=>i.inputUnitInfos.angle.abbreviation,title:i=>{let n=o(i),{absolute:a,relative:l}=i.messages.sketch.direction;switch(n){case A.Absolute:return a;case A.Relative:case A.RelativeBilateral:return l}}},t))}function Oi(t){let e=o=>o.inputUnitInfos.length.unit;return new _(x({name:"distance",actual:Y,parse:X({createQuantity:(o,i)=>et(Math.max(o,0),e(i))}),format:(o,i)=>i.formatters.length(o),formatForInputMode:(o,i)=>i.formatters.scalar(ot(o,e(i))),suffix:o=>o.inputUnitInfos.length.abbreviation,title:o=>o.messages.sketch.distance},t))}function Us(t){return Oi(x({format:(e,o)=>o.formatters.totalLength(e),title:e=>e.messages.sketch.totalLength,readOnly:!0},t))}function Mo(t){return Oi(x({},t))}function D_(t){let e=o=>o.inputUnitInfos.length.unit;return Oi(dt(x({},t),{parse:X({createQuantity:(o,i)=>et(o,e(i))}),format:(o,i)=>i.formatters.lengthRelative(o)}))}function Ls(t){return new xe(t)}function zs(t){return new be(t)}function R_(t){return new we(t)}function Gs(t){return Pi("scale",x({name:"scale",actual:null,parse:X({createQuantity:e=>W(Math.abs(e))})},t))}function Hs(t){let e=o=>o.inputUnitInfos.area.unit;return new _(x({name:"area",actual:lt,parse:X({createQuantity:(o,i)=>jr(o,e(i))}),format:(o,i)=>i.formatters.area(o),formatForInputMode:(o,i)=>i.formatters.scalar(ot(o,e(i))),suffix:o=>o.inputUnitInfos.area.abbreviation,title:o=>o.messages.sketch.area,readOnly:!0},t))}function Ns(t){return new _(x({name:"x",actual:Ue,parse:ps,format:(e,o)=>o.formatters.longitudeDecimalDegrees(e),formatForInputMode:e=>es(e),suffix:e=>e.inputUnitInfos.angle.abbreviation,title:e=>e.messages.sketch.longitude},t))}function Zs(t){return new _(x({name:"y",actual:Ue,parse:cs,format:(e,o)=>o.formatters.latitudeDecimalDegrees(e),formatForInputMode:e=>os(e),suffix:e=>e.inputUnitInfos.angle.abbreviation,title:e=>e.messages.sketch.latitude},t))}function Bs(t){return Pi("x",x({name:"x"},t))}function $s(t){return Pi("y",x({name:"y"},t))}function Pi(t,e){return new _(x({actual:W(0),parse:X({createQuantity:o=>W(o)}),format:(o,i)=>i.formatters.scalar(o),formatForInputMode:(o,i)=>i.formatters.scalar(o),title:o=>o.messages.sketch[t]},e))}var Ct=t=>{let e=class extends t{constructor(){super(...arguments),this.longitude=Ns(),this.latitude=Zs(),this.x=Bs(),this.y=$s(),this.elevation=Ls(),this.geographic=!1}get effectiveX(){return this.geographic?this.longitude:this.x}get effectiveY(){return this.geographic?this.latitude:this.y}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic}}setLocationFromPoint(o,i=o?.spatialReference){if(this.geographic=!!i&&wn(i),o==null)return this._setActualLonLat(null,null),void this._setActualXY(null,null);if(this.geographic){let n=ur(o,ja);this._setActualLonLat(Et(n?.[0]),Et(n?.[1]))}else this._setActualXY(W(o.x),W(o.y))}_setActualLonLat(o,i){this.longitude.actual=o,this.latitude.actual=i}_setActualXY(o,i){this.x.actual=o,this.y.actual=i}};return r([s()],e.prototype,"geographic",void 0),r([s()],e.prototype,"effectiveX",null),r([s()],e.prototype,"effectiveY",null),r([s()],e.prototype,"key",null),e=r([d("esri.views.interactive.tooltip.infos.TooltipInfoWithCoordinates")],e),e},ja=[0,0];var Jt=class extends Ct(V){constructor(t){super(t),this.type="draw-mesh",this.orientation=zs({lockable:!1}),this.scale=Gs({lockable:!1})}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,this.orientation,this.scale]}};r([s()],Jt.prototype,"helpMessage",void 0),r([s()],Jt.prototype,"allFields",null),Jt=r([d("esri.views.interactive.tooltip.infos.DrawMeshTooltipInfo")],Jt);var te=class extends Ct(V){constructor(t){super(t),this.type="draw-point"}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation]}};r([s()],te.prototype,"helpMessage",void 0),r([s()],te.prototype,"allFields",null),te=r([d("esri.views.interactive.tooltip.infos.DrawPointTooltipInfo")],te);var Vt=class extends Ct(V){constructor(t){super(t),this.type="draw-polygon",this.direction=So(),this.distance=Mo(),this.area=Hs(),this.xyMode="direction-distance"}get allFields(){return[this.direction,this.distance,this.longitude,this.latitude,this.x,this.y,this.elevation,this.area]}};r([s()],Vt.prototype,"xyMode",void 0),r([s()],Vt.prototype,"helpMessage",void 0),r([s()],Vt.prototype,"allFields",null),Vt=r([d("esri.views.interactive.tooltip.infos.DrawPolygonTooltipInfo")],Vt);var Ft=class extends Ct(V){constructor(t){super(t),this.type="draw-polyline",this.direction=So(),this.distance=Mo(),this.totalLength=Us(),this.xyMode="direction-distance"}get allFields(){return[this.direction,this.distance,this.longitude,this.latitude,this.x,this.y,this.elevation,this.totalLength]}};r([s()],Ft.prototype,"helpMessage",void 0),r([s()],Ft.prototype,"xyMode",void 0),r([s()],Ft.prototype,"allFields",null),Ft=r([d("esri.views.interactive.tooltip.infos.DrawPolylineTooltipInfo")],Ft);var yt=class extends V{constructor(t){super(t),this.type="draw-rectangle",this.xSize=Y,this.ySize=Y,this.area=lt}get allFields(){return[]}};r([s()],yt.prototype,"type",void 0),r([s()],yt.prototype,"xSize",void 0),r([s()],yt.prototype,"ySize",void 0),r([s()],yt.prototype,"area",void 0),r([s()],yt.prototype,"allFields",null),yt=r([d("esri.views.interactive.tooltip.infos.DrawRectangleTooltipInfo")],yt);function Ja(t,e,o=ui()){if(e==="on-the-ground"){let i=kn(t);return i??Cn(t,o)}return Tn(t,o)}function Ei(t,e=ui()){return Ja(t,"on-the-ground",e)}function Ws(t,e){return{point:new te({sketchOptions:e,viewType:t}),polyline:new Ft({sketchOptions:e,viewType:t}),polygon:new Vt({sketchOptions:e,viewType:t}),mesh:new Jt({sketchOptions:e,viewType:t}),rectangle:new yt({sketchOptions:e}),circle:new ut({sketchOptions:e})}}function Di(t){let{directionOptions:e,geometryType:o,sketchOptions:i,tooltipInfos:n}=t,a=p=>{let c=Oo(t).mode,m=n[p].elevation;c==="relative-to-ground"||c==="relative-to-scene"||c==="on-the-ground"?m.lock(Vi(t)):m.unlock()},l=p=>{if(e){let c=n[p].direction;c.committed=e.angle,c.unlockOnVertexPlacement=!1,i.values.directionMode=e.mode}};switch(o){case"polygon":case"polyline":a(o),l(o);break;case"point":case"mesh":a(o)}}function Ys(t,e){let{drawOperation:o,view:i}=e,n=Io(e),a=Oo(e);if(i.type==="2d"||!t||a.mode!=="absolute-height"||o?.numCommittedVertices!==1||!n||n.type!=="draw-polyline"&&n.type!=="draw-polygon"||n.elevation.locked)return;let[l,p,c]=t,m=pl(l,p,c,a,e);m!=null&&n.elevation.lock(m)}function Ri(t){Io(t)?.allFields.forEach(e=>{e.unlockOnVertexPlacement&&e.unlock()})}function Io({geometryType:t,graphic:e,tooltipInfos:o}){return t==="multipoint"||e?.geometry?.type!==tl[t]?null:o[t]}var tl={point:"point",mesh:"mesh",polyline:"polyline",polygon:"polygon",circle:"polygon",rectangle:"polygon"};function Xs(t,e){switch(t?.type){case"draw-point":el(t,e);break;case"draw-polyline":il(t,e);break;case"draw-polygon":rl(t,e);break;case"draw-rectangle":sl(t,e);break;case"draw-circle":al(t,e);break;case"draw-mesh":ol(t,e)}}function el(t,e){let o=e.graphic?.geometry;o?.type==="point"&&(qs(t,o,e),t.helpMessage=bo("point",o))}function ol(t,e){let{graphic:o,view:i}=e,n=o?.geometry;i.type!=="3d"||n&&n.type!=="mesh"||(qs(t,n?.origin,e),n&&vs(t,n),t.helpMessage=Is(o,i))}function qs(t,e,o){let{drawOperation:i,view:n,sketchOptions:a}=o,{cursorVertex:l}=i;if(t.sketchOptions=a,t.viewType=n.type,t.setLocationFromPoint(e,ee(o)),Qs(t.elevation,o),!l)return void(i.constraints=void 0);let p=l;i.constraints={context:oa(p,o),x:t.x.committed,y:t.y.committed,longitude:t.longitude.committed,latitude:t.latitude.committed,elevation:t.elevation.committed,distance:null,direction:null}}function il(t,e){let{createOperationGeometry:o,drawOperation:i}=e,n=o!=null?o.full:null;n&&n.type!=="polyline"||(Ks(t,e),t.totalLength.actual=i.lastVertex?(n?In(n):null)??Y:null,t.helpMessage=bo("polyline",n))}function rl(t,e){let{createOperationGeometry:o,drawOperation:i}=e,n=o!=null?o.full:null;n&&n.type!=="polygon"||(Ks(t,e),t.area.actual=i.lastVertex?(n?Ei(n):null)??lt:null,t.helpMessage=bo("polygon",n))}function Ks(t,e){let{drawOperation:o,sketchOptions:i,view:n}=e,{cursorVertex:a,lastVertex:l,secondToLastVertex:p}=o,c=i.values.effectiveDirectionMode;t.sketchOptions=i,t.viewType=n.type;let m=l&&a?me(l,a)??Y:null;if(t.distance.actual=m,t.distance.readOnly=l==null,t.direction.actual=null,t.direction.readOnly=!0,l&&a&&(c==="absolute"||p)){let S=fn(p,l,a,c);t.direction.actual=S??Jr,t.direction.readOnly=!1}t.setLocationFromPoint(a,ee(e)),Qs(t.elevation,e);let h=nl(l,e);t.xyMode=h,t.direction.visible=h==="direction-distance",t.distance.visible=h==="direction-distance",t.effectiveX.visible=h==="coordinates",t.effectiveY.visible=h==="coordinates";let y=a??l;o.constraints=y?{context:oa(y,e),x:t.x.committed,y:t.y.committed,longitude:t.longitude.committed,latitude:t.latitude.committed,elevation:t.elevation.committed,distance:t.distance.committed,direction:t.direction.committed}:void 0}function nl(t,{sketchOptions:e}){let o=e.tooltips.xyMode;return o==="auto"?t?"direction-distance":"coordinates":o}function sl(t,e){t.sketchOptions=e.sketchOptions,t.xSize=Js(e),t.ySize=ta(e),t.area=js(e)}function al(t,e){let{forceUniformSize:o,sketchOptions:i}=e;t.sketchOptions=i,t.radius=o?ll(e):null,t.xSize=o?null:Js(e),t.ySize=o?null:ta(e),t.area=js(e)}function Qs(t,e){let{drawOperation:o}=e,i=o?.cursorVertex??o?.lastVertex;t.actual=Sn(i)??Vi(e),t.visible=o.hasZ,t.readOnly=!1,t.showAsZ=!0}function js(t){let e=t.createOperationGeometry?.full;return e?.type!=="polygon"?lt:Ei(e)??lt}function Js(t){let e=t.createOperationGeometry?.rectangle?.midpoints;return(e!=null?me(e.left,e.right):null)??Y}function ta(t){let e=t.createOperationGeometry?.rectangle?.midpoints;return(e!=null?me(e.top,e.bottom):null)??Y}function ll({createOperationGeometry:t}){return(t?.circle?.center!=null&&t.circle.edge!=null?me(t.circle.center,t.circle.edge):null)??Y}function ea(t){let{geometryType:e,tooltipInfos:o}=t;switch(e){case"point":case"mesh":case"polyline":case"polygon":{let i=o[e].elevation.committed;return i?xt(i,"meters")/ae(ee(t)):void 0}default:return}}function pl(t,e,o,i,n){let{view:a,drawOperation:l}=n;if(a.type!=="3d"||!l)return;o??=0;let p=ee(n),c=Oo(n),m=Ae(a,t,e,o,p,c,i);return Mn(m,p)??Vi(n)}function Oo(t){return t.drawOperation.elevationInfo??Kr}function ee(t){return t.drawOperation.coordinateHelper.spatialReference}function Vi(t){let e=ae(ee(t));return et(t.defaultZ*e,"meters")}function oa(t,e){return Ps(t,e.view,ee(e),Oo(e),e.drawOperation.coordinateHelper.hasZ(),e.sketchOptions.values.effectiveDirectionMode)}var k=class extends nt.EventedMixin(On){constructor(t){super(t),this._graphic=null,this._coordinateFormatterLoadTask=null,this._createOperationGeometry=null,this.defaultZ=0,this.directionOptions=null,this.geometryType=null,this.hasZ=!0,this.geometryToPlace=null,this.snappingManager=null,this.snapToScene=!1,this.sketchOptions=new wi}initialize(){let{view:t}=this;this.internalGraphicsLayer=new Qr({listMode:"hide",internal:!0}),this.view.map.layers.add(this.internalGraphicsLayer);let e=this.drawOperation=this.makeDrawOperation();this.tooltipInfos=Ws(t.type,this.sketchOptions);let o=ys(()=>({view:t,options:this.sketchOptions.tooltips}));this.tooltip=o,Di(this._tooltipsContext),this._coordinateFormatterLoadTask=ne(()=>he()),this.addHandles([e.on("vertex-add",i=>this.onVertexAdd(i)),e.on("vertex-remove",i=>this.onVertexRemove(i)),e.on("vertex-update",i=>this.onVertexUpdate(i)),e.on("cursor-update",i=>this.onCursorUpdate(i)),e.on("cursor-remove",()=>this._updateGraphic()),e.on("complete",i=>this.onComplete(i)),this._coordinateFormatterLoadTask,o.on("paste",i=>vi(i,this.activeTooltipInfo)),F(()=>this.cursor,i=>{e.cursor=i},mt),Vo(()=>{let{activeTooltipInfo:i,sketchOptions:n}=this;Xs(i,this._tooltipsContext),o.info=n.tooltips.effectiveEnabled?i:null}),Vo(()=>{e.constraintZ=ea(this._tooltipsContext)},Lt)]),this.finishToolCreation()}destroy(){this.drawOperation=tt(this.drawOperation),this.tooltip=tt(this.tooltip),this._destroyAllVisualizations(),this.view.map.remove(this.internalGraphicsLayer),this.internalGraphicsLayer=tt(this.internalGraphicsLayer),this._set("view",null)}get _drawSpatialReference(){return this.drawOperation.coordinateHelper.spatialReference}get _tooltipsContext(){return{createOperationGeometry:this._createOperationGeometry,defaultZ:this.defaultZ,directionOptions:this.directionOptions,drawOperation:this.drawOperation,forceUniformSize:this.forceUniformSize,geometryType:this.geometryType,graphic:this.graphic,sketchOptions:this.sketchOptions,tooltipInfos:this.tooltipInfos,view:this.view}}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centered(t){this._set("centered",t),this._updateGraphic()}get cursor(){return this._get("cursor")}set cursor(t){this._set("cursor",t)}set enabled(t){this.drawOperation.interactive=t,this._set("enabled",t)}set forceUniformSize(t){this._set("forceUniformSize",t),this._updateGraphic()}get graphic(){return this._graphic}set graphicSymbol(t){this._set("graphicSymbol",t),this._graphic!=null&&(this._graphic.symbol=t)}set mode(t){let e=this.drawOperation;e&&(e.drawingMode=t),this._set("mode",t)}get updating(){return this.drawOperation?.updating??!1}get undoRedo(){let{view:{type:t,map:e}}=this;return t==="2d"&&e&&"undoRedo"in e&&e.undoRedo instanceof it?e.undoRedo:null}set undoRedo(t){this._override("undoRedo",t)}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(t){this.destroyed||bs(t,this.tooltip)||this.drawOperation.onInputEvent(t)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo(),this.drawOperation.numCommittedVertices===0&&Di(this._tooltipsContext)}_destroyAllVisualizations(){this.removeHandles(J.outline),this.removeHandles(J.regularVertices),this.removeHandles(J.activeVertex),this.removeHandles(J.activeEdge),this.removeHandles(Fi)}_createOrUpdateGraphic(t){if(this._graphic!=null)return this.updateGraphicGeometry(t),this._graphic;let e=new Ar(dt(x({},this.graphicProperties),{symbol:this.graphicSymbol}));return this._graphic=e,this.updateGraphicGeometry(t),this.internalGraphicsLayer.add(e),this.addHandles(this.initializeGraphic(e)),this.notifyChange("graphic"),this.addHandles(kt(()=>{this.internalGraphicsLayer.remove(e),this._graphic===e&&(this._graphic=null)}),Fi),e}updateGraphicGeometry(t){this._graphic.geometry=t}_getCreateOperationGeometry(t={operationComplete:!1}){if(this.drawOperation==null)return;let{coordinateHelper:e,view:o,visualizationCursorVertex:i,lastVertex:n,committedVertices:a,geometryIncludingUncommittedVertices:l,numCommittedVertices:p}=this.drawOperation;if(!(p>0||i!=null))return;let c=t.operationComplete?a:l,m=c.length,h=i!=null?e.pointToArray(i):null,y=this._drawSpatialReference,S=o.type==="3d"&&o.viewingMode==="global",g=new go;g.committedVertices=a,g.cursorVertex=h;let{geometryType:I}=this;switch(I){case"point":case"mesh":g.full=e.arrayToPoint(c[0]);break;case"multipoint":g.full=m>0?Cs(c,y):null;break;case"polyline":case"polygon":m>0&&(g.full=I==="polygon"?jt([c],y,S,!0):Si([c],y,S),g.cursorEdge=h!=null&&n&&!Ht(i,n)?Si([[h,e.pointToArray(n)]],y,S):null,g.outline=m>1?g.full:null);break;case"circle":case"rectangle":{if(g.committedVertices=g.cursorVertex=null,!m)break;let w=Ts(o,c[0]),L=c[0],O=w.makeMapPoint(L[0]+cl*o.resolution,L[1]);I==="circle"?m===1&&t.operationComplete?g.circle=Ii([L,O],w,!0):m===2&&(this.forceUniformSize?g.circle=Ii(c,w,this.centered):g.rectangle=Ms(c,w,this.centered)):m===1&&t.operationComplete?g.rectangle=Mi([L,O],w,!0):m===2&&(g.rectangle=this.forceUniformSize?Mi(c,w,this.centered):ks(c,w,this.centered)),g.full=g.circle!=null?g.circle.geometry:g.rectangle?.geometry,g.outline=g.full?.type==="polygon"?g.full:null;break}default:return null}return g}initializeGraphic(t){return kt()}onComplete(t){if(!this.drawOperation)return;this._updateGraphic();let e=null;if(this.drawOperation.isCompleted){let o=this._getCreateOperationGeometry({operationComplete:!0});o!=null&&(e=this._createOrUpdateGraphic(o.full))}this._createOperationGeometry=null,this.emit("complete",x({graphic:e},t))}onCursorUpdate(t){this._updateGraphic(),this.emit("cursor-update",t)}onDeactivate(){let{drawOperation:t}=this;t&&(t.isCompleted||t.cancel())}onOutlineChanged(t){return kt()}onCursorEdgeChanged(t){return kt()}onVertexAdd(t){Ri(this._tooltipsContext),this._updateGraphic(),Ys(t.vertices.at(0)?.coordinates,this._tooltipsContext),this.emit("vertex-add",t)}onVertexRemove(t){Ri(this._tooltipsContext),this._updateGraphic(),this.emit("vertex-remove",t)}onVertexUpdate(t){this._updateGraphic(),this.emit("vertex-update",t)}_updateGraphic(){let t=this._getCreateOperationGeometry();this._createOperationGeometry=t,t!=null?(t.cursorEdge!=null?this.addHandles(this.onCursorEdgeChanged(t.cursorEdge),J.activeEdge):this.removeHandles(J.activeEdge),t.outline!=null?this.addHandles(this.onOutlineChanged(t.outline),J.outline):this.removeHandles(J.outline),t.committedVertices!=null?this.addHandles(this.onRegularVerticesChanged(t.committedVertices),J.regularVertices):this.removeHandles(J.regularVertices),t.cursorVertex!=null?this.addHandles(this.onActiveVertexChanged(t.cursorVertex),J.activeVertex):this.removeHandles(J.activeVertex),t.full!=null?this._createOrUpdateGraphic(t.full):this.removeHandles(Fi)):this._destroyAllVisualizations()}get activeTooltipInfo(){return this._coordinateFormatterLoadTask?.finished?Io(this._tooltipsContext):null}};r([s()],k.prototype,"_coordinateFormatterLoadTask",void 0),r([s()],k.prototype,"_createOperationGeometry",void 0),r([s()],k.prototype,"_tooltipsContext",null),r([s({value:!0})],k.prototype,"centered",null),r([s()],k.prototype,"cursor",null),r([s({nonNullable:!0})],k.prototype,"defaultZ",void 0),r([s({constructOnly:!0})],k.prototype,"directionOptions",void 0),r([s()],k.prototype,"drawOperation",void 0),r([s({value:!0})],k.prototype,"enabled",null),r([s({value:!0})],k.prototype,"forceUniformSize",null),r([s({constructOnly:!0})],k.prototype,"geometryType",void 0),r([s()],k.prototype,"graphic",null),r([s({constructOnly:!0})],k.prototype,"graphicProperties",void 0),r([s()],k.prototype,"graphicSymbol",null),r([s({constructOnly:!0})],k.prototype,"hasZ",void 0),r([s({constructOnly:!0})],k.prototype,"geometryToPlace",void 0),r([s()],k.prototype,"mode",null),r([s()],k.prototype,"snappingManager",void 0),r([s()],k.prototype,"snapToScene",void 0),r([s()],k.prototype,"tooltip",void 0),r([s()],k.prototype,"tooltipInfos",void 0),r([s({constructOnly:!0,type:wi})],k.prototype,"sketchOptions",void 0),r([s()],k.prototype,"updating",null),r([s({constructOnly:!0,nonNullable:!0})],k.prototype,"view",void 0),r([s({constructOnly:!0})],k.prototype,"undoRedo",null),r([s()],k.prototype,"activeTooltipInfo",null),k=r([d("esri.views.draw.DrawGraphicTool")],k);var Fi=Symbol("create-operation-graphic"),J={outline:Symbol("outline-visual"),regularVertices:Symbol("regular-vertices-visual"),activeVertex:Symbol("active-vertex-visual"),activeEdge:Symbol("active-edge-visual")};function zb(t){switch(t){case"point":case"polyline":case"polygon":case"multipoint":return t;case"circle":case"rectangle":return"segment";case"mesh":return"point"}}var cl=48;var Ai="click";var Po=class{constructor({consumesClicks:e,grabbableForEvent:o}){this.events=new nt,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.consumesClicks=e,this.grabbableForEvent=o}destroy(){}intersectionDistance(e,o){return 0}attach(){}detach(){}onElevationChange(){}onViewChange(){}};var ul="crosshair",dl="progress",ia=Symbol(),ra=Symbol(),v=class extends nt.EventedMixin(M){constructor(t){super(t),this._createOperationCompleted=!1,this._hideDefaultCursor=!1,this._pointerDownStates=new on,this._stagedScreenPoint=null,this._stagedPointerType=null,this._updatingHandles=new Ve,this._stagedPointerId=null,this.constraintsEnabled=!1,this.constraints=void 0,this._getPointConstraint=de(Rs),this._getPolylineOrPolygonConstraint=de(Vs),this.constraintZ=null,this.defaultZ=null,this.isDraped=!0,this.labelOptions=new Wt,this.cursor=null,this.loading=!1,this.snapToSceneEnabled=null,this.firstVertex=null,this.lastVertex=null,this.secondToLastVertex=null,t.elevationInfo==null&&(this.elevationInfo=$r(!!t.hasZ))}initialize(){let{geometryType:t,view:e}=this,o=e.spatialReference,i="viewingMode"in e.state?e.state.viewingMode:Gr.Local,n=t==="segment"||t==="multipoint"?"polyline":t;this.coordinateHelper=Pn(this.hasZ,this.hasM,o),this._editGeometryOperations=new Un(new Dn(n,this.coordinateHelper),i),this._snappingOperation=new Gn({view:e}),this.addHandles([F(()=>({stagedPoint:this._snappingOperation.stagedPoint,constraint:this._constraint}),({stagedPoint:p,constraint:c},m)=>{let{snappingOptions:h}=this;if(h&&(h.forceDisabled=c!=null&&hn(c)),m!=null&&p===m.stagedPoint&&c!==m.constraint)return this._onKeyboardBasedChange();this._processCursor(p??this._screenToMap(this._stagedScreenPoint))},{equals:(p,c)=>p.stagedPoint===c.stagedPoint&&zi(p.constraint,c.constraint)}),F(()=>this.view.viewpoint,(p,c)=>{p&&c&&Rr(p,c)&&this._onKeyboardBasedChange()})]),this._activeComponent=new En(o,i),this._editGeometryOperations.data.components.push(this._activeComponent);let a=this.segmentLabels;a!=null&&(a.context={view:e,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.addHandles(F(()=>this.labelOptions.enabled,p=>{a.visible=p},mt))),this.addHandles(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],p=>{let c=p.vertices.map(g=>({componentIndex:0,vertexIndex:g.index,coordinates:this.coordinateHelper.vectorToArray(g.pos)})),m=c.map(g=>g.coordinates),h=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getFirstVertex()?.pos)??null;Ht(h,this.firstVertex)||(this.firstVertex=h);let y=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getLastVertex()?.pos)??null;Ht(y,this.lastVertex)||(this.lastVertex=y);let S=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.edges.at(-1)?.leftVertex?.pos)??null;switch(Ht(S,this.secondToLastVertex)||(this.secondToLastVertex=S),this._processCursor(this.cursorVertex),p.type){case"vertex-add":this.emit(p.type,dt(x({},p),{added:m,vertices:c}));break;case"vertex-update":this.emit(p.type,dt(x({},p),{updated:m,vertices:c}));break;case"vertex-remove":this.emit(p.type,dt(x({},p),{removed:m,vertices:c}))}}));let l=this._manipulator=new Po({consumesClicks:!1,grabbableForEvent:p=>this.drawingMode!=="click"||p.pointerType==="touch"&&this._snappingEnabled&&this._pointerDownStates.size===1});this.manipulators.add(l),l.grabbable=t!=="point",this.addHandles([l.events.on("immediate-click",p=>this._onImmediateClick(p)),l.events.on("immediate-double-click",p=>this._onImmediateDoubleClick(p)),F(()=>this.drawingMode,()=>{this.removeHandles(ia),this.addHandles(this._createManipulatorDragPipeline(l),ia)},mt),F(()=>({effectiveCursor:this.effectiveCursor}),({effectiveCursor:p})=>{l.cursor=p},mt)]),Hn(this,()=>{let p=this.view.inputManager.latestPointerType??"mouse",c=this._getSnappingContext(p);if(this.snappingManager!=null){let m=this._snappingOperation.snapAgainNearPreviousMapPoint(this.snappingManager,c);this._updatingHandles.addPromise(Do(m))}})}destroy(){tt(this.segmentLabels),tt(this._snappingOperation),this._editGeometryOperations=tt(this._editGeometryOperations),this._updatingHandles.destroy()}get _isDragging(){let{_stagedPointerId:t,_manipulator:e}=this;return t!=null&&this._pointerDownStates.has(t)||e.grabbing||!e.interactive}get _snappingEnabled(){return this.snappingManager!=null&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){let t=this._updateAndGetEffectiveDrawSurface();return this.view.type==="3d"&&this.drawSurface!==t}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map(t=>this.coordinateHelper.vectorToArray(t.pos))}get _constraint(){let{constraints:t,constraintsEnabled:e}=this;if(t&&e)switch(this.geometryType){case"point":return this._getPointConstraint(t);case"polygon":case"polyline":return this._getPolylineOrPolygonConstraint(this.lastVertex,this.secondToLastVertex,t)}}set drawingMode(t){this._set("drawingMode",t??Ai)}get effectiveCursor(){return this.loading?dl:this._hideDefaultCursor?null:this.cursor||ul}get interactive(){return this._manipulator.interactive}set interactive(t){this._manipulator.interactive=t}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get snappingOptions(){return this.snappingManager!=null?this.snappingManager.options:null}get cursorVertex(){return this._get("cursorVertex")}get visualizationCursorVertex(){return this._stagedPointerType==="mouse"?this.cursorVertex:null}get committableVertex(){let{cursorVertex:t,lastVertex:e,firstVertex:o,geometryType:i}=this;return i==="polygon"&&Fe(t,o)||Fe(t,e)?null:t}get updating(){return this._updatingHandles.updating}get geometryIncludingUncommittedVertices(){let{committedVertices:t,committableVertex:e,coordinateHelper:o}=this,i=t.slice();return e!=null&&i.push(o.pointToArray(e)),i}cancel(){this.complete({aborted:!0})}commitStagedVertex(){this._snappingOperation.abort();let{committableVertex:t}=this;t!=null&&this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(t))}complete(t){let e=t?.aborted||!1;this._snappingOperation.abort(),this.snappingManager?.doneSnapping();let{geometryType:o,numCommittedVertices:i}=this,n=o==="multipoint"&&i===0||o==="polyline"&&i<2||o==="polygon"&&i<3;o!=="segment"&&o!=="point"||this.commitStagedVertex(),this._createOperationCompleted=!n,(this.isCompleted||e)&&(this._stagedScreenPoint=null,this._stagedPointerId=null,this._stagedPointerType=null,this._processCursor(null),this.emit("complete",{vertices:this.committedVertices.map((a,l)=>({componentIndex:0,vertexIndex:l,coordinates:a})),aborted:e,type:"complete"}))}onInputEvent(t){switch(t.type){case"pointer-down":this._pointerDownStates.add(t.pointerId);break;case"pointer-up":this._pointerDownStates.delete(t.pointerId)}switch(t.type){case"pointer-move":return this._onPointerMove(t);case"hold":return this._onHold(t)}}redo(){this._editGeometryOperations.redo()}undo(){this.snappingManager!=null&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}_processCursor(t){let e=re(this.cursorVertex),o=re(t),i=o&&(this._updateAndGetEffectiveDrawSurface()?.constrainZ(o)??o),n=this._snapToClosingVertex(i),a=this._applyConstraints(n);Fe(e,a)||(this._set("cursorVertex",a),this.segmentLabels?.set("stagedVertex",a!=null?this.coordinateHelper.pointToVector(a):null),a==null||this._stagedPointerType!=="mouse"?this.emit("cursor-remove"):this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(a)}],operation:"apply",type:"vertex-update"}))}_snapToClosingVertex(t){if(t==null||this._isDragging||this.geometryType!=="polygon"||this.numCommittedVertices<=2)return t;let e=this._mapToScreen(t);if(!e)return t;let o=this._activeComponent;return this._vertexWithinPointerDistance(o.vertices[0].pos,e)?this.firstVertex:this._vertexWithinPointerDistance(o.vertices.at(-1).pos,e)?this.lastVertex:t}_createManipulatorDragPipeline(t){switch(this.drawingMode){case"click":return this._createManipulatorDragPipelineClick(t);case"freehand":return this._createManipulatorDragPipelineFreehand(t);case"hybrid":return this._createManipulatorDragPipelineHybrid(t)}}_createManipulatorDragPipelineClick(t){return ze(t,(e,o,i,n)=>{let a=n==="touch"&&this._snappingEnabled;if(this.isCompleted||!a)return;let{snappingStep:l,cancelSnapping:p}=zn({predicate:()=>a,snappingManager:this.snappingManager,snappingContext:new di({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,feature:this.graphic,pointer:n,visualizer:this.snappingVisualizer,drawConstraints:this.constraints}),updatingHandles:this._updatingHandles,useZ:!this._requiresScenePoint});i=i.next(c=>(a&&this.snappingManager!=null&&this.snappingManager.doneSnapping(),c)).next(p),o.next(this._screenToMapDragEventStep()).next(c=>(c.action==="start"&&(this._processCursor(c.mapStart),(this.geometryType==="segment"||a&&!this.numCommittedVertices)&&this.commitStagedVertex()),c)).next(Ln(this.view,this.elevationInfo)).next(...l).next(c=>(a&&(this._processCursor(c.mapEnd),c.action==="end"&&this.commitStagedVertex()),c)).next(c=>(c.action==="end"&&(this._stagedPointerType!=="mouse"&&this._snappingOperation.abort(),this.geometryType!=="segment"&&this.geometryType!=="point"||this.complete()),c))})}_createManipulatorDragPipelineFreehand(t){return ze(t,(e,o)=>{this.isCompleted||o.next(this._screenToMapDragEventStep()).next(i=>(i.action==="start"&&(this._snappingOperation.abort(),this.committableVertex==null&&this._processCursor(i.mapStart),this.geometryType==="segment"&&this.commitStagedVertex()),i)).next(i=>{switch(i.action){case"start":case"update":this._processCursor(i.mapEnd),this.geometryType!=="polygon"&&this.geometryType!=="polyline"||this.commitStagedVertex();break;case"end":this.complete()}return i})})}_createManipulatorDragPipelineHybrid(t){return ze(t,(e,o)=>{this.isCompleted||o.next(this._screenToMapDragEventStep()).next(i=>(i.action==="start"&&(this._snappingOperation.abort(),this.addHandles(this._editGeometryOperations.createUndoGroup(),ra),this._processCursor(i.mapStart),this.commitStagedVertex()),i)).next(i=>{switch(i.action){case"start":case"update":this._processCursor(i.mapEnd),this.geometryType!=="polygon"&&this.geometryType!=="polyline"||this.commitStagedVertex();break;case"end":this._stagedPointerType!=="mouse"&&this._snappingOperation.abort(),this.removeHandles(ra),this.geometryType!=="segment"&&this.geometryType!=="point"||this.complete()}return i})})}get _drawAtFixedElevation(){let{constraintsEnabled:t,constraintZ:e,geometryType:o,numCommittedVertices:i}=this;return t?e!=null||o==="segment"&&i>0:(o==="segment"||o==="polygon")&&i>0}_updateAndGetEffectiveDrawSurface(){let{constraintsEnabled:t,coordinateHelper:e,drawSurface:o,elevationDrawSurface:i,snapToSceneEnabled:n}=this;if(i==null)return o;if(!this.hasZ)return i.defaultZ=null,i;let a=this.elevationInfo?.mode,l=this.defaultZ,p=t||a==="absolute-height";return n!=null&&(p=n),a==="on-the-ground"&&(p=!1),this._drawAtFixedElevation&&(l=(t?this.constraintZ:null)??e.getZ(this._activeComponent.vertices[0].pos),p=!1),p?o:(i.defaultZ=l,i)}_mapToScreen(t){return this._updateAndGetEffectiveDrawSurface()?.mapToScreen(t)}_onHold(t){this._snappingOperation.abort(),this.drawingMode==="click"&&t.pointerType==="touch"&&this._snappingEnabled&&this._processCursor(t.mapPoint),t.stopPropagation()}_onImmediateClick(t){if(!(t.pointerType==="mouse"&&t.button===2||this._manipulator.dragging))try{let{drawingMode:e,geometryType:o}=this;this._stagedPointerType=t.pointerType,this._stagedScreenPoint=t.screenPoint;let i=this._screenToMap(t.screenPoint);if(i==null||i==null||e==="freehand"&&o!=="point")return;if(this._snappingEnabled&&this.cursorVertex!=null||this._processCursor(i),this.committableVertex==null)return void this.complete();this.commitStagedVertex(),t.pointerType!=="mouse"&&this._processCursor(null),(e==="freehand"||o==="point"||o==="segment"&&this.numCommittedVertices===2||o==="segment"&&e==="hybrid"&&this.numCommittedVertices===1)&&this.complete()}finally{t.stopPropagation()}}_onImmediateDoubleClick(t){this._manipulator.dragging||this.geometryType==="point"||(this.complete(),t.stopPropagation())}_onPointerMove(t){let e=Mt(t.x,t.y);this._stagedScreenPoint=e,this._stagedPointerType=t.pointerType,this._stagedPointerId=t.pointerId,this._isDragging?this._snappingOperation.abort():(t.stopPropagation(),this._processCursorMovementRelativeToSurface(e,t.pointerType))}_onKeyboardBasedChange(){this._stagedPointerType==="mouse"&&this._stagedScreenPoint&&this._stagedPointerId!=null&&!this._isDragging?this._processCursorMovementRelativeToSurface(this._stagedScreenPoint,this._stagedPointerType):this._snappingOperation.abort()}_processCursorMovementRelativeToSurface(t,e){let o=this._snappingOperation,i=this._screenToMap(t),n=this._requiresScenePoint?this.drawSurface?.screenToMap(t):null;if(i==null)return this._hideDefaultCursor=!0,this._processCursor(null),void o.abort();this._hideDefaultCursor=!1;let a=this.snappingManager;if(a==null)return this._processCursor(i),void o.abort();let l=this._getSnappingContext(e);this._updatingHandles.addPromise(Do(o.snap({point:i,scenePoint:n},a,l)))}_applyConstraints(t){let{_constraint:e,constraints:o}=this;if(!t||!o||!e)return t;let{context:i}=o,n=_e(t,i),a=n?e.closestTo(n):void 0;if(!a)return t;let l=As(a,t,i),p=this.view.type==="2d"||i.elevationInfo.mode!=="absolute-height";return l!=null&&p&&this.constraintZ!=null&&this.hasZ&&(l.z=this.constraintZ),l}_screenToMap(t){return t?this._updateAndGetEffectiveDrawSurface()?.screenToMap(t):null}_screenToMapDragEventStep(){let t=null;return e=>{if(e.action==="start"&&(t=this._screenToMap(e.screenStart)),t==null)return null;let o=this._screenToMap(e.screenEnd);return o!=null?dt(x({},e),{mapStart:t,mapEnd:o}):null}}_vertexWithinPointerDistance(t,e){let i=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(t));return i!=null&&ml(i,e,25)}_getSnappingContext(t){let e=this._drawAtFixedElevation?this.elevationDrawSurface?.defaultZ:null;return new di({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:t,feature:this.graphic,visualizer:this.snappingVisualizer,selfSnappingZ:e!=null?{value:e,elevationInfo:this.elevationInfo}:null,drawConstraints:this.constraints})}};function ml(t,e,o){let i=t.x-e.x,n=t.y-e.y;return i*i+n*n<=o}r([s()],v.prototype,"_hideDefaultCursor",void 0),r([s()],v.prototype,"_stagedPointerId",void 0),r([s()],v.prototype,"_isDragging",null),r([s()],v.prototype,"_snappingOperation",void 0),r([s()],v.prototype,"_snappingEnabled",null),r([s({constructOnly:!0})],v.prototype,"graphic",void 0),r([s()],v.prototype,"constraintsEnabled",void 0),r([s()],v.prototype,"constraints",void 0),r([s()],v.prototype,"_constraint",null),r([s()],v.prototype,"constraintZ",void 0),r([s()],v.prototype,"defaultZ",void 0),r([s()],v.prototype,"isDraped",void 0),r([s({value:Ai})],v.prototype,"drawingMode",null),r([s({constructOnly:!0})],v.prototype,"elevationDrawSurface",void 0),r([s({constructOnly:!0})],v.prototype,"elevationInfo",void 0),r([s({constructOnly:!0,type:Wt})],v.prototype,"labelOptions",void 0),r([s({constructOnly:!0})],v.prototype,"geometryType",void 0),r([s({constructOnly:!0})],v.prototype,"hasM",void 0),r([s({constructOnly:!0})],v.prototype,"hasZ",void 0),r([s()],v.prototype,"cursor",void 0),r([s()],v.prototype,"effectiveCursor",null),r([s()],v.prototype,"loading",void 0),r([s({constructOnly:!0})],v.prototype,"manipulators",void 0),r([s({constructOnly:!0})],v.prototype,"drawSurface",void 0),r([s({constructOnly:!0})],v.prototype,"segmentLabels",void 0),r([s({constructOnly:!0})],v.prototype,"snappingManager",void 0),r([s({constructOnly:!0})],v.prototype,"snappingVisualizer",void 0),r([s()],v.prototype,"snapToSceneEnabled",void 0),r([s({readOnly:!0})],v.prototype,"cursorVertex",null),r([s({readOnly:!0})],v.prototype,"visualizationCursorVertex",null),r([s()],v.prototype,"committableVertex",null),r([s()],v.prototype,"firstVertex",void 0),r([s()],v.prototype,"lastVertex",void 0),r([s()],v.prototype,"secondToLastVertex",void 0),r([s()],v.prototype,"updating",null),r([s({constructOnly:!0})],v.prototype,"view",void 0),v=r([d("esri.views.draw.DrawOperation")],v);var na=class{constructor(e,o,i,n=null){this._elevationInfo=e,this.defaultZ=o,this._view=i,this._excludeGraphics=n}screenToMap(e){let{defaultZ:o,_view:i}=this,n=i.sceneIntersectionHelper.intersectElevationFromScreen(Pe(e.x,e.y),this._elevationInfo,o??0,this._excludeGraphics);return o==null&&n!=null&&(n.z=void 0),n}mapToScreen(e){let o=pe(e.x,e.y,ei(this._view,e,this._elevationInfo),e.spatialReference);return this._view.toScreen(o)}constrainZ(e){let{defaultZ:o}=this;return o!=null&&e.z!==o&&((e=ti(e)).z=o),e}},sa=class{constructor(e,o,i=[]){this.view=e,this.elevationInfo=o,this.exclude=i}screenToMap(e){let o=this.view.toMap(e,{exclude:this.exclude,excludeLabels:!0});return o!=null&&(o.z=Xr(o,this.view,this.elevationInfo)),o}mapToScreen(e){let o=e;return this.elevationInfo!=null&&(o=pe(e.x,e.y,ei(this.view,e,this.elevationInfo),e.spatialReference)),this.view.toScreen(o)}constrainZ(e){return e}},aa=class{constructor(e,o=!1,i=0){this.view=e,this.hasZ=o,this.defaultZ=i,this.mapToScreen=n=>e.toScreen(n),this.screenToMap=o?n=>{let a=e.toMap(n);return a.z=i,a}:n=>e.toMap(n)}constrainZ(e){let{defaultZ:o}=this;return this.hasZ&&e.z!==o&&((e=ti(e)).z=o),e}},Ui=class t{screenToMap(e){let{x:o,y:i}=e;return new G({x:o,y:i,spatialReference:t.spatialReference})}mapToScreen(e){return Mt(e.x,e.y)}constrainZ(e){return e}};Ui.spatialReference=new ht;function la(t){let e=0,o=0,i=0;return t?(t.type==="cim"&&t.data.symbol&&"symbolLayers"in t.data.symbol&&t.data.symbol.symbolLayers&&t.data.symbol.symbolLayers.map(n=>{n.type==="CIMVectorMarker"&&n.anchorPoint&&(Math.abs(n.anchorPoint.x)>e&&(e=n.anchorPoint.x),Math.abs(n.anchorPoint.y)>o&&(o=n.anchorPoint.y),n.size!=null&&n.size>i&&(i=n.size))}),e=_t(e),o=_t(o),i=_t(i),{offsetX:e,offsetY:o,size:i}):{offsetX:e,offsetY:o,size:i}}var B=class extends M{set graphic(t){this._circleCollisionCache=null,this._originalSymbol=t.symbol,this._set("graphic",t),this.attachSymbolChanged()}get elevationInfo(){let{layer:t}=this.graphic,e=t&&"elevationInfo"in t?t.elevationInfo:null,o=Wr(this.graphic),i=e?e.offset:0;return new Br({mode:o,offset:i})}set focusedSymbol(t){t!==this._get("focusedSymbol")&&(this._set("focusedSymbol",t),this._updateGraphicSymbol(),this._circleCollisionCache=null)}grabbableForEvent(){return!0}set grabbing(t){t!==this._get("grabbing")&&(this._set("grabbing",t),this._updateGraphicSymbol())}set hovering(t){t!==this._get("hovering")&&(this._set("hovering",t),this._updateGraphicSymbol())}set selected(t){t!==this._get("selected")&&(this._set("selected",t),this._updateGraphicSymbol(),this.events.emit("select-changed",{action:t?"select":"deselect"}))}get _focused(){return this._get("hovering")||this._get("grabbing")}constructor(t){super(t),this.layer=null,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.dragging=!1,this.cursor=null,this.consumesClicks=!0,this.events=new nt.EventEmitter,this._circleCollisionCache=null,this._graphicSymbolChangedHandle=null,this._originalSymbol=null}destroy(){this.detachSymbolChanged(),this._resetGraphicSymbol(),this._set("view",null)}intersectionDistance(t){let e=this.graphic;if(e.visible===!1)return null;let o=e.geometry;if(o==null)return null;let i=this._get("focusedSymbol"),n=i??e.symbol;return this.view.type==="2d"?this._intersectDistance2D(this.view,t,o,n):this._intersectDistance3D(this.view,t,e)}attach(){this.attachSymbolChanged(),this.layer!=null&&this.layer.add(this.graphic)}detach(){this.detachSymbolChanged(),this._resetGraphicSymbol(),this.layer!=null&&this.layer.remove(this.graphic)}attachSymbolChanged(){this.detachSymbolChanged(),this._graphicSymbolChangedHandle=F(()=>this.graphic?.symbol,t=>{t!=null&&t!==this.focusedSymbol&&t!==this._originalSymbol&&(this._originalSymbol=t,this._focused&&this.focusedSymbol!=null&&(this.graphic.symbol=this.focusedSymbol))},Lt)}detachSymbolChanged(){this._graphicSymbolChangedHandle!=null&&(this._graphicSymbolChangedHandle.remove(),this._graphicSymbolChangedHandle=null)}onElevationChange(){}onViewChange(){}_updateGraphicSymbol(){this.graphic.symbol=this._focused&&this.focusedSymbol!=null?this.focusedSymbol:this._originalSymbol}_resetGraphicSymbol(){this.graphic.symbol=this._originalSymbol}_intersectDistance2D(t,e,o,i){if((i=i||Fr(o))==null)return null;let n=1,a=this._circleCollisionCache;if(o.type==="point"&&i.type==="cim"&&i.data.symbol?.type==="CIMPointSymbol"&&i.data.symbol.symbolLayers){let{offsetX:l,offsetY:p,size:c}=la(i),m=No(e,ca),h=c/2,y=t.toScreen(o),S=y.x+l,g=y.y+p;return Wo(m,[S,g])<h*h?n:null}if(o.type!=="point"||i.type!=="simple-marker")return an(e,o,t)?n:null;if(a==null||!a.originalPoint.equals(o)){let l=o,p=t.spatialReference;if(xr(l.spatialReference,p)){let c=_r(l,p);a={originalPoint:l.clone(),mapPoint:c,radiusPx:_t(i.size)},this._circleCollisionCache=a}}if(a!=null){let l=No(e,ca),p=t.toScreen?.(a.mapPoint);if(!p)return null;let c=a.radiusPx,m=p.x+_t(i.xoffset),h=p.y-_t(i.yoffset);return Wo(l,[m,h])<c*c?n:null}return null}_intersectDistance3D(t,e,o){let i=t.toMap(e,{include:[o]});return i&&Dr(i,pa,t.renderSpatialReference)?Sr(pa,t.state.camera.eye):null}};r([s({constructOnly:!0,nonNullable:!0})],B.prototype,"graphic",null),r([s()],B.prototype,"elevationInfo",null),r([s({constructOnly:!0,nonNullable:!0})],B.prototype,"view",void 0),r([s({value:null})],B.prototype,"focusedSymbol",null),r([s({constructOnly:!0})],B.prototype,"layer",void 0),r([s()],B.prototype,"interactive",void 0),r([s()],B.prototype,"selectable",void 0),r([s()],B.prototype,"grabbable",void 0),r([s({value:!1})],B.prototype,"grabbing",null),r([s()],B.prototype,"dragging",void 0),r([s()],B.prototype,"hovering",null),r([s({value:!1})],B.prototype,"selected",null),r([s()],B.prototype,"cursor",void 0),B=r([d("esri.views.interactive.GraphicManipulator")],B);var pa=D(),ca=Pe();function h0(t,e){return ua(t,e,!1)}function f0(t,e){return ua(t,e,!0)}function ua(t,e,o){if(t instanceof Rn){if(t.operation instanceof Vn)return hl(t.operation,e,o),!0;if(t.operation instanceof Fn)return fl(t.operation,e,o),!0;if(t.operation instanceof An)return gl(t.operation,e,o),!0}return!1}function hl(t,e,o=!1){let i=o?-1:1,n=yr(i*t.dx,i*t.dy,i*t.dz);De(e.origin,e.origin,n),ue(e)}function fl(t,e,o=!1){let i=o?-t.angle:t.angle;Ko(e.basis1,e.basis1,Zo,i),Ko(e.basis2,e.basis2,Zo,i),ue(e)}function gl(t,e,o=!1){let i=o?1/t.factor1:t.factor1,n=o?1/t.factor2:t.factor2;Ot(e.basis1,e.basis1,i),Ot(e.basis2,e.basis2,n),Xo(e.origin,e.origin,t.origin,t.axis1,i),Xo(e.origin,e.origin,t.origin,t.axis2,n),ue(e)}function g0(t,e,o,i){i||(i=Zr());let n=It(Nt.get(),t[1],-t[0]),a=It(Nt.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),l=It(Nt.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),p=Nt.get();e.components.forEach(h=>h.vertices.forEach(({pos:y})=>{It(p,Yo(t,y),Yo(n,y)),wr(a,a,p),Tr(l,l,p)}));let c=1e-6,m=It(Nt.get(),l[0]-a[0]<c?o/2:0,l[1]-a[1]<c?o/2:0);return br(a,a,m),Ee(l,l,m),$o(i.basis1,t,(l[0]-a[0])/2),$o(i.basis2,n,(l[1]-a[1])/2),It(i.origin,a[0]*t[0]+a[1]*n[0],a[0]*t[1]+a[1]*n[1]),Ee(i.origin,i.origin,i.basis1),Ee(i.origin,i.origin,i.basis2),ue(i),i}export{ys as a,vs as b,sf as c,af as d,bs as e,lf as f,V as g,Us as h,D_ as i,zs as j,R_ as k,Gs as l,Hs as m,Ct as n,Ei as o,wi as p,k as q,zb as r,v as s,na as t,sa as u,aa as v,la as w,B as x,h0 as y,f0 as z,g0 as A};
