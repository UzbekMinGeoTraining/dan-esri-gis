import{a as K}from"./chunk-ENLR2WBX.js";import{a as v}from"./chunk-RI3FIROF.js";import{a as G}from"./chunk-PJX4LNSV.js";import{I as H,J}from"./chunk-EPTSNNZF.js";import{b as Q,c as B,d as X,e as D}from"./chunk-Q5WFUDPQ.js";import{d as C}from"./chunk-6WKJD7BM.js";import{a as $}from"./chunk-WGF2T2BG.js";import{r as U,t as w}from"./chunk-3IBUFXWY.js";function p(e,o){return e?o?4:3:o?3:2}var x=()=>U.getLogger("esri.layers.graphics.featureConversionUtils"),te={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},me=(e,o,t,r,s,n)=>{e[t]=s,e[t+1]=n},W=(e,o,t,r,s,n)=>{e[t]=s,e[t+1]=n,e[t+2]=o[r+2]},he=(e,o,t,r,s,n)=>{e[t]=s,e[t+1]=n,e[t+2]=o[r+3]},de=(e,o,t,r,s,n)=>{e[t]=s,e[t+1]=n,e[t+2]=o[r+2],e[t+3]=o[r+3]};function Y(e,o,t,r){if(e){if(t)return o&&r?de:W;if(o&&r)return he}else if(o&&r)return W;return me}function E({scale:e,translate:o},t){return Math.round((t-o[0])/e[0])}function V({scale:e,translate:o},t){return Math.round((o[1]-t)/e[1])}function O({scale:e,translate:o},t,r){return t*e[r]+o[r]}function Re(e,o,t){return e?o?t?_(e):k(e):t?j(e):q(e):null}function q(e){let o=e.coords;return{x:o[0],y:o[1]}}function re(e,o){return e.coords[0]=o.x,e.coords[1]=o.y,e}function k(e){let o=e.coords;return{x:o[0],y:o[1],z:o[2]}}function ge(e,o){return e.coords[0]=o.x,e.coords[1]=o.y,e.coords[2]=o.z,e}function j(e){let o=e.coords;return{x:o[0],y:o[1],m:o[2]}}function ye(e,o){return e.coords[0]=o.x,e.coords[1]=o.y,e.coords[2]=o.m,e}function _(e){let o=e.coords;return{x:o[0],y:o[1],z:o[2],m:o[3]}}function pe(e,o){return e.coords[0]=o.x,e.coords[1]=o.y,e.coords[2]=o.z,e.coords[3]=o.m,e}function Fe(e,o,t,r){let s=q;t&&r?s=_:t?s=k:r&&(s=j);for(let n of o){let{geometry:u,attributes:l}=n,c=u!=null?s(u):null;e.push({attributes:l,geometry:c})}return e}function A(e,o){return e&&o?pe:e?ge:o?ye:re}function Ie(e,o,t,r,s){let n=A(t,r);for(let{geometry:u,attributes:l}of o){let c=u!=null?n(new G,u):null;e.push(new v(c,l,null,s?l[s]:void 0))}return e}function Me(e,o,t=A(o.z!=null,o.m!=null)){return t(e,o)}function be(e,o,t,r){for(let{geometry:s,attributes:n}of o)e.push({attributes:n,geometry:s!=null?ne(s,t,r):null});return e}function ne(e,o,t){if(e==null)return null;let r=p(o,t),s=[];for(let n=0;n<e.coords.length;n+=r){let u=[];for(let l=0;l<r;l++)u.push(e.coords[n+l]);s.push(u)}return o?t?{points:s,hasZ:o,hasM:t}:{points:s,hasZ:o}:t?{points:s,hasM:t}:{points:s}}function Te(e,o,t,r,s){let n=p(t,r);for(let{geometry:u,attributes:l}of o){let c=u!=null?se(new G,u,n):null;e.push(new v(c,l,null,s?l[s]:void 0))}return e}function se(e,o,t=p(o.hasZ,o.hasM)){e.lengths[0]=o.points.length;let r=e.coords,s=0;for(let n of o.points)for(let u=0;u<t;u++)r[s++]=n[u];return e}function Ge(e,o,t,r){for(let{geometry:s,attributes:n}of o)e.push({attributes:n,geometry:s!=null?ue(s,t,r):null});return e}function ue(e,o,t){if(!e)return null;let r=p(o,t),{coords:s,lengths:n}=e,u=[],l=0;for(let c of n){let i=[];for(let a=0;a<c;a++){let f=[];for(let m=0;m<r;m++)f.push(s[l++]);i.push(f)}u.push(i)}return o?t?{paths:u,hasZ:o,hasM:t}:{paths:u,hasZ:o}:t?{paths:u,hasM:t}:{paths:u}}function Ne(e,o,t,r,s){let n=p(t,r);for(let{geometry:u,attributes:l,centroid:c}of o){let i=u!=null?le(new G,u,n):null,a=c!=null?Me(new G,c):null;e.push(new v(i,l,a,s?l[s]:void 0))}return e}function le(e,o,t=p(o.hasZ,o.hasM)){let{lengths:r,coords:s}=e,n=0;for(let u of o.paths){for(let l of u)for(let c=0;c<t;c++)s[n++]=l[c];r.push(u.length)}return e}function ve(e,o,t,r){for(let{geometry:s,attributes:n,centroid:u}of o){let l=s!=null?ie(s,t,r):null;if(u!=null){let c=q(u);e.push({attributes:n,centroid:c,geometry:l})}else e.push({attributes:n,geometry:l})}return e}function ie(e,o,t){if(!e)return null;let r=p(o,t),{coords:s,lengths:n}=e,u=[],l=0;for(let c of n){let i=[];for(let a=0;a<c;a++){let f=[];for(let m=0;m<r;m++)f.push(s[l++]);i.push(f)}u.push(i)}return o?t?{rings:u,hasZ:o,hasM:t}:{rings:u,hasZ:o}:t?{rings:u,hasM:t}:{rings:u}}function we(e,o,t,r,s){for(let{geometry:n,centroid:u,attributes:l}of o){let c=n!=null?ce(new G,n,t,r):null,i=s?l[s]:void 0;u!=null?e.push(new v(c,l,re(new G,u),i)):e.push(new v(c,l,null,i))}return e}function ce(e,o,t=o.hasZ,r=o.hasM){return Pe(e,o.rings,t,r)}function Pe(e,o,t,r){let s=p(t,r),{lengths:n,coords:u}=e,l=0;N(e);for(let c of o){for(let i of c)for(let a=0;a<s;a++)u[l++]=i[a];n.push(c.length)}return e}var P=[],z=[];function Ue(e,o,t,r,s){P[0]=e;let[n]=ae(z,P,o,t,r,s);return T(P),T(z),n}function ae(e,o,t,r,s,n){if(T(e),!t){for(let u of o){let l=n?u.attributes[n]:void 0;e.push(new v(null,u.attributes,null,l))}return e}switch(t){case"esriGeometryPoint":return Ie(e,o,r,s,n);case"esriGeometryMultipoint":return Te(e,o,r,s,n);case"esriGeometryPolyline":return Ne(e,o,r,s,n);case"esriGeometryPolygon":case"esriGeometryMultiPatch":return we(e,o,r,s,n);default:x().error("convertToFeatureSet:unknown-geometry",new w(`Unable to parse unknown geometry type '${t}'`)),T(e)}return e}function $e(e,o,t,r){z[0]=e,fe(P,z,o,t,r);let s=P[0];return T(P),T(z),s}function Ce(e,o,t){if(e==null)return null;let r=new G;return"hasZ"in e&&o==null&&(o=e.hasZ),"hasM"in e&&t==null&&(t=e.hasM),B(e)?A(o??e.z!=null,t??e.m!=null)(r,e):D(e)?ce(r,e,o,t):X(e)?le(r,e,p(o,t)):Q(e)?se(r,e,p(o,t)):void x().error("convertFromGeometry:unknown-geometry",new w(`Unable to parse unknown geometry type '${e}'`))}function ze(e,o,t,r){let s=e&&("coords"in e?e:e.geometry);if(s==null)return null;switch(o){case"esriGeometryPoint":{let n=q;return t&&r?n=_:t?n=k:r&&(n=j),n(s)}case"esriGeometryMultipoint":return ne(s,t,r);case"esriGeometryPolyline":return ue(s,t,r);case"esriGeometryPolygon":return ie(s,t,r);default:return x().error("convertToGeometry:unknown-geometry",new w(`Unable to parse unknown geometry type '${o}'`)),null}}function xe(e,o){for(let t of o)e.push({attributes:t.attributes});return e}function fe(e,o,t,r,s){if(T(e),t==null)return xe(e,o);switch(t){case"esriGeometryPoint":return Fe(e,o,r,s);case"esriGeometryMultipoint":return be(e,o,r,s);case"esriGeometryPolyline":return Ge(e,o,r,s);case"esriGeometryPolygon":return ve(e,o,r,s);default:x().error("convertToFeatureSet:unknown-geometry",new w(`Unable to parse unknown geometry type '${t}'`))}return e}function Qe(e){let{objectIdFieldName:o,spatialReference:t,transform:r,fields:s,hasM:n,hasZ:u,features:l,geometryType:c,exceededTransferLimit:i,uniqueIdField:a,queryGeometry:f,queryGeometryType:m}=e,h={features:fe([],l,c,u,n),fields:s,geometryType:c,objectIdFieldName:o,spatialReference:t,uniqueIdField:a,queryGeometry:ze(f,m,!1,!1)};return r&&(h.transform=r),i&&(h.exceededTransferLimit=i),n&&(h.hasM=n),u&&(h.hasZ=u),h}function Be(e,o){let t=new K,{hasM:r,hasZ:s,features:n,objectIdFieldName:u,spatialReference:l,geometryType:c,exceededTransferLimit:i,transform:a,fields:f}=e;return f&&(t.fields=f),t.geometryType=c??null,t.objectIdFieldName=u??o??null,t.spatialReference=l??null,t.objectIdFieldName?(n&&ae(t.features,n,c,s,r,t.objectIdFieldName),i&&(t.exceededTransferLimit=i),r&&(t.hasM=r),s&&(t.hasZ=s),a&&(t.transform=a),t):(x().error(new w("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),t)}function Xe(e){let{transform:o,features:t,hasM:r,hasZ:s}=e;if(!o)return e;for(let n of t)n.geometry!=null&&oe(n.geometry,n.geometry,r,s,o),n.centroid!=null&&oe(n.centroid,n.centroid,r,s,o);return e.transform=null,e}function De(e,o){let{geometryType:t,features:r,hasM:s,hasZ:n}=o;if(!e)return o;for(let u=0;u<r.length;u++){let l=r[u],c=l.weakClone();c.geometry=new G,ee(c.geometry,l.geometry,s,n,t,e),l.centroid&&(c.centroid=new G,ee(c.centroid,l.centroid,s,n,"esriGeometryPoint",e)),r[u]=c}return o.transform=e,o}function ee(e,o,t,r,s,n,u=t,l=r){if(N(e),!o?.coords.length)return null;let c=te[s],{coords:i,lengths:a}=o,f=p(t,r),m=p(t&&u,r&&l),h=Y(t,r,u,l);if(!a.length)return h(e.coords,i,0,0,E(n,i[0]),V(n,i[1])),N(e,f,0),e;let d,y,I,M,F=0,g=0,b=g;for(let L of a){if(L<c)continue;let Z=0;g=b,I=d=E(n,i[F]),M=y=V(n,i[F+1]),h(e.coords,i,g,F,I,M),Z++,F+=f,g+=m;for(let R=1;R<L;R++,F+=f)I=E(n,i[F]),M=V(n,i[F+1]),I===d&&M===y||(h(e.coords,i,g,F,I-d,M-y),g+=m,Z++,d=I,y=M);Z>=c&&(e.lengths.push(Z),b=g)}return T(e.coords,b),e.coords.length?e:null}function He(e,o,t,r,s,n,u=t,l=r){if(N(e),!o?.coords.length)return null;let c=te[s],{coords:i,lengths:a}=o,f=p(t,r),m=p(t&&u,r&&l),h=Y(t,r,u,l);if(!a.length)return h(e.coords,i,0,0,i[0],i[1]),N(e,f,0),e;let d=0,y=n*n;for(let I of a){if(I<c){d+=I*f;continue}let M=e.coords.length/m,F=d,g=d+(I-1)*f;h(e.coords,i,e.coords.length,F,i[F],i[F+1]),S(e.coords,i,f,y,h,F,g),h(e.coords,i,e.coords.length,g,i[g],i[g+1]);let b=e.coords.length/m-M;b>=c?e.lengths.push(b):T(e.coords,M*m),d+=I*f}return e.coords.length?e:null}function Ze(e,o,t,r){let s=e[o],n=e[o+1],u=e[t],l=e[t+1],c=e[r],i=e[r+1],a=u,f=l,m=c-a,h=i-f;if(m!==0||h!==0){let d=((s-a)*m+(n-f)*h)/(m*m+h*h);d>1?(a=c,f=i):d>0&&(a+=m*d,f+=h*d)}return m=s-a,h=n-f,m*m+h*h}function S(e,o,t,r,s,n,u){let l,c=r,i=0;for(let a=n+t;a<u;a+=t)l=Ze(o,a,n,u),l>c&&(i=a,c=l);c>r&&(i-n>t&&S(e,o,t,r,s,n,i),s(e,o,e.length,i,o[i],o[i+1]),u-i>t&&S(e,o,t,r,s,i,u))}function Je(e,o,t,r){if(!o?.coords?.length)return null;let s=p(t,r),n=Number.POSITIVE_INFINITY,u=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;if(o&&o.coords){let i=o.coords;for(let a=0;a<i.length;a+=s){let f=i[a],m=i[a+1];n=Math.min(n,f),l=Math.max(l,f),u=Math.min(u,m),c=Math.max(c,m)}}return J(e)?H(e,n,u,l,c):C(n,u,l,c,e),e}function oe(e,o,t,r,s){let{coords:n,lengths:u}=o,l=p(t,r);if(!n.length)return e!==o&&N(e),e;$(s);let{originPosition:c,scale:i,translate:a}=s,f=Ee;f.originPosition=c;let m=f.scale;m[0]=i[0]??1,m[1]=-(i[1]??1),m[2]=i[2]??1,m[3]=i[3]??1;let h=f.translate;if(h[0]=a[0]??0,h[1]=a[1]??0,h[2]=a[2]??0,h[3]=a[3]??0,!u.length){for(let y=0;y<l;++y)e.coords[y]=O(f,n[y],y);return e!==o&&N(e,l,0),e}let d=0;for(let y=0;y<u.length;y++){let I=u[y];e.lengths[y]=I;for(let g=0;g<l;++g)e.coords[d+g]=O(f,n[d+g],g);let M=e.coords[d],F=e.coords[d+1];d+=l;for(let g=1;g<I;g++,d+=l){M+=n[d]*m[0],F+=n[d+1]*m[1],e.coords[d]=M,e.coords[d+1]=F;for(let b=2;b<l;++b)e.coords[d+b]=O(f,n[d+b],b)}}return e!==o&&N(e,n.length,u.length),e}function Ke(e,o,t,r,s,n){if(N(e),e.lengths.push(...o.lengths),t===s&&r===n)for(let u=0;u<o.coords.length;u++)e.coords.push(o.coords[u]);else{let u=p(t,r),l=Y(t,r,s,n),c=o.coords;for(let i=0;i<c.length;i+=u)l(e.coords,c,e.coords.length,i,c[i],c[i+1])}return e}function qe(e,o,t,r){let s=0,n=e[r*o],u=e[r*(o+1)];for(let l=1;l<t;l++){let c=n+e[r*(o+l)],i=u+e[r*(o+l)+1],a=(c-n)*(i+u);n=c,u=i,s+=a}return .5*s}function We(e,o){let{coords:t,lengths:r}=e,s=0,n=0;for(let u=0;u<r.length;u++){let l=r[u];n+=qe(t,s,l,o),s+=l}return Math.abs(n)}function N(e,o=0,t=0){T(e.lengths,t),T(e.coords,o)}function T(e,o=0){e.length!==o&&(e.length=o)}var Ee={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};export{E as a,V as b,Re as c,Me as d,ne as e,ue as f,ie as g,ce as h,Pe as i,Ue as j,ae as k,$e as l,Ce as m,ze as n,Qe as o,Be as p,Xe as q,De as r,ee as s,He as t,Je as u,oe as v,Ke as w,We as x};
